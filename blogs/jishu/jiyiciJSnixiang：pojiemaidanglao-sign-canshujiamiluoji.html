<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-rc.14">
    <script>
      (function() {
        const userMode = localStorage.getItem('vuepress-reco-color-scheme') || 'auto';
        const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;

        if (userMode === 'dark' || (userMode === 'auto' && systemDarkMode)) {
          document.documentElement.classList.toggle('dark', true);
        }
      })();
    </script>
    <meta property="og:url" content="https://sakee.cn/sake-s-blog/blogs/%E6%8A%80%E6%9C%AF/%E8%AE%B0%E4%B8%80%E6%AC%A1JS%E9%80%86%E5%90%91%EF%BC%9A%E7%A0%B4%E8%A7%A3%E9%BA%A6%E5%BD%93%E5%8A%B3-sign-%E5%8F%82%E6%95%B0%E5%8A%A0%E5%AF%86%E9%80%BB%E8%BE%91.html"><meta property="og:site_name" content="sake's blog"><meta property="og:title" content="记一次JS逆向：破解麦当劳 sign 参数加密逻辑"><meta property="og:description" content="如果你问我人生梦想是什么？ 我可能会说：有什么天天嫖麦当劳优惠券狠狠吃更棒的事了呢😋 QQ图片20230211161756 本文所谈及技术只为网络安全人员进行服务器检测或维护参考，仅供学习交流，请勿用于违法用途。 （碰壁了很多次，js代码经过混淆的可读性很差，代码量太大期间火狐崩溃了好几次😭） 页面: aHR0cHM6Ly9jZG4ubWNkLmN..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-08-10T20:00:17.000Z"><meta property="article:author" content="fullstacksake"><meta property="article:tag" content="Web"><meta property="article:tag" content="jsReverse"><meta property="article:tag" content="SRC"><meta property="article:published_time" content="2023-02-10T16:00:00.000Z"><meta property="article:modified_time" content="2024-08-10T20:00:17.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"记一次JS逆向：破解麦当劳 sign 参数加密逻辑","image":[""],"datePublished":"2023-02-10T16:00:00.000Z","dateModified":"2024-08-10T20:00:17.000Z","author":[{"@type":"Person","name":"fullstacksake","email":"fullstacksake@outlook.com"}]}</script><meta property="og:url" content="https://sakee.cn/sake-s-blog/blogs/jishu/jiyiciJSnixiang：pojiemaidanglao-sign-canshujiamiluoji.html"><link rel="stylesheet" href="/css/katex.min.css"><link rel="stylesheet" href="/css/github-markdown.min.css"><link rel="icon" href="/favicon.ico"><meta name="description" content="SAKE的博客 fullstacksake的技术分享博客"><meta name="viewport" content="width=device-width,initial-scale=0.8,user-scalable=no"><title>记一次JS逆向：破解麦当劳 sign 参数加密逻辑 | sake's blog</title>
    <link rel="preload" href="/sake-s-blog/assets/style-DgoDEBOF.css" as="style"><link rel="stylesheet" href="/sake-s-blog/assets/style-DgoDEBOF.css">
    <link rel="modulepreload" href="/sake-s-blog/assets/app-D-TC3Ll_.js"><link rel="modulepreload" href="/sake-s-blog/assets/jiyiciJSnixiang：pojiemaidanglao-sign-canshujiamiluoji.html-BO3duT-e.js">
    
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container series--no"><header class="navbar-container not-open"><div class="navbar-inner"><div class="site-brand nav-item"><img class="logo" src="/sake-s-blog/logo_transparent.png" alt="sake&#39;s blog"><a href="/sake-s-blog/" class="site-name can-hide">sake&#39;s blog</a></div><div class="nav-item navbar-links-wrapper" style=""><div><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div><nav class="navbar-links"><!--[--><div class="navbar-links__item"><a href="/sake-s-blog/posts" class="link" aria-label="博客"><!--[--><!--]--><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M4 24h10v2H4z" fill="currentColor"></path><path d="M4 18h10v2H4z" fill="currentColor"></path><path d="M26 14H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h20a2 2 0 0 1 2 2v6a2 2 0 0 1-2 2zM6 6v6h20V6z" fill="currentColor"></path><path d="M26 28h-6a2 2 0 0 1-2-2v-6a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v6a2 2 0 0 1-2 2zm-6-8v6h6v-6z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->博客<!--]--></span></span><!--[--><!--]--></a></div><div class="navbar-links__item"><a href="/sake-s-blog/timeline" class="link" aria-label="归档"><!--[--><!--]--><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M14 19h4v2h-4z" fill="currentColor"></path><path d="M6 2v26a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V2zm18 26H8V16h16zm0-14H8v-4h16zM8 8V4h16v4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->归档<!--]--></span></span><!--[--><!--]--></a></div><div class="navbar-links__item"><a href="/sake-s-blog/categories/jishu/1" class="link" aria-label="分类"><!--[--><!--]--><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M6.76 6l.45.89L7.76 8H12v5H4V6h2.76m.62-2H3a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V7a1 1 0 0 0-1-1H9l-.72-1.45a1 1 0 0 0-.9-.55z" fill="currentColor"></path><path d="M22.76 6l.45.89l.55 1.11H28v5h-8V6h2.76m.62-2H19a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V7a1 1 0 0 0-1-1h-4l-.72-1.45a1 1 0 0 0-.9-.55z" fill="currentColor"></path><path d="M6.76 19l.45.89l.55 1.11H12v5H4v-7h2.76m.62-2H3a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1v-7a1 1 0 0 0-1-1H9l-.72-1.45a1 1 0 0 0-.9-.55z" fill="currentColor"></path><path d="M22.76 19l.45.89l.55 1.11H28v5h-8v-7h2.76m.62-2H19a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1v-7a1 1 0 0 0-1-1h-4l-.72-1.45a1 1 0 0 0-.9-.55z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->分类<!--]--></span></span><!--[--><!--]--></a></div><div class="navbar-links__item"><a href="/sake-s-blog/tags/AI/1" class="link" aria-label="标签"><!--[--><!--]--><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><circle cx="10" cy="14" r="2" fill="currentColor"></circle><path d="M16 30a1 1 0 0 1-.71-.29L4.59 19A2 2 0 0 1 4 17.59V10a2 2 0 0 1 2-2h7.59a2 2 0 0 1 1.41.59l10.71 10.7a1 1 0 0 1 0 1.42l-9 9A1 1 0 0 1 16 30zM6 10v7.59l10 10L23.59 20l-10-10z" fill="currentColor"></path><path d="M27.71 13.29L17 2.59A2 2 0 0 0 15.59 2H8a2 2 0 0 0-2 2v2h2V4h7.59l10 10l-1.3 1.29l1.42 1.42l2-2a1 1 0 0 0 0-1.42z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->标签<!--]--></span></span><!--[--><!--]--></a></div><div class="navbar-links__item"><a href="/sake-s-blog/docs/guide/friends" class="link" aria-label="友链"><!--[--><!--]--><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M25 10H7a3.003 3.003 0 0 0-3 3v6a2.002 2.002 0 0 0 2 2v7a2.002 2.002 0 0 0 2 2h4a2.002 2.002 0 0 0 2-2V16h-2v12H8v-9H6v-6a1 1 0 0 1 1-1h18a1 1 0 0 1 1 1v6h-2v9h-4V16h-2v12a2.002 2.002 0 0 0 2 2h4a2.002 2.002 0 0 0 2-2v-7a2.002 2.002 0 0 0 2-2v-6a3.003 3.003 0 0 0-3-3z" fill="currentColor"></path><path d="M10 9a4 4 0 1 1 4-4a4.004 4.004 0 0 1-4 4zm0-6a2 2 0 1 0 2 2a2.002 2.002 0 0 0-2-2z" fill="currentColor"></path><path d="M22 9a4 4 0 1 1 4-4a4.004 4.004 0 0 1-4 4zm0-6a2 2 0 1 0 2 2a2.002 2.002 0 0 0-2-2z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->友链<!--]--></span></span><!--[--><!--]--></a></div><div class="navbar-links__item"><a href="/sake-s-blog/docs/guide/About" class="link" aria-label="关于"><!--[--><!--]--><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M12 4a5 5 0 1 1-5 5a5 5 0 0 1 5-5m0-2a7 7 0 1 0 7 7a7 7 0 0 0-7-7z" fill="currentColor"></path><path d="M22 30h-2v-5a5 5 0 0 0-5-5H9a5 5 0 0 0-5 5v5H2v-5a7 7 0 0 1 7-7h6a7 7 0 0 1 7 7z" fill="currentColor"></path><path d="M22 4h10v2H22z" fill="currentColor"></path><path d="M22 9h10v2H22z" fill="currentColor"></path><path d="M22 14h7v2h-7z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->关于<!--]--></span></span><!--[--><!--]--></a></div><div class="navbar-links__item"><div class="dropdown-link"><button class="dropdown-link__title" type="button" aria-label="series"><span class="xicon-container left title"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M12 4a5 5 0 1 1-5 5a5 5 0 0 1 5-5m0-2a7 7 0 1 0 7 7a7 7 0 0 0-7-7z" fill="currentColor"></path><path d="M22 30h-2v-5a5 5 0 0 0-5-5H9a5 5 0 0 0-5 5v5H2v-5a7 7 0 0 1 7-7h6a7 7 0 0 1 7 7z" fill="currentColor"></path><path d="M22 4h10v2H22z" fill="currentColor"></path><path d="M22 9h10v2H22z" fill="currentColor"></path><path d="M22 14h7v2h-7z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->series<!--]--></span></span><span class="arrow down"></span></button><button class="dropdown-link--mobile__title" type="button" aria-label="series"><span class="title"><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M12 4a5 5 0 1 1-5 5a5 5 0 0 1 5-5m0-2a7 7 0 1 0 7 7a7 7 0 0 0-7-7z" fill="currentColor"></path><path d="M22 30h-2v-5a5 5 0 0 0-5-5H9a5 5 0 0 0-5 5v5H2v-5a7 7 0 0 1 7-7h6a7 7 0 0 1 7 7z" fill="currentColor"></path><path d="M22 4h10v2H22z" fill="currentColor"></path><path d="M22 9h10v2H22z" fill="currentColor"></path><path d="M22 14h7v2h-7z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->series<!--]--></span></span></span><span class="right arrow"></span></button><ul style="display:none;" class="dropdown-link__container"><!--[--><li class="dropdown-link__item"><a href="/sake-s-blog/docs/theme-reco/theme" class="link" aria-label="vuepress-reco"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->vuepress-reco<!--]--></span></span><!--[--><!--]--></a></li><li class="dropdown-link__item"><a href="/sake-s-blog/blogs/other/guide" class="link" aria-label="vuepress-theme-reco"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->vuepress-theme-reco<!--]--></span></span><!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-links__item"><a class="link" href="https://github.com/fullstack-sake/sake-s-blog" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->GitHub<!--]--></span></span><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><span class="xicon-container btn-toggle-dark-mode btn--dark-mode"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" style="width:20px;height:20px;font-size:20px;color:inherit;"><path d="M15 2h2v3h-2z" fill="currentColor"></path><path d="M27 15h3v2h-3z" fill="currentColor"></path><path d="M15 27h2v3h-2z" fill="currentColor"></path><path d="M2 15h3v2H2z" fill="currentColor"></path><path d="M5.45 6.884l1.414-1.415l2.121 2.122l-1.414 1.414z" fill="currentColor"></path><path d="M23 7.58l2.121-2.12l1.414 1.414l-2.121 2.121z" fill="currentColor"></path><path d="M23.002 24.416l1.415-1.414l2.12 2.122l-1.413 1.414z" fill="currentColor"></path><path d="M5.47 25.13L7.59 23L9 24.42l-2.12 2.12l-1.41-1.41z" fill="currentColor"></path><path d="M16 8a8 8 0 1 0 8 8a8 8 0 0 0-8-8zm0 14a6 6 0 0 1 0-12z" fill="currentColor"></path></svg></span><span class="xicon-container btn-toggle-menus"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" style="width:20px;height:20px;font-size:20px;color:inherit;"><circle cx="16" cy="8" r="2" fill="currentColor"></circle><circle cx="16" cy="16" r="2" fill="currentColor"></circle><circle cx="16" cy="24" r="2" fill="currentColor"></circle></svg></span></div></div></header><!----><!----><!----><!--[--><main class="page-container"><aside class="series-container"><!--[--><!--]--></aside><div class="page-content"><h1 class="page-title">记一次JS逆向：破解麦当劳 sign 参数加密逻辑</h1><div class="page-info"><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M16 4a5 5 0 1 1-5 5a5 5 0 0 1 5-5m0-2a7 7 0 1 0 7 7a7 7 0 0 0-7-7z" fill="currentColor"></path><path d="M26 30h-2v-5a5 5 0 0 0-5-5h-6a5 5 0 0 0-5 5v5H6v-5a7 7 0 0 1 7-7h6a7 7 0 0 1 7 7z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->SAKE<!--]--></span></span><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M26 4h-4V2h-2v2h-8V2h-2v2H6c-1.1 0-2 .9-2 2v20c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 22H6V12h20v14zm0-16H6V6h4v2h2V6h8v2h2V6h4v4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->2023/02/11<!--]--></span></span><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M11.17 6l3.42 3.41l.58.59H28v16H4V6h7.17m0-2H4a2 2 0 0 0-2 2v20a2 2 0 0 0 2 2h24a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2H16l-3.41-3.41A2 2 0 0 0 11.17 4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[--><!--[--><a href="/sake-s-blog/categories/jishu/1.html" class="">技术</a><!--]--><!--]--></span></span><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M10 14a4 4 0 1 1 4-4a4.005 4.005 0 0 1-4 4zm0-6a2 2 0 1 0 1.998 2.004A2.002 2.002 0 0 0 10 8z" fill="currentColor"></path><path d="M16.644 29.415L2.586 15.354A2 2 0 0 1 2 13.941V4a2 2 0 0 1 2-2h9.941a2 2 0 0 1 1.414.586l14.06 14.058a2 2 0 0 1 0 2.828l-9.943 9.943a2 2 0 0 1-2.829 0zM4 4v9.942L18.058 28L28 18.058L13.942 4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[--><!--[--><a href="/sake-s-blog/tags/Web/1.html" class="">Web</a><a href="/sake-s-blog/tags/jsReverse/1.html" class="">jsReverse</a><a href="/sake-s-blog/tags/SRC/1.html" class="">SRC</a><!--]--><!--]--></span></span><!----></div><div class="theme-reco-md-content"><div><blockquote><p>如果你问我人生梦想是什么？</p><p>我可能会说：有什么天天嫖麦当劳优惠券狠狠吃更棒的事了呢😋</p><p><img src="/sake-s-blog/assets/QQ%E5%9B%BE%E7%89%8720230211161756-C242BhH6.png" alt="QQ图片20230211161756"></p></blockquote><blockquote><p><strong>本文所谈及技术只为网络安全人员进行服务器检测或维护参考，仅供学习交流，请勿用于违法用途。</strong></p></blockquote><p><strong>（碰壁了很多次，js代码经过混淆的可读性很差，代码量太大期间火狐崩溃了好几次😭）</strong></p><p>页面: <code>aHR0cHM6Ly9jZG4ubWNkLmNuL2Ntcy9wYWdlcy9RUXdhbGxldC5odG1s</code></p><p>首先抓取<strong>一键领取</strong>的数据包进行分析</p><p><img src="/sake-s-blog/assets/image-20230211142133997-CnVNVkSX.png" alt="image-20230211142133997"></p><p><img src="/sake-s-blog/assets/image-20230211142210032-BNy_XWbo.png" alt="image-20230211142210032"></p><blockquote><ul><li>尝试修改<code>receiveQuantity</code>为2，返回领取失败</li></ul></blockquote><p>对比两次请求可以发现，payload没有发生变化，改变的是请求头的<code>Nonce</code>，<code>St</code>，<code>Sign</code>参数，而且容易看出<code>St</code>参数是时间戳，<code>Nonce</code>参数是时间戳拼接了一段字符串</p><p><img src="/sake-s-blog/assets/image-20230211142648570-B1xIGa8h.png" alt="image-20230211142648570"></p><p>而请求前并未有<code>GetSign</code>相关请求，因此考虑是js本地进行<code>Sign</code>的生成，定位<code>Onclick</code>过程的js</p><p><img src="/sake-s-blog/assets/image-20230211143940188-CxvavYis.png" alt="image-20230211143940188"></p><blockquote><ul><li>尝试搜索请求的url：<code>/bff/member/coupon/bind</code>，缩短为<code>/coupon/bind</code>搜索，发现<code>couponsBind</code>函数（后续弯弯绕绕没有发现有用信息）</li></ul><p><img src="/sake-s-blog/assets/image-20230211150434753-D7fMLb8l.png" alt="image-20230211150434753"></p></blockquote><p>尝试搜索：<code>sign</code>，结果太多；搜索<code>.sign</code>，设置断点调试，得出<code>Object(i.sign)(t,{})</code>，<code>i.sign</code>是个函数对象，对 t 进行处理，返回了<code>sign</code>值</p><p><img src="/sake-s-blog/assets/image-20230211152011752-D-BREv6J.png" alt="image-20230211152011752"></p><p><img src="/sake-s-blog/assets/image-20230211152205363-DQIhe_Jv.png" alt="image-20230211152205363"></p><p>发现<code>c(e)</code>里调用了<code>u(n,t)</code>进行处理，继续断点调试，我们深入到该函数，发现调用了<code>e(b)</code></p><p><img src="/sake-s-blog/assets/image-20230211153057317-Bhe5Ped8.png" alt="image-20230211153057317"></p><p><img src="/sake-s-blog/assets/image-20230211153219409-DvgaLhyr.png" alt="image-20230211153219409"></p><p>我们将所有相关的函数全部扒到本地，并把一些固定字符串列表的索引给直接取出字符串来赋值（x = test[1] -&gt; x = &#39;helloworld&#39;）</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="line"><span class="token comment">// &quot;e0a803e042c3f658cf31d9b09454f914&quot;</span></span>
<span class="line"><span class="token keyword">var</span> n <span class="token operator">=</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token function-variable function">wordsToBytes</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token punctuation">]</span><span class="token punctuation">,</span> n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> n <span class="token operator">&lt;</span> <span class="token number">32</span> <span class="token operator">*</span> e<span class="token punctuation">.</span>length<span class="token punctuation">;</span> n <span class="token operator">+=</span> <span class="token number">8</span><span class="token punctuation">)</span> t<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>e<span class="token punctuation">[</span>n <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span> <span class="token operator">-</span> n <span class="token operator">%</span> <span class="token number">32</span> <span class="token operator">&amp;</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">return</span> t</span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token function-variable function">bytesToHex</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token punctuation">]</span><span class="token punctuation">,</span> n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> n <span class="token operator">&lt;</span> e<span class="token punctuation">.</span>length<span class="token punctuation">;</span> n<span class="token operator">++</span><span class="token punctuation">)</span> t<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">(</span>e<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    t<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">15</span> <span class="token operator">&amp;</span> e<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">return</span> t<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&#39;&#39;</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> n <span class="token keyword">in</span> e<span class="token punctuation">)</span> t<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">return</span> t</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">r</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> n <span class="token keyword">in</span> e<span class="token punctuation">)</span> t<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>e<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">return</span> t</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">e</span><span class="token punctuation">(</span><span class="token parameter">e<span class="token punctuation">,</span> t</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">==</span> e<span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&#39;Illegal argument &#39;</span> <span class="token operator">+</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">var</span> n <span class="token operator">=</span> r<span class="token punctuation">.</span><span class="token function">wordsToBytes</span><span class="token punctuation">(</span><span class="token function">u</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">return</span> t <span class="token operator">&amp;&amp;</span> t<span class="token punctuation">.</span>asBytes <span class="token operator">?</span> n <span class="token operator">:</span> t <span class="token operator">&amp;&amp;</span> t<span class="token punctuation">.</span>asString <span class="token operator">?</span> a<span class="token punctuation">.</span><span class="token function">bytesToString</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">:</span> r<span class="token punctuation">.</span><span class="token function">bytesToHex</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">var</span> <span class="token function-variable function">u</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">o</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">var</span> i <span class="token operator">=</span> arguments<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">void</span> <span class="token number">0</span> <span class="token operator">!==</span> arguments<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">?</span> arguments<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    u <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token string-property property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">          <span class="token string-property property">&quot;channelCode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;03&quot;</span><span class="token punctuation">,</span></span>
<span class="line">          <span class="token string-property property">&quot;coupons&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">            <span class="token punctuation">{</span></span>
<span class="line">              <span class="token string-property property">&quot;couponId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;156BBFBC389F9EA666E2FACD40BC5605&quot;</span><span class="token punctuation">,</span></span>
<span class="line">              <span class="token string-property property">&quot;receiveQuantity&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span></span>
<span class="line">              <span class="token string-property property">&quot;newUserFlag&quot;</span><span class="token operator">:</span> <span class="token number">0</span></span>
<span class="line">            <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token punctuation">{</span></span>
<span class="line">              <span class="token string-property property">&quot;couponId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;45F09AFEE6E455A7175B1085C5012321&quot;</span><span class="token punctuation">,</span></span>
<span class="line">              <span class="token string-property property">&quot;receiveQuantity&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span></span>
<span class="line">              <span class="token string-property property">&quot;newUserFlag&quot;</span><span class="token operator">:</span> <span class="token number">0</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">          <span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">          <span class="token string-property property">&quot;pageId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;lRLlag9R&quot;</span></span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string-property property">&quot;params&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string-property property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string-property property">&quot;headers&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">          <span class="token string-property property">&quot;ct&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ct=10&quot;</span><span class="token punctuation">,</span></span>
<span class="line">          <span class="token string-property property">&quot;nonce&quot;</span><span class="token operator">:</span> <span class="token string">&quot;nonce=1676061464467544235&quot;</span><span class="token punctuation">,</span></span>
<span class="line">          <span class="token string-property property">&quot;sid&quot;</span><span class="token operator">:</span> <span class="token string">&quot;sid=c9643a4402552c67ca7a5a75cdee70b4_&quot;</span><span class="token punctuation">,</span></span>
<span class="line">          <span class="token string-property property">&quot;st&quot;</span><span class="token operator">:</span> <span class="token string">&quot;st=1676061464&quot;</span></span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string-property property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://api.mcd.cn/bff/member/coupon/bind&quot;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">    u<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>ct <span class="token operator">=</span> u<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>ct <span class="token operator">||</span> <span class="token number">10</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">var</span> c <span class="token operator">=</span> u<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>ct<span class="token punctuation">,</span></span>
<span class="line">    s <span class="token operator">=</span> o<span class="token punctuation">.</span>env<span class="token punctuation">,</span></span>
<span class="line">    l <span class="token operator">=</span> <span class="token string">&#39;71d414c0-8fe1-495d-ac55-207414632479&#39;</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">// s || (s = u.url.match(/-dev\./) ? &#39;dev&#39; : u.url.match(/-sit\./) ? &#39;sit&#39; : u.url.match(/-uat\./) ? &#39;uat&#39; : u.url.match(/-pt\./) ? &#39;pt&#39; : &#39;prd&#39;),</span></span>
<span class="line">    n<span class="token punctuation">[</span>s<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>l <span class="token operator">=</span> n<span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token punctuation">[</span>c<span class="token punctuation">]</span> <span class="token operator">||</span> t<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>u<span class="token punctuation">.</span>path<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>u<span class="token punctuation">.</span>path <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">var</span> f <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">a</span><span class="token punctuation">(</span>u<span class="token punctuation">.</span>params<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">===</span> u<span class="token punctuation">.</span>params<span class="token punctuation">[</span>e<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token number">0</span> <span class="token operator">===</span> u<span class="token punctuation">.</span>params<span class="token punctuation">[</span>e<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token number">1</span> <span class="token operator">===</span> u<span class="token punctuation">.</span>params<span class="token punctuation">[</span>e<span class="token punctuation">]</span> <span class="token operator">||</span> u<span class="token punctuation">.</span>params<span class="token punctuation">[</span>e<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token number">0</span> <span class="token operator">===</span> u<span class="token punctuation">.</span>params<span class="token punctuation">[</span>e<span class="token punctuation">]</span> <span class="token operator">?</span> f<span class="token punctuation">[</span>e<span class="token punctuation">]</span> <span class="token operator">=</span> e <span class="token operator">+</span> <span class="token string">&#39;=true&#39;</span> <span class="token operator">:</span> <span class="token operator">!</span><span class="token number">1</span> <span class="token operator">===</span> u<span class="token punctuation">.</span>params<span class="token punctuation">[</span>e<span class="token punctuation">]</span> <span class="token operator">?</span> f<span class="token punctuation">[</span>e<span class="token punctuation">]</span> <span class="token operator">=</span> e <span class="token operator">+</span> <span class="token string">&#39;=false&#39;</span> <span class="token operator">:</span> f<span class="token punctuation">[</span>e<span class="token punctuation">]</span> <span class="token operator">=</span> e <span class="token operator">+</span> <span class="token string">&#39;=&#39;</span> <span class="token operator">+</span> u<span class="token punctuation">.</span>params<span class="token punctuation">[</span>e<span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    u<span class="token punctuation">.</span>params <span class="token operator">=</span> f<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">var</span> d <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    p <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">      <span class="token string">&#39;ct&#39;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token string">&#39;language&#39;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token string">&#39;ov&#39;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token string">&#39;p&#39;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token string">&#39;sid&#39;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token string">&#39;token&#39;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token string">&#39;v&#39;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token string">&#39;st&#39;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token string">&#39;nonce&#39;</span></span>
<span class="line">    <span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">a</span><span class="token punctuation">(</span>u<span class="token punctuation">.</span>headers<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">===</span> u<span class="token punctuation">.</span>headers<span class="token punctuation">[</span>e<span class="token punctuation">]</span> <span class="token operator">||</span> u<span class="token punctuation">.</span>headers<span class="token punctuation">[</span>e<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> p<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>d<span class="token punctuation">[</span>e<span class="token punctuation">]</span> <span class="token operator">=</span> e <span class="token operator">+</span> <span class="token string">&#39;=&#39;</span> <span class="token operator">+</span> u<span class="token punctuation">.</span>headers<span class="token punctuation">[</span>e<span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    u<span class="token punctuation">.</span>headers <span class="token operator">=</span> d<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">var</span> h <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    v <span class="token operator">=</span> <span class="token number">101</span> <span class="token operator">===</span> c <span class="token operator">||</span> <span class="token number">102</span> <span class="token operator">===</span> c <span class="token operator">?</span> <span class="token string">&#39;#&#39;</span> <span class="token operator">:</span> <span class="token string">&#39;&amp;&#39;</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">&#39;#&#39;</span> <span class="token operator">===</span> v <span class="token operator">&amp;&amp;</span> h<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">r</span><span class="token punctuation">(</span>u<span class="token punctuation">.</span>headers<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> u<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token keyword">var</span> y <span class="token operator">=</span> <span class="token string">&quot;{\&quot;channelCode\&quot;:\&quot;03\&quot;,\&quot;coupons\&quot;:[{\&quot;couponId\&quot;:\&quot;156BBFBC389F9EA666E2FACD40BC5605\&quot;,\&quot;receiveQuantity\&quot;:1,\&quot;newUserFlag\&quot;:0},{\&quot;couponId\&quot;:\&quot;45F09AFEE6E455A7175B1085C5012321\&quot;,\&quot;receiveQuantity\&quot;:1,\&quot;newUserFlag\&quot;:0}],\&quot;pageId\&quot;:\&quot;lRLlag9R\&quot;}&quot;</span><span class="token punctuation">;</span></span>
<span class="line">      <span class="token string">&#39;{}&#39;</span> <span class="token operator">!==</span> y <span class="token operator">&amp;&amp;</span> h<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">var</span> m<span class="token punctuation">,</span></span>
<span class="line">    g <span class="token operator">=</span> <span class="token function">r</span><span class="token punctuation">(</span>u<span class="token punctuation">.</span>params<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>g <span class="token operator">&amp;&amp;</span> h<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">,</span> h<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>u<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&#39;,&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#39;&amp;&#39;</span> <span class="token operator">===</span> v <span class="token operator">&amp;&amp;</span> h<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">r</span><span class="token punctuation">(</span>u<span class="token punctuation">.</span>headers<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>h <span class="token operator">=</span> h<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token keyword">return</span> e <span class="token operator">&amp;&amp;</span> <span class="token string">&#39;{}&#39;</span> <span class="token operator">!==</span> e</span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      l <span class="token operator">?</span> h<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&#39;key=&#39;</span> <span class="token operator">+</span> l<span class="token punctuation">)</span> <span class="token operator">:</span> console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">&#39;[WARN] ct=&#39;</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token string">&#39; is not in pre-defined keys.&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">      <span class="token keyword">var</span> b <span class="token operator">=</span> h<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">//   i.debug &amp;&amp; console.log(&#39;[DEBUG] @omc/api-signer - plainText: &#39;, b),</span></span>
<span class="line">      m <span class="token operator">=</span> <span class="token function">e</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">return</span> m</span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">n <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token string-property property">&quot;params&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token string-property property">&quot;putChannel&quot;</span><span class="token operator">:</span> <span class="token string">&quot;03&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token string-property property">&quot;pageId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;lRLlag9R&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token string-property property">&quot;cityCode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;310100&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token string-property property">&quot;sid&quot;</span><span class="token operator">:</span> <span class="token string">&quot;c9643a4402552c67ca7a5a75cdee70b4_&quot;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string-property property">&quot;headers&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token string-property property">&quot;common&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token string-property property">&quot;Accept&quot;</span><span class="token operator">:</span> <span class="token string">&quot;application/json, text/plain, */*&quot;</span></span>
<span class="line">      <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token string-property property">&quot;delete&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token string-property property">&quot;get&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token string-property property">&quot;head&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token string-property property">&quot;post&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token string-property property">&quot;Content-Type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;application/x-www-form-urlencoded&quot;</span></span>
<span class="line">      <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token string-property property">&quot;put&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token string-property property">&quot;Content-Type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;application/x-www-form-urlencoded&quot;</span></span>
<span class="line">      <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token string-property property">&quot;patch&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token string-property property">&quot;Content-Type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;application/x-www-form-urlencoded&quot;</span></span>
<span class="line">      <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token string-property property">&quot;tid&quot;</span><span class="token operator">:</span> <span class="token string">&quot;00003TuM&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token string-property property">&quot;sid&quot;</span><span class="token operator">:</span> <span class="token string">&quot;c9643a4402552c67ca7a5a75cdee70b4_&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token string-property property">&quot;sv&quot;</span><span class="token operator">:</span> <span class="token string">&quot;v3&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token string-property property">&quot;nonce&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1676058630105631320&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token string-property property">&quot;st&quot;</span><span class="token operator">:</span> <span class="token number">1676058630</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token string-property property">&quot;ct&quot;</span><span class="token operator">:</span> <span class="token number">10</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string-property property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://api.mcd.cn/bff/member/page/coupon/customer/getable&quot;</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">bgg <span class="token operator">=</span> <span class="token string">&quot;{\&quot;channelCode\&quot;:\&quot;03\&quot;,\&quot;coupons\&quot;:[{\&quot;couponId\&quot;:\&quot;156BBFBC389F9EA666E2FACD40BC5605\&quot;,\&quot;receiveQuantity\&quot;:1,\&quot;newUserFlag\&quot;:0},{\&quot;couponId\&quot;:\&quot;45F09AFEE6E455A7175B1085C5012321\&quot;,\&quot;receiveQuantity\&quot;:1,\&quot;newUserFlag\&quot;:0}],\&quot;pageId\&quot;:\&quot;lRLlag9R\&quot;}&amp;ct=10&amp;nonce=1676060716058879900&amp;sid=c9643a4402552c67ca7a5a75cdee70b4_&amp;st=1676060716&amp;key=71d414c0-8fe1-495d-ac55-207414632479&quot;</span></span>
<span class="line"><span class="token comment">// &quot;cityCode=310100&amp;pageId=lRLlag9R&amp;putChannel=03&amp;sid=c9643a4402552c67ca7a5a75cdee70b4_&amp;ct=10&amp;nonce=1676058630105631320&amp;sid=c9643a4402552c67ca7a5a75cdee70b4_&amp;st=1676058630&amp;key=71d414c0-8fe1-495d-ac55-207414632479&quot;</span></span>
<span class="line">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">e</span><span class="token punctuation">(</span>bgg<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>尝试运行，结果栈溢出报错，因为发生了死循环</p><p><img src="/sake-s-blog/assets/image-20230211154011725-CgOTwF0H.png" alt="image-20230211154011725"></p><blockquote><ul><li>补充nonce和st的获取</li><li><img src="/sake-s-blog/assets/image-20230211160113556-AaEVrMBk.png" alt="image-20230211160113556"></li></ul></blockquote><p>经过分析，我们发现，<code>u(e,t)</code>并不是前面所提到的u，而是一个新的函数。而且关键性的，我们发现了该函数下存在<code>1732584193</code>等幻数，这些是MD5加密的特征</p><p><img src="/sake-s-blog/assets/image-20230211154505128-D9UTZSJJ.png" alt="image-20230211154505128"></p><p>所以<code>e(b)</code>本质就是将 b 进行了MD5加密，我们断点调试截获 b 来验证一下</p><p><img src="/sake-s-blog/assets/image-20230211155415536-PTetqqWk.png" alt="image-20230211155415536"></p><p><img src="/sake-s-blog/assets/image-20230211155952042-D8Qkjifm.png" alt="image-20230211155952042"></p><p>成功破解<code>sign</code>的加密逻辑🎉🎉</p><blockquote><p>后续：尝试写个python脚本</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre class="language-python"><code><span class="line"><span class="token keyword">import</span> time</span>
<span class="line"><span class="token keyword">import</span> random</span>
<span class="line"><span class="token keyword">import</span> hashlib</span>
<span class="line"><span class="token keyword">import</span> requests</span>
<span class="line"></span>
<span class="line">st <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">nonce <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>st<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token number">999999</span> <span class="token operator">*</span> random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39;000&#39;</span></span>
<span class="line">m <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f&quot;cityCode=310100&amp;pageId=lRLlag9R&amp;putChannel=03&amp;sid=b4ccde8d6f2e6256ddfce3b3f4ef3dca_&amp;ct=10&amp;nonce=</span><span class="token interpolation"><span class="token punctuation">{</span>nonce<span class="token punctuation">}</span></span><span class="token string">&amp;sid=b4ccde8d6f2e6256ddfce3b3f4ef3dca_&amp;st=</span><span class="token interpolation"><span class="token punctuation">{</span>st<span class="token punctuation">}</span></span><span class="token string">&amp;key=71d414c0-8fe1-495d-ac55-207414632479&quot;</span></span></span>
<span class="line">sign <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span>m<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">&#39;UTF-8&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>st<span class="token punctuation">,</span> nonce<span class="token punctuation">,</span> sign<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;channelCode&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;03&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;coupons&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">&quot;couponId&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;156BBFBC389F9EA666E2FACD40BC5605&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;receiveQuantity&quot;</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;newUserFlag&quot;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&quot;couponId&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;45F09AFEE6E455A7175B1085C5012321&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;receiveQuantity&quot;</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;newUserFlag&quot;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&quot;pageId&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;lRLlag9R&quot;</span><span class="token punctuation">}</span></span>
<span class="line">url <span class="token operator">=</span> <span class="token string">&#39;https://api.mcd.cn/bff/member/coupon/bind&#39;</span></span>
<span class="line">headers <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&#39;Host&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;api.mcd.cn&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;User-Agent&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/109.0&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;Accept&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;application/json, text/plain, */*&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;Accept-Language&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;Accept-Encoding&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;gzip, deflate&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;Content-Type&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;application/json&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;tid&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;00003TuM&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;sid&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;b4ccde8d6f2e6256ddfce3b3f4ef3dca_&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;sv&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;v3&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;nonce&#39;</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f&#39;</span><span class="token interpolation"><span class="token punctuation">{</span>nonce<span class="token punctuation">}</span></span><span class="token string">&#39;</span></span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;st&#39;</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f&#39;</span><span class="token interpolation"><span class="token punctuation">{</span>st<span class="token punctuation">}</span></span><span class="token string">&#39;</span></span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;ct&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;10&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;sign&#39;</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f&#39;</span><span class="token interpolation"><span class="token punctuation">{</span>sign<span class="token punctuation">}</span></span><span class="token string">&#39;</span></span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;Content-Length&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;220&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;Origin&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;https://cdn.mcd.cn&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;Referer&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;https://cdn.mcd.cn/&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;Sec-Fetch-Dest&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;empty&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;Sec-Fetch-Mode&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;cors&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;Sec-Fetch-Site&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;same-site&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;Te&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;trailers&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;Connection&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;close&#39;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token comment"># res = requests.get(&#39;https://api.mcd.cn/bff/member/page/coupon/customer/getable?putChannel=03&amp;pageId=lRLlag9R&amp;cityCode=310100&amp;sid=b4ccde8d6f2e6256ddfce3b3f4ef3dca_&#39;,headers=headers)</span></span>
<span class="line">res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>text<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>草，竟然报错显示<strong>缺少参数</strong>，怎么回事呢😢（在Burp-Proxy截获的数据包中success，Burp-Repeater则不行）</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">{&quot;success&quot;:false,&quot;code&quot;:400,&quot;message&quot;:&quot;缺少参数&quot;,&quot;datetime&quot;:&quot;2023-02-11 16:04:17&quot;,&quot;traceId&quot;:&quot;3563b509-808d-4582-907d-19fe5a2feb6e&quot;,&quot;data&quot;:null}</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>看来无法实现自动发包领取了，然后就狠狠的进行了脚本录制🥬给两个号都嫖了四百张券（</p><p><img src="/sake-s-blog/assets/image-20230211161407478-D3M7QCZC.png" alt="image-20230211161407478"></p><p><img src="/sake-s-blog/assets/QQ%E5%9B%BE%E7%89%8720230211161756-C242BhH6.png" alt="QQ图片20230211161756"></p></blockquote><p>后续:第二天已修复(火速)🐶😡</p></div></div><footer class="page-meta"><div class="meta-item edit-link"><span class="xicon-container left meta-item-label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:20px;height:20px;font-size:20px;color:inherit;"><path d="M2 26h28v2H2z" fill="currentColor"></path><path d="M25.4 9c.8-.8.8-2 0-2.8l-3.6-3.6c-.8-.8-2-.8-2.8 0l-15 15V24h6.4l15-15zm-5-5L24 7.6l-3 3L17.4 7l3-3zM6 22v-3.6l10-10l3.6 3.6l-10 10H6z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->Edit this page<!--]--></span></span></div><div class="meta-item last-updated"><span class="xicon-container left meta-item-label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:20px;height:20px;font-size:20px;color:inherit;"><path d="M26 4h-4V2h-2v2h-8V2h-2v2H6c-1.1 0-2 .9-2 2v20c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 22H6V12h20v14zm0-16H6V6h4v2h2V6h8v2h2V6h4v4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->Last Updated 2024/8/11 04:00:17<!--]--></span></span></div></footer><!----><!----></div><!----></main><!--]--></div><!--[--><!----><!----><div></div><!--]--><!--]--></div>
    <script type="module" src="/sake-s-blog/assets/app-D-TC3Ll_.js" defer></script>
  </body>
</html>
